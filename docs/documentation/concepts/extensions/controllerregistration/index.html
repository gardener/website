<!doctype html><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Project Gardener Website - A Managed Kubernetes Service Done Right"><meta name=copyright content="Copyright 2019-2021 Gardener project authors."><meta name=google-site-verification content="9EoGiMwk2aq0E_tVh16iJgJbp7fbyqkfWH9b5sGybl0"><title>Registering Extension Controllers :: Gardener</title><link rel=icon type=image/x-icon href=https://gardener.cloud/images/favicon.ico><link rel=icon type=image/png href=https://gardener.cloud/images/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=https://gardener.cloud/images/favicon-16x16.png sizes=16x16><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-W2FGNSX');</script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','UA-165447164-1');</script><link href=/css/font-awesome.min.css?1616133831 rel=stylesheet><link href=/css/skeleton.css?1616133831 rel=stylesheet><link rel=preload href=/fonts/sap-icofonts/sap-icofonts.woff as=font type=font/woff crossorigin=anonymous><link rel=preload href=/fonts/sapcom-icons/sapcom-icons.woff as=font type=font/woff crossorigin=anonymous><link rel=stylesheet href=/css/sapcom-icons.css><link rel=stylesheet href=/css/normalize.css><link rel=stylesheet href=/css/gardener.b459b7f22c26be8e2f608a181d5372c6e44f06cf007c350346ccf5fadbe04a74.css><script src=/js/moment.js?1616133831></script><script src=/js/inlineSVG.js?1616133831></script><script src=/js/jquery.min.js?1616133831></script><script src=/jquery-ui-1.12.1/jquery-ui.min.js?1616133831></script><script src=/js/fixed.js?1616133831></script><script src=/js/clipboard.min.js?1616133831></script><script src=https://platform.linkedin.com/in.js type=text/javascript>lang:en_US</script></head><body data-url=/documentation/concepts/extensions/controllerregistration/ class=has-sticky-navigation><script>$(document).ready(function(){function initStickyNav(){var stickyPoint;var tln=document.querySelector(".tln");if(!tln){return;}
var stickyPointEl=document.querySelector(".sticky-nav-point");if(stickyPointEl==null){stickyPointEl=document.querySelector("body");stickyPoint=0;}else{stickyPoint=stickyPointEl.clientHeight+stickyPointEl.offsetTop;}
var bodySelector=document.getElementsByTagName("body")[0];var tlnHeight=tln.clientHeight;var stickyNavigation=function(){if(window.pageYOffset+tlnHeight>=stickyPoint){bodySelector.classList.add("has-sticky-navigation");tln.classList.add("sticky-top");}else{bodySelector.classList.remove("has-sticky-navigation");tln.classList.remove("sticky-top");}}
window.onscroll=function(){stickyNavigation();};}
initStickyNav();function closeAllSelect(){document.getElementById("docOptions").classList.remove("show");}
function show(e){e.stopPropagation();document.getElementById("docOptions").classList.add("show");}
document.addEventListener("click",closeAllSelect);document.getElementById("docSelector").addEventListener("click",show);});</script><div class="tln fixedsticky sticky-top"><header class=navigation><div class=container><div class=navigation-wrapper><a href=/ class=logo><img src=/images/gardener-logo.svg>
<span class=title>Gardener</span></a>
<a class="nav-button navbar-toggler" href=#><i class="fa fa-bars"></i></a><div class=navbar-collapse><ul class=links><li class=link><a href=/blog/>Blogs</a></li><li class=link><a href=/community/>Community</a></li><li class=link><a href=/adopter/>Adopters</a></li><li class="link has-child active"><a id=docSelector>Documentation v1.17.1</a><div id=docOptions class=doc-options><ul><li><a href=/documentation/home class=activeVersion>Documentation
v1.17.1</a></li><li><a href=/v1.16.3/home>Documentation
v1.16.3</a></li><li><a href=/v1.15.5/home>Documentation
v1.15.5</a></li></ul></div></li></ul></div></div></div></header></div><script>$(".navigation .navbar-toggler").click(function(evt){$(".navigation .navbar-collapse").toggle();$(".navigation").toggleClass("collapsed");$(".navigation .search-box").toggle();})</script><style>#docSelector{cursor:pointer}.doc-options{position:fixed;background-color:#0b8062;text-align:left;display:none}.doc-options ul li{margin-bottom:0}.doc-options ul li a:hover{background-color:#0c694f}.doc-options ul{list-style:none;padding:0;margin:0;text-align:left}.doc-options ul li a{padding:10px;margin:0}.doc-options .activeVersion{background-color:#ec682a}.show{display:block}</style><div class=sln><div class=overlay-band><ul class="nav-list container"><li title=Home><a class=navbar-link href=/documentation/home/>Home</a></li><li title=Concepts><a class="navbar-link is-active" href=/documentation/concepts/>Concepts</a></li><li title="How-To Guides"><a class=navbar-link href=/documentation/guides/>How-To Guides</a></li><li title=Tutorials><a class=navbar-link href=/documentation/tutorials/>Tutorials</a></li><li title="API Reference"><a class=navbar-link href=/documentation/references/>API Reference</a></li><li title=Contribute><a class=navbar-link href=/documentation/contribute/>Contribute</a></li></ul></div></div><div class="main container"><nav id=sidebar class="collapsed container menu"><div class=highlightable><ul class=topics><li data-nav-id=/documentation/concepts/ title=Concepts class="dd-item parent root collapsible" data-depth=0><a href=/documentation/concepts/><span class=menu-item-text>Concepts</span></a><ul><li data-nav-id=/documentation/concepts/architecture/ title=Architecture class="dd-item top-level collapsible collapsed" data-depth=1><a href=/documentation/concepts/architecture/><span class="toggle fa fa-angle-right"></span><span class=menu-item-text>Architecture</span></a><ul><li data-nav-id=/components/bouquet/ title=Bouquet class=dd-item data-depth=2><a href=/components/bouquet/><span class=toggle></span><span class=menu-item-text></span>Bouquet</span></a></a></li><li data-nav-id=/components/dashboard/ title=Dashboard class=dd-item data-depth=2><a href=/components/dashboard/><span class=toggle></span><span class=menu-item-text></span>Dashboard</span></a></a></li><li data-nav-id=/components/gardenctl/ title=gardenctl class=dd-item data-depth=2><a href=/components/gardenctl/><span class=toggle></span><span class=menu-item-text></span>gardenctl</span></a></a></li><li data-nav-id=/components/gardener/ title=Gardener class=dd-item data-depth=2><a href=/components/gardener/><span class=toggle></span><span class=menu-item-text></span>Gardener</span></a></a></li><li data-nav-id=/components/kubify/ title=kubify class=dd-item data-depth=2><a href=/components/kubify/><span class=toggle></span><span class=menu-item-text></span>kubify</span></a></a></li></ul></li><li data-nav-id=/documentation/concepts/core-components/ title="Core Components" class="dd-item top-level collapsible collapsed" data-depth=1><a href=/documentation/concepts/core-components/api-server><span class="toggle fa fa-angle-right"></span><span class=menu-item-text>Core Components</span></a><ul><li data-nav-id=/documentation/concepts/core-components/api-server/ title="Gardener API Server" class="dd-item collapsible collapsed" data-depth=2><a href=/documentation/concepts/core-components/api-server/><span class="toggle fa fa-angle-right"></span><span class=menu-item-text>Gardener API Server</span></a><ul><li data-nav-id=/documentation/concepts/core-components/api-server/apiserver_admission_plugins/ title="In-Tree Admission Plugins" class=dd-item data-depth=3><a href=/documentation/concepts/core-components/api-server/apiserver_admission_plugins/><span class=toggle></span><span class=menu-item-text></span>In-Tree Admission Plugins</span></a></a></li></ul></li><li data-nav-id=/documentation/concepts/core-components/scheduler/ title="Gardener Scheduler" class=dd-item data-depth=2><a href=/documentation/concepts/core-components/scheduler/><span class=toggle></span><span class=menu-item-text></span>Gardener Scheduler</span></a></a></li><li data-nav-id=/documentation/concepts/core-components/seed-admission-controller/ title="Gardener Seed Admission Controller" class=dd-item data-depth=2><a href=/documentation/concepts/core-components/seed-admission-controller/><span class=toggle></span><span class=menu-item-text></span>Gardener Seed Admission Controller</span></a></a></li><li data-nav-id=/documentation/concepts/core-components/gardenlet/ title=gardenlet class=dd-item data-depth=2><a href=/documentation/concepts/core-components/gardenlet/><span class=toggle></span><span class=menu-item-text></span>gardenlet</span></a></a></li></ul></li><li data-nav-id=/documentation/concepts/backup-restore/backup-restore/ title="Backup and Restore" class="dd-item top-level" data-depth=1><a href=/documentation/concepts/backup-restore/backup-restore/><span class=toggle></span><span class=menu-item-text></span>Backup and Restore</span></a></a></li><li data-nav-id=/documentation/concepts/extensions/ title=Extensions class="dd-item parent top-level collapsible" data-depth=1><a href=/documentation/concepts/extensions/><span class="toggle fa fa-angle-down"></span><span class=menu-item-text>Extensions</span></a><ul><li data-nav-id=/documentation/concepts/extensions/backupbucket/ title="BackupBucket resource" class=dd-item data-depth=2><a href=/documentation/concepts/extensions/backupbucket/><span class=toggle></span><span class=menu-item-text></span>BackupBucket resource</span></a></a></li><li data-nav-id=/documentation/concepts/extensions/backupentry/ title="BackupEntry resource" class=dd-item data-depth=2><a href=/documentation/concepts/extensions/backupentry/><span class=toggle></span><span class=menu-item-text></span>BackupEntry resource</span></a></a></li><li data-nav-id=/documentation/concepts/extensions/cluster/ title="Cluster resource" class=dd-item data-depth=2><a href=/documentation/concepts/extensions/cluster/><span class=toggle></span><span class=menu-item-text></span>Cluster resource</span></a></a></li><li data-nav-id=/documentation/concepts/extensions/shoot-health-status-conditions/ title="Contributing to shoot health status conditions" class=dd-item data-depth=2><a href=/documentation/concepts/extensions/shoot-health-status-conditions/><span class=toggle></span><span class=menu-item-text></span>Contributing to shoot health status conditions</span></a></a></li><li data-nav-id=/documentation/concepts/extensions/controlplane-webhooks/ title="Controlplane customization webhooks" class=dd-item data-depth=2><a href=/documentation/concepts/extensions/controlplane-webhooks/><span class=toggle></span><span class=menu-item-text></span>Controlplane customization webhooks</span></a></a></li><li data-nav-id=/documentation/concepts/extensions/controlplane/ title="ControlPlane resource" class=dd-item data-depth=2><a href=/documentation/concepts/extensions/controlplane/><span class=toggle></span><span class=menu-item-text></span>ControlPlane resource</span></a></a></li><li data-nav-id=/documentation/concepts/extensions/controlplane-exposure/ title="ControlPlane resource with purpose exposure" class=dd-item data-depth=2><a href=/documentation/concepts/extensions/controlplane-exposure/><span class=toggle></span><span class=menu-item-text></span>ControlPlane resource with purpose exposure</span></a></a></li><li data-nav-id=/documentation/concepts/extensions/dns/ title="DNSProvider and DNSEntry resources" class=dd-item data-depth=2><a href=/documentation/concepts/extensions/dns/><span class=toggle></span><span class=menu-item-text></span>DNSProvider and DNSEntry resources</span></a></a></li><li data-nav-id=/documentation/concepts/extensions/project-roles/ title="Extending project roles" class=dd-item data-depth=2><a href=/documentation/concepts/extensions/project-roles/><span class=toggle></span><span class=menu-item-text></span>Extending project roles</span></a></a></li><li data-nav-id=/documentation/concepts/extensions/overview/ title="Extensibility overview" class=dd-item data-depth=2><a href=/documentation/concepts/extensions/overview/><span class=toggle></span><span class=menu-item-text></span>Extensibility overview</span></a></a></li><li data-nav-id=/documentation/concepts/extensions/extension/ title="Extension resource" class=dd-item data-depth=2><a href=/documentation/concepts/extensions/extension/><span class=toggle></span><span class=menu-item-text></span>Extension resource</span></a></a></li><li data-nav-id=/documentation/concepts/extensions/containerruntime/ title="Gardener Container Runtime Extension" class=dd-item data-depth=2><a href=/documentation/concepts/extensions/containerruntime/><span class=toggle></span><span class=menu-item-text></span>Gardener Container Runtime Extension</span></a></a></li><li data-nav-id=/documentation/concepts/extensions/network/ title="Gardener Network Extension" class=dd-item data-depth=2><a href=/documentation/concepts/extensions/network/><span class=toggle></span><span class=menu-item-text></span>Gardener Network Extension</span></a></a></li><li data-nav-id=/documentation/concepts/extensions/conventions/ title="General conventions" class=dd-item data-depth=2><a href=/documentation/concepts/extensions/conventions/><span class=toggle></span><span class=menu-item-text></span>General conventions</span></a></a></li><li data-nav-id=/documentation/concepts/extensions/healthcheck-library/ title="Health Check Library" class=dd-item data-depth=2><a href=/documentation/concepts/extensions/healthcheck-library/><span class=toggle></span><span class=menu-item-text></span>Health Check Library</span></a></a></li><li data-nav-id=/documentation/concepts/extensions/infrastructure/ title="Infrastructure resource" class=dd-item data-depth=2><a href=/documentation/concepts/extensions/infrastructure/><span class=toggle></span><span class=menu-item-text></span>Infrastructure resource</span></a></a></li><li data-nav-id=/documentation/concepts/extensions/logging-and-monitoring/ title="Logging and Monitoring for Extensions" class=dd-item data-depth=2><a href=/documentation/concepts/extensions/logging-and-monitoring/><span class=toggle></span><span class=menu-item-text></span>Logging and Monitoring for Extensions</span></a></a></li><li data-nav-id=/documentation/concepts/extensions/operatingsystemconfig/ title="OperatingSystemConfig resource" class=dd-item data-depth=2><a href=/documentation/concepts/extensions/operatingsystemconfig/><span class=toggle></span><span class=menu-item-text></span>OperatingSystemConfig resource</span></a></a></li><li data-nav-id=/documentation/concepts/extensions/referenced-resources/ title="Referenced Resources" class=dd-item data-depth=2><a href=/documentation/concepts/extensions/referenced-resources/><span class=toggle></span><span class=menu-item-text></span>Referenced Resources</span></a></a></li><li data-nav-id=/documentation/concepts/extensions/controllerregistration/ title="Registering Extension Controllers" class="dd-item active" data-depth=2><a href=/documentation/concepts/extensions/controllerregistration/><span class=toggle></span><span class=menu-item-text></span>Registering Extension Controllers</span></a></a></li><li data-nav-id=/documentation/concepts/extensions/shoot-maintenance/ title="Shoot maintenance" class=dd-item data-depth=2><a href=/documentation/concepts/extensions/shoot-maintenance/><span class=toggle></span><span class=menu-item-text></span>Shoot maintenance</span></a></a></li><li data-nav-id=/documentation/concepts/extensions/shoot-webhooks/ title="Shoot resource customization webhooks" class=dd-item data-depth=2><a href=/documentation/concepts/extensions/shoot-webhooks/><span class=toggle></span><span class=menu-item-text></span>Shoot resource customization webhooks</span></a></a></li><li data-nav-id=/documentation/concepts/extensions/worker/ title="Worker resource" class=dd-item data-depth=2><a href=/documentation/concepts/extensions/worker/><span class=toggle></span><span class=menu-item-text></span>Worker resource</span></a></a></li></ul></li><li data-nav-id=/documentation/concepts/networking/ title=Networking class="dd-item top-level collapsible collapsed" data-depth=1><a href=/documentation/concepts/networking/><span class="toggle fa fa-angle-right"></span><span class=menu-item-text>Networking</span></a><ul><li data-nav-id=/documentation/concepts/networking/dns-managment/ title="DNS Management" class=dd-item data-depth=2><a href=/documentation/concepts/networking/dns-managment/><span class=toggle></span><span class=menu-item-text></span>DNS Management</span></a></a></li><li data-nav-id=/documentation/concepts/networking/cert-managment/ title="Certificates Management" class=dd-item data-depth=2><a href=/documentation/concepts/networking/cert-managment/><span class=toggle></span><span class=menu-item-text></span>Certificates Management</span></a></a></li><li data-nav-id=/documentation/concepts/networking/network_policies/ title="Network Policies" class=dd-item data-depth=2><a href=/documentation/concepts/networking/network_policies/><span class=toggle></span><span class=menu-item-text></span>Network Policies</span></a></a></li></ul></li><li data-nav-id=/documentation/concepts/monitoring/ title=Monitoring class="dd-item top-level collapsible collapsed" data-depth=1><a href=/documentation/concepts/monitoring/><span class="toggle fa fa-angle-right"></span><span class=menu-item-text>Monitoring</span></a><ul><li data-nav-id=/documentation/concepts/monitoring/alerting/ title=Alerting class=dd-item data-depth=2><a href=/documentation/concepts/monitoring/alerting/><span class=toggle></span><span class=menu-item-text></span>Alerting</span></a></a></li><li data-nav-id=/documentation/concepts/monitoring/extending/ title="Extending the Monitoring Stack" class=dd-item data-depth=2><a href=/documentation/concepts/monitoring/extending/><span class=toggle></span><span class=menu-item-text></span>Extending the Monitoring Stack</span></a></a></li><li data-nav-id=/documentation/concepts/monitoring/operator_alerts/ title="Operator Alerts" class=dd-item data-depth=2><a href=/documentation/concepts/monitoring/operator_alerts/><span class=toggle></span><span class=menu-item-text></span>Operator Alerts</span></a></a></li><li data-nav-id=/documentation/concepts/monitoring/user_alerts/ title="User Alerts" class=dd-item data-depth=2><a href=/documentation/concepts/monitoring/user_alerts/><span class=toggle></span><span class=menu-item-text></span>User Alerts</span></a></a></li></ul></li><li data-nav-id=/documentation/concepts/deployment/deploy_gardenlet_automatically/ title="Automatic Deployment of Gardenlets" class="dd-item top-level" data-depth=1><a href=/documentation/concepts/deployment/deploy_gardenlet_automatically/><span class=toggle></span><span class=menu-item-text></span>Automatic Deployment of Gardenlets</span></a></a></li><li data-nav-id=/documentation/concepts/deployment/deploy_gardenlet_manually/ title="Deploy a Gardenlet Manually" class="dd-item top-level" data-depth=1><a href=/documentation/concepts/deployment/deploy_gardenlet_manually/><span class=toggle></span><span class=menu-item-text></span>Deploy a Gardenlet Manually</span></a></a></li><li data-nav-id=/documentation/concepts/deployment/deploy_gardenlet/ title="Deploying Gardenlets" class="dd-item top-level" data-depth=1><a href=/documentation/concepts/deployment/deploy_gardenlet/><span class=toggle></span><span class=menu-item-text></span>Deploying Gardenlets</span></a></a></li><li data-nav-id=/documentation/concepts/deployment/setup_gardener/ title="Deploying the Gardener into a Kubernetes cluster" class="dd-item top-level" data-depth=1><a href=/documentation/concepts/deployment/setup_gardener/><span class=toggle></span><span class=menu-item-text></span>Deploying the Gardener into a Kubernetes cluster</span></a></a></li><li data-nav-id=/documentation/concepts/deployment/aks/ title="Deploying the previous Gardener versions and a Seed into an AKS cluster" class="dd-item top-level" data-depth=1><a href=/documentation/concepts/deployment/aks/><span class=toggle></span><span class=menu-item-text></span>Deploying the previous Gardener versions and a Seed into an AKS cluster</span></a></a></li><li data-nav-id=/documentation/concepts/deployment/feature_gates/ title="Feature Gates" class="dd-item top-level" data-depth=1><a href=/documentation/concepts/deployment/feature_gates/><span class=toggle></span><span class=menu-item-text></span>Feature Gates</span></a></a></li><li data-nav-id=/documentation/concepts/deployment/image_vector/ title="Image Vector" class="dd-item top-level" data-depth=1><a href=/documentation/concepts/deployment/image_vector/><span class=toggle></span><span class=menu-item-text></span>Image Vector</span></a></a></li><li data-nav-id=/documentation/concepts/mcm/ title="Machine Controller Manager" class="dd-item top-level" data-depth=1><a href=/documentation/concepts/mcm/><span class=toggle></span><span class=menu-item-text></span>Machine Controller Manager</span></a></a></li></ul></li></ul></div></nav><a href=# class=menu-toggler><i class="fa fa-angle-double-left"></i></a><script>$(document).ready(function(){$("#sidebar .dd-item:not(.top-level):not(.parent)").hide();$("#sidebar .dd-item.parent").siblings(".dd-item").show();$('.dd-item',"#sidebar .dd-item.parent").show();$(".menu-toggler").click(function(evt){$("#sidebar").toggleClass("collapsed");$(".menu-toggler span").toggleClass("fa-angle-double-left");$(".menu-toggler span").toggleClass("fa-angle-double-right");});})</script><section><div class="highlightable body-inner-wrapper"><div id=body-inner class=external><div class="docs page"><div class=git-wr><div class=page-contributors>Contributors to this page<div class=contributors-list><a href=mailto:rafael.franzke@sap.com><img class=user-icon src="https://avatars.githubusercontent.com/u/19169361?v=4" title="Rafael Franzke"></a>
<a href=mailto:i.alidjikov@gmail.com><img class=user-icon src="https://avatars.githubusercontent.com/u/9372594?v=4" title=ialidzhikov></a></div></div><div class=origin-tools><div class=page-edit><div id=top-github-link><a class=github-link title="Edit page" href=https://github.com/gardener/gardener/blob/master/docs/extensions/controllerregistration.md target=blank><i class="fa fa-edit"></i><span id=top-github-link-text title="Edit page"></span></a></div></div></div></div><h1 id=registering-extension-controllers>Registering Extension Controllers</h1><p>Extensions are registered in the garden cluster via <a href=https://github.com/gardener/gardener/blob/master/example/25-controllerregistration.yaml><code>ControllerRegistration</code></a> resources.
Gardener is evaluating the registrations and creates <a href=https://github.com/gardener/gardener/blob/master/example/25-controllerinstallation.yaml><code>ControllerInstallation</code></a> resources which describe the request &ldquo;please install this controller <code>X</code> to this seed <code>Y</code>&rdquo;.</p><p>Similar to how <code>CloudProfile</code> or <code>Seed</code> resources get into the system, the Gardener administrator must deploy the <code>ControllerRegistration</code> resources (this does not happen automatically in any way - the administrator decides which extensions shall be enabled).</p><p>The specification mainly describes which of Gardener&rsquo;s extension CRDs are managed, for example:</p><div class=highlight><pre class=chroma><code class=language-yaml data-lang=yaml><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>core.gardener.cloud/v1beta1</span><span class=w>
</span><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>ControllerRegistration</span><span class=w>
</span><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>os-coreos</span><span class=w>
</span><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=nt>resources</span><span class=p>:</span><span class=w>
</span><span class=w>  </span>- <span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>OperatingSystemConfig</span><span class=w>
</span><span class=w>    </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>coreos</span><span class=w>
</span><span class=w>    </span><span class=nt>primary</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></code></pre></div><p>This information tells Gardener that there is an extension controller that can handle <code>OperatingSystemConfig</code> resources of type <code>coreos</code>.</p><p>Also, it specifies that this controller is the primary one responsible for the lifecycle of the <code>OperatingSystemConfig</code> resource.
Setting <code>primary</code> to <code>false</code> would allow to register additional, secondary controllers that may also watch/react on the <code>OperatingSystemConfig/coreos</code> resources, however, only the primary controller may change/update the main <code>status</code> of the extension object (that are used to &ldquo;communicate&rdquo; with the Gardenlet).
Particularly, only the primary controller may set <code>.status.lastOperation</code>, <code>.status.lastError</code>, <code>.status.observedGeneration</code>, and <code>.status.state</code>.
Secondary controllers may contribute to the <code>.status.conditions[]</code> if they like, of course.</p><p>Secondary controllers might be helpful in scenarios where additional tasks need to be completed which are not part of the reconciliation logic of the primary controller but separated out into a dedicated extension.</p><p>⚠️ There must be exactly one primary controller for every registered kind/type combination.
Also, please note that the <code>primary</code> field cannot be changed after creation of the <code>ControllerRegistration</code>.</p><h2 id=deploying-extension-controllers>Deploying Extension Controllers</h2><p>Submitting above <code>ControllerRegistration</code> will create a <code>ControllerInstallation</code> resource:</p><div class=highlight><pre class=chroma><code class=language-yaml data-lang=yaml><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>core.gardener.cloud/v1beta1</span><span class=w>
</span><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>ControllerInstallation</span><span class=w>
</span><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>os-coreos</span><span class=w>
</span><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=nt>registrationRef</span><span class=p>:</span><span class=w>
</span><span class=w>    </span><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>core.gardener.cloud/v1beta1</span><span class=w>
</span><span class=w>    </span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>ControllerRegistration</span><span class=w>
</span><span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>os-coreos</span><span class=w>
</span><span class=w>  </span><span class=nt>seedRef</span><span class=p>:</span><span class=w>
</span><span class=w>    </span><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>core.gardener.cloud/v1beta1</span><span class=w>
</span><span class=w>    </span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Seed</span><span class=w>
</span><span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>aws-eu1</span><span class=w>
</span></code></pre></div><p>This resource expresses that Gardener requires the <code>os-coreos</code> extension controller to run on the <code>aws-eu1</code> seed cluster.</p><p>The Gardener Controller Manager does automatically determine which extension is required on which seed cluster and will only create <code>ControllerInstallation</code> objects for those.
Also, it will automatically delete <code>ControllerInstallation</code>s referencing extension controllers that are no longer required on a seed (e.g., because all shoots on it have been deleted).
There are additional configuration options, please see <a href=#deployment-configuration-options>this section</a>.</p><h2 id=how-do-extension-controllers-get-deployed-to-seeds>How do extension controllers get deployed to seeds?</h2><p>After Gardener has written the <code>ControllerInstallation</code> resource some component must satisfy this request and start deploying the extension controller to the seed.
Depending on the complexity of the controllers lifecycle management, configuration, etc. there are two possible scenarios:</p><h3 id=scenario-1-deployed-by-gardener>Scenario 1: Deployed by Gardener</h3><p>In many cases the extension controllers are easy to deploy and configure.
It is sufficient to simply create a Helm chart (standardized way of packaging software in the Kubernetes context) and deploy it together with some static configuration values.
Gardener supports this scenario and allows to provide arbitrary deployment information in the <code>ControllerRegistration</code> resource&rsquo;s <code>.spec</code> section:</p><div class=highlight><pre class=chroma><code class=language-yaml data-lang=yaml><span class=nn>...</span><span class=w>
</span><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=l>...</span><span class=w>
</span><span class=w>  </span><span class=nt>deployment</span><span class=p>:</span><span class=w>
</span><span class=w>    </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>helm</span><span class=w>
</span><span class=w>    </span><span class=nt>providerConfig</span><span class=p>:</span><span class=w>
</span><span class=w>      </span><span class=nt>chart</span><span class=p>:</span><span class=w> </span><span class=l>H4sIFAAAAAAA/yk...</span><span class=w>
</span><span class=w>      </span><span class=nt>values</span><span class=p>:</span><span class=w>
</span><span class=w>        </span><span class=nt>foo</span><span class=p>:</span><span class=w> </span><span class=l>bar</span><span class=w>
</span></code></pre></div><p>If <code>.spec.deployment.type=helm</code> then Gardener itself will take over the responsibility the deployment.
It base64-decodes the provided Helm chart (<code>.spec.deployment.providerConfig.chart</code>) and deploys it with the provided static configuration (<code>.spec.deployment.providerConfig.values</code>).
The chart and the values can be updated at any time - Gardener will recognize and re-trigger the deployment process.</p><p>In order to allow extensions to get information about the garden and the seed cluster Gardener does mix-in certain properties into the values (root level) of every deployed Helm chart:</p><div class=highlight><pre class=chroma><code class=language-yaml data-lang=yaml><span class=nt>gardener</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=nt>garden</span><span class=p>:</span><span class=w>
</span><span class=w>    </span><span class=nt>identifier</span><span class=p>:</span><span class=w> </span><span class=l>&lt;uuid-of-gardener-installation&gt;</span><span class=w>
</span><span class=w>  </span><span class=nt>seed</span><span class=p>:</span><span class=w>
</span><span class=w>    </span><span class=nt>identifier</span><span class=p>:</span><span class=w> </span><span class=l>&lt;seed-name&gt;</span><span class=w>
</span><span class=w>    </span><span class=nt>region</span><span class=p>:</span><span class=w> </span><span class=l>europe</span><span class=w>
</span><span class=w>    </span><span class=nt>spec</span><span class=p>:</span><span class=w> </span><span class=l>&lt;complete-seed-spec&gt;</span><span class=w>
</span></code></pre></div><p>Extensions can use this information in their Helm chart in case they require knowledge about the garden and the seed environment.
The list might be extended in the future.</p><p>:information_source: Gardener uses the UUID of the <code>garden</code> <code>Namespace</code> object in the <code>.gardener.garden.identifier</code> property.</p><h3 id=scenario-2-deployed-by-a-non-human-kubernetes-operator>Scenario 2: Deployed by a (non-human) Kubernetes operator</h3><p>Some extension controllers might be more complex and require additional domain-specific knowledge wrt. lifecycle or configuration.
In this case, we encourage to follow the Kubernetes operator pattern and deploy a dedicated operator for this extension into the garden cluster.
The <code>ControllerResource</code>&rsquo;s <code>.spec.deployment.type</code> field would then not be <code>helm</code>, and no Helm chart or values need to be provided there.
Instead, the operator itself knows how to deploy the extension into the seed.
It must watch <code>ControllerInstallation</code> resources and act one those referencing a <code>ControllerRegistration</code> the operator is responsible for.</p><p>In order to let Gardener know that the extension controller is ready and running in the seed the <code>ControllerInstallation</code>&rsquo;s <code>.status</code> field supports two conditions: <code>RegistrationValid</code> and <code>InstallationSuccessful</code> - both must be provided by the responsible operator:</p><div class=highlight><pre class=chroma><code class=language-yaml data-lang=yaml><span class=nn>...</span><span class=w>
</span><span class=w></span><span class=nt>status</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=nt>conditions</span><span class=p>:</span><span class=w>
</span><span class=w>  </span>- <span class=nt>lastTransitionTime</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;2019-01-22T11:51:11Z&#34;</span><span class=w>
</span><span class=w>    </span><span class=nt>lastUpdateTime</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;2019-01-22T11:51:11Z&#34;</span><span class=w>
</span><span class=w>    </span><span class=nt>message</span><span class=p>:</span><span class=w> </span><span class=l>Chart could be rendered successfully.</span><span class=w>
</span><span class=w>    </span><span class=nt>reason</span><span class=p>:</span><span class=w> </span><span class=l>RegistrationValid</span><span class=w>
</span><span class=w>    </span><span class=nt>status</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;True&#34;</span><span class=w>
</span><span class=w>    </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>Valid</span><span class=w>
</span><span class=w>  </span>- <span class=nt>lastTransitionTime</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;2019-01-22T11:51:12Z&#34;</span><span class=w>
</span><span class=w>    </span><span class=nt>lastUpdateTime</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;2019-01-22T11:51:12Z&#34;</span><span class=w>
</span><span class=w>    </span><span class=nt>message</span><span class=p>:</span><span class=w> </span><span class=l>Installation of new resources succeeded.</span><span class=w>
</span><span class=w>    </span><span class=nt>reason</span><span class=p>:</span><span class=w> </span><span class=l>InstallationSuccessful</span><span class=w>
</span><span class=w>    </span><span class=nt>status</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;True&#34;</span><span class=w>
</span><span class=w>    </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>Installed</span><span class=w>
</span></code></pre></div><p>Additionally, the <code>.status</code> field has a <code>providerStatus</code> section into which the operator can (optionally) put any arbitrary data associated with this installation.</p><h2 id=extensions-in-the-garden-cluster-itself>Extensions in the garden cluster itself</h2><p>The <code>Shoot</code> resource itself will contain some provider-specific data blobs.
As a result, some extensions might also want to run in the garden cluster, e.g., to provide <code>ValidatingWebhookConfiguration</code>s for validating the correctness of their provider-specific blobs:</p><div class=highlight><pre class=chroma><code class=language-yaml data-lang=yaml><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>core.gardener.cloud/v1beta1</span><span class=w>
</span><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Shoot</span><span class=w>
</span><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>johndoe-aws</span><span class=w>
</span><span class=w>  </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class=l>garden-dev</span><span class=w>
</span><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=l>...</span><span class=w>
</span><span class=w>  </span><span class=nt>cloud</span><span class=p>:</span><span class=w>
</span><span class=w>    </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>aws</span><span class=w>
</span><span class=w>    </span><span class=nt>region</span><span class=p>:</span><span class=w> </span><span class=l>eu-west-1</span><span class=w>
</span><span class=w>    </span><span class=nt>providerConfig</span><span class=p>:</span><span class=w>
</span><span class=w>      </span><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>aws.cloud.gardener.cloud/v1alpha1</span><span class=w>
</span><span class=w>      </span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>InfrastructureConfig</span><span class=w>
</span><span class=w>      </span><span class=nt>networks</span><span class=p>:</span><span class=w>
</span><span class=w>        </span><span class=nt>vpc</span><span class=p>:</span><span class=w> </span><span class=c># specify either &#39;id&#39; or &#39;cidr&#39;</span><span class=w>
</span><span class=w>        </span><span class=c># id: vpc-123456</span><span class=w>
</span><span class=w>          </span><span class=nt>cidr</span><span class=p>:</span><span class=w> </span><span class=m>10.250.0.0</span><span class=l>/16</span><span class=w>
</span><span class=w>        </span><span class=nt>internal</span><span class=p>:</span><span class=w>
</span><span class=w>        </span>- <span class=m>10.250.112.0</span><span class=l>/22</span><span class=w>
</span><span class=w>        </span><span class=nt>public</span><span class=p>:</span><span class=w>
</span><span class=w>        </span>- <span class=m>10.250.96.0</span><span class=l>/22</span><span class=w>
</span><span class=w>        </span><span class=nt>workers</span><span class=p>:</span><span class=w>
</span><span class=w>        </span>- <span class=m>10.250.0.0</span><span class=l>/19</span><span class=w>
</span><span class=w>      </span><span class=nt>zones</span><span class=p>:</span><span class=w>
</span><span class=w>      </span>- <span class=l>eu-west-1a</span><span class=w>
</span><span class=w></span><span class=nn>...</span><span class=w>
</span></code></pre></div><p>In the above example, Gardener itself does not understand the AWS-specific provider configuration for the infrastructure.
However, if this part of the <code>Shoot</code> resource should be validated then you should run an AWS-specific component in the garden cluster that registers a webhook. You can do it similarly if you want to default some fields of a resource (by using a <code>MutatingWebhookConfiguration</code>).</p><p>Again, similar to how Gardener is deployed to the garden cluster, these components must be deployed and managed by the Gardener administrator.</p><h3 id=extension-resource-configurations><code>Extension</code> resource configurations</h3><p>The <code>Extension</code> resource allows injecting arbitrary steps into the shoot reconciliation flow that are unknown to Gardener.
Hence, it is slightly special and allows further configuration when registering it:</p><div class=highlight><pre class=chroma><code class=language-yaml data-lang=yaml><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>core.gardener.cloud/v1beta1</span><span class=w>
</span><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>ControllerRegistration</span><span class=w>
</span><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>extension-foo</span><span class=w>
</span><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=nt>resources</span><span class=p>:</span><span class=w>
</span><span class=w>  </span>- <span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Extension</span><span class=w>
</span><span class=w>    </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>foo</span><span class=w>
</span><span class=w>    </span><span class=nt>primary</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span><span class=w>    </span><span class=nt>globallyEnabled</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span><span class=w>    </span><span class=nt>reconcileTimeout</span><span class=p>:</span><span class=w> </span><span class=l>30s</span><span class=w>
</span></code></pre></div><p>The <code>globallyEnabled=true</code> option specifies that the <code>Extension/foo</code> object shall be created by default for all shoots (unless they opted out by setting <code>.spec.extensions[].enabled=false</code> in the <code>Shoot</code> spec).</p><p>The <code>reconcileTimeout</code> tells Gardener how long it should wait during its shoot reconciliation flow for the <code>Extension/foo</code>&rsquo;s reconciliation to finish.</p><h3 id=deployment-configuration-options>Deployment configuration options</h3><p>The <code>.spec.deployment</code> resource allows to configure a deployment <code>policy</code>.
There are the following policies:</p><ul><li><code>OnDemand</code> (default): Gardener will demand the deployment and deletion of the extension controller to/from seed clusters dynamically. It will automatically determine (based on other resources like <code>Shoot</code>s) whether it is required and decide accordingly.</li><li><code>Always</code>: Gardener will demand the deployment of the extension controller to seed clusters independent of whether it is actually required or not. This might be helpful if you want to add a new component/controller to all seed clusters by default. Another use-case is to minimize the durations until extension controllers get deployed and ready in case you have highly fluctuating seed clusters.</li><li><code>AlwaysExceptNoShoots</code>: Similar to <code>Always</code>, but if the seed does not have any shoots then the extension is not being deployed. It will be deleted from a seed after the last shoot has been removed from it.</li></ul><p>Also, the <code>.spec.deployment.seedSelector</code> allows to specify a label selector for seed clusters.
Only if it matches the labels of a seed then it will be deployed to it.
Please note that a seed selector can only be specified for secondary controllers (<code>primary=false</code> for all <code>.spec.resources[]</code>).</p></div></div></div><div class=howto_tickets><a href=https://github.com/gardener/gardener/issues/new/choose target=_blank><span>Let us know how can we improve.</span>
<span>Open<img src=https://gardener.cloud/images/branding/github-mark-logo-green.svg title=GitHub>issue <i class="fa fa-external-link" aria-hidden=true></i></span></a></div></section></div><style></style><footer class=footer><div class="container footer-wrapper"><ul class=nav><li><a href=/blog/>Blogs</a></li><li><a href=/community/>Community</a></li><li><a href=/adopter/>Adopters</a></li><li><a href=/documentation/home>Documentation</a></li></ul><img src=/images/lp/gardener-logo.svg alt="Logo Gardener" class=logo><ul class=media-wr><li><a target=_blank href=https://kubernetes.slack.com/archives/CB57N0BFG><img src=/images/branding/slack-logo-white.svg class=media-icon><div class=media-text>Slack</div></a></li><li><a target=_blank href=https://github.com/gardener><img src=/images/branding/github-mark-logo.png class=media-icon><div class=media-text>GitHub</div></a></li><li><a target=_blank href=https://www.youtube.com/channel/UCwUhwKFREV8Su0gwAJQX7tw><img src=/images/branding/youtube-logo-dark.svg class=media-icon><div class=media-text>YouTube</div></a></li><li><a target=_blank href=https://twitter.com/GardenerProject><img src=/images/branding/twitter-logo-white.svg class=media-icon><div class=media-text>Twitter</div></a></li></ul><span class=copyright>Copyright 2019-2021 Gardener project authors. <a href=https://www.sap.com/corporate/en/legal/privacy.html>Privacy policy
<i class="fa fa-external-link" aria-hidden=true></i></a></span></div></footer><script src=/js/jquery.sticky.js?1616133831></script><script src=/js/modernizr.custom.min.js?1616133831></script><script src=/js/code-snippets.js?1616133831></script><script>$(document).ready(function(){inlineSVG.init();$("[data-publishdate]").each(function(){$(this).text(moment($(this,"YYYY-MM-DD","YYYY-MM-DD hh:mm:ss").attr("data-publishdate")).fromNow());});new ClipboardJS('.clipboard-copy');$("body").codeSnippets();});</script><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-W2FGNSX" height=0 width=0 style=display:none;visibility:hidden></iframe></noscript></body></html>