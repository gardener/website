<!doctype html><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Project Gardener Website - A Managed Kubernetes Service Done Right"><meta name=copyright content="Copyright 2019 Gardener project authors."><meta name=google-site-verification content="9EoGiMwk2aq0E_tVh16iJgJbp7fbyqkfWH9b5sGybl0"><title>Logging and Monitoring for Extensions :: Gardener</title><link rel=icon type=image/x-icon href=https://gardener.cloud/images/favicon.ico><link rel=icon type=image/png href=https://gardener.cloud/images/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=https://gardener.cloud/images/favicon-16x16.png sizes=16x16><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-W2FGNSX');</script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','UA-165447164-1');</script><link href=/css/nucleus.css?1604308781 rel=stylesheet><link href=/css/font-awesome.min.css?1604308781 rel=stylesheet><link href=/css/hybrid.css?1604308781 rel=stylesheet><link href=/css/featherlight.min.css?1604308781 rel=stylesheet><link href=/css/perfect-scrollbar.min.css?1604308781 rel=stylesheet><link href=/css/auto-complete.css?1604308781 rel=stylesheet><link href=/css/skeleton.css?1604308781 rel=stylesheet><link href=/css/sheetslider.css?1604308781 rel=stylesheet><link rel=stylesheet href=/css/gardener.e2ca9959244349715932e2bbb82ec914af6743c4148bb41946b0aea714f04a0d.css><script src=/js/moment.js?1604308781></script><script src=/js/vivus.js?1604308781></script><script src=/js/scrollreveal.js?1604308781></script><script src=/js/inlineSVG.js?1604308781></script><script src=/js/jquery.min.js?1604308781></script><script src=/js/fixed.js?1604308781></script><script src=/js/clipboard.min.js?1604308781></script><script src=https://platform.linkedin.com/in.js type=text/javascript>lang:en_US</script></head><body data-url=/v1.10.0/concepts/extensions/logging-and-monitoring/ class=has-sticky-navigation><script>$(document).ready(function(){function initStickyNav(){var stickyPoint;var tln=document.querySelector(".tln");if(!tln){return;}
var stickyPointEl=document.querySelector(".sticky-nav-point");if(stickyPointEl==null){stickyPointEl=document.querySelector("body");stickyPoint=0;}else{stickyPoint=stickyPointEl.clientHeight+stickyPointEl.offsetTop;}
var bodySelector=document.getElementsByTagName("body")[0];var tlnHeight=tln.clientHeight;var stickyNavigation=function(){if(window.pageYOffset+tlnHeight>=stickyPoint){bodySelector.classList.add("has-sticky-navigation");tln.classList.add("sticky-top");}else{bodySelector.classList.remove("has-sticky-navigation");tln.classList.remove("sticky-top");}}
window.onscroll=function(){stickyNavigation();};}
initStickyNav();function closeAllSelect(){document.getElementById("docOptions").classList.remove("show");}
function show(e){e.stopPropagation();document.getElementById("docOptions").classList.add("show");}
document.addEventListener("click",closeAllSelect);document.getElementById("docSelector").addEventListener("click",show);});</script><div class="tln fixedsticky sticky-top"><header class=navigation><div class=container><div class=navigation-wrapper><a href=/ class=logo><img src=/images/logo.svg>
<span class=title>Gardener</span></a>
<a class="nav-button navbar-toggler" href=#><i class="fa fa-bars"></i></a><div class=navbar-collapse><ul class=links><li class=link><a href=/blog/>Blogs</a></li><li class=link><a href=/community/>Community</a></li><li class=link><a href=/adopter/>Adopters</a></li><li class="link has-child active"><a id=docSelector>Documentation v1.10.0</a><div id=docOptions class=doc-options><ul><li><a href=/documentation/home>Documentation
v1.11.0</a></li><li><a href=/v1.10.0/home class=activeVersion>Documentation
v1.10.0</a></li><li><a href=//home>Documentation</a></li></ul></div></li></ul></div></div></div></header></div><script>$(".navigation .navbar-toggler").click(function(evt){$(".navigation .navbar-collapse").toggle();$(".navigation").toggleClass("collapsed");$(".navigation .search-box").toggle();})</script><style>#docSelector{cursor:pointer}.doc-options{position:fixed;background-color:#0b8062;text-align:left;display:none}.doc-options ul li{margin-bottom:0}.doc-options ul li a:hover{background-color:#0c694f}.doc-options ul{list-style:none;padding:0;margin:0;text-align:left}.doc-options ul li a{padding:10px;margin:0}.doc-options .activeVersion{background-color:#ec682a}.show{display:block}</style><div class=sln><div class=overlay-band><ul class="nav-list container"><li title=Home><a class=navbar-link href=/v1.10.0/home/>Home</a></li><li title=Concepts><a class="navbar-link is-active" href=/v1.10.0/concepts/>Concepts</a></li><li title="How-To Guides"><a class=navbar-link href=/v1.10.0/guides/>How-To Guides</a></li><li title=Tutorials><a class=navbar-link href=/v1.10.0/tutorials/>Tutorials</a></li><li title="API Reference"><a class=navbar-link href=/v1.10.0/references/>API Reference</a></li><li title=Contribute><a class=navbar-link href=/v1.10.0/contribute/>Contribute</a></li></ul></div></div><div class="main container"><nav id=sidebar class="collapsed container menu"><div class=highlightable><ul class=topics><li data-nav-id=/v1.10.0/concepts/ title=Concepts class="dd-item parent root collapsible" data-depth=0><a href=/v1.10.0/concepts/><span class=menu-item-text>Concepts</span></a><ul><li data-nav-id=/v1.10.0/concepts/core-components/ title="Core Components" class="dd-item top-level collapsible collapsed" data-depth=1><a href=/documentation/concepts/core-components/api-server><span class="toggle fa fa-angle-right"></span><span class=menu-item-text>Core Components</span></a><ul><li data-nav-id=/v1.10.0/concepts/core-components/api-server/ title="Gardener API Server" class="dd-item collapsible collapsed" data-depth=2><a href=/v1.10.0/concepts/core-components/api-server/><span class="toggle fa fa-angle-right"></span><span class=menu-item-text>Gardener API Server</span></a><ul><li data-nav-id=/v1.10.0/concepts/core-components/api-server/admission-plugins/ title="In-Tree Admission Plugins" class=dd-item data-depth=3><a href=/v1.10.0/concepts/core-components/api-server/admission-plugins/><span class=toggle></span><span class=menu-item-text></span>In-Tree Admission Plugins</span></a></a></li></ul></li><li data-nav-id=/v1.10.0/concepts/core-components/scheduler/ title="Gardener Scheduler" class=dd-item data-depth=2><a href=/v1.10.0/concepts/core-components/scheduler/><span class=toggle></span><span class=menu-item-text></span>Gardener Scheduler</span></a></a></li><li data-nav-id=/v1.10.0/concepts/core-components/seed-admission-ctrl/ title="Gardener Seed Admission Controller" class=dd-item data-depth=2><a href=/v1.10.0/concepts/core-components/seed-admission-ctrl/><span class=toggle></span><span class=menu-item-text></span>Gardener Seed Admission Controller</span></a></a></li><li data-nav-id=/v1.10.0/concepts/core-components/gardenlet/ title=gardenlet class=dd-item data-depth=2><a href=/v1.10.0/concepts/core-components/gardenlet/><span class=toggle></span><span class=menu-item-text></span>gardenlet</span></a></a></li></ul></li><li data-nav-id=/v1.10.0/concepts/backup-restore/ title="Backup and Restore" class="dd-item top-level" data-depth=1><a href=/v1.10.0/concepts/backup-restore/><span class=toggle></span><span class=menu-item-text>Backup and Restore</span></a></li><li data-nav-id=/v1.10.0/concepts/extensions/ title=Extensions class="dd-item parent top-level collapsible" data-depth=1><a href=/v1.10.0/concepts/extensions/><span class="toggle fa fa-angle-down"></span><span class=menu-item-text>Extensions</span></a><ul><li data-nav-id=/v1.10.0/concepts/extensions/backupbucket/ title="BackupBucket resource" class=dd-item data-depth=2><a href=/v1.10.0/concepts/extensions/backupbucket/><span class=toggle></span><span class=menu-item-text></span>BackupBucket resource</span></a></a></li><li data-nav-id=/v1.10.0/concepts/extensions/backupentry/ title="BackupEntry resource" class=dd-item data-depth=2><a href=/v1.10.0/concepts/extensions/backupentry/><span class=toggle></span><span class=menu-item-text></span>BackupEntry resource</span></a></a></li><li data-nav-id=/v1.10.0/concepts/extensions/cluster/ title="Cluster resource" class=dd-item data-depth=2><a href=/v1.10.0/concepts/extensions/cluster/><span class=toggle></span><span class=menu-item-text></span>Cluster resource</span></a></a></li><li data-nav-id=/v1.10.0/concepts/extensions/shoot-health-status-conditions/ title="Contributing to shoot health status conditions" class=dd-item data-depth=2><a href=/v1.10.0/concepts/extensions/shoot-health-status-conditions/><span class=toggle></span><span class=menu-item-text></span>Contributing to shoot health status conditions</span></a></a></li><li data-nav-id=/v1.10.0/concepts/extensions/controlplane-webhooks/ title="Controlplane customization webhooks" class=dd-item data-depth=2><a href=/v1.10.0/concepts/extensions/controlplane-webhooks/><span class=toggle></span><span class=menu-item-text></span>Controlplane customization webhooks</span></a></a></li><li data-nav-id=/v1.10.0/concepts/extensions/controlplane/ title="ControlPlane resource" class=dd-item data-depth=2><a href=/v1.10.0/concepts/extensions/controlplane/><span class=toggle></span><span class=menu-item-text></span>ControlPlane resource</span></a></a></li><li data-nav-id=/v1.10.0/concepts/extensions/controlplane-exposure/ title="ControlPlane resource with purpose exposure" class=dd-item data-depth=2><a href=/v1.10.0/concepts/extensions/controlplane-exposure/><span class=toggle></span><span class=menu-item-text></span>ControlPlane resource with purpose exposure</span></a></a></li><li data-nav-id=/v1.10.0/concepts/extensions/dns/ title="DNSProvider and DNSEntry resources" class=dd-item data-depth=2><a href=/v1.10.0/concepts/extensions/dns/><span class=toggle></span><span class=menu-item-text></span>DNSProvider and DNSEntry resources</span></a></a></li><li data-nav-id=/v1.10.0/concepts/extensions/project-roles/ title="Extending project roles" class=dd-item data-depth=2><a href=/v1.10.0/concepts/extensions/project-roles/><span class=toggle></span><span class=menu-item-text></span>Extending project roles</span></a></a></li><li data-nav-id=/v1.10.0/concepts/extensions/overview/ title="Extensibility overview" class=dd-item data-depth=2><a href=/v1.10.0/concepts/extensions/overview/><span class=toggle></span><span class=menu-item-text></span>Extensibility overview</span></a></a></li><li data-nav-id=/v1.10.0/concepts/extensions/extension/ title="Extension resource" class=dd-item data-depth=2><a href=/v1.10.0/concepts/extensions/extension/><span class=toggle></span><span class=menu-item-text></span>Extension resource</span></a></a></li><li data-nav-id=/v1.10.0/concepts/extensions/containerruntime/ title="Gardener Container Runtime Extension" class=dd-item data-depth=2><a href=/v1.10.0/concepts/extensions/containerruntime/><span class=toggle></span><span class=menu-item-text></span>Gardener Container Runtime Extension</span></a></a></li><li data-nav-id=/v1.10.0/concepts/extensions/network/ title="Gardener Network Extension" class=dd-item data-depth=2><a href=/v1.10.0/concepts/extensions/network/><span class=toggle></span><span class=menu-item-text></span>Gardener Network Extension</span></a></a></li><li data-nav-id=/v1.10.0/concepts/extensions/conventions/ title="General conventions" class=dd-item data-depth=2><a href=/v1.10.0/concepts/extensions/conventions/><span class=toggle></span><span class=menu-item-text></span>General conventions</span></a></a></li><li data-nav-id=/v1.10.0/concepts/extensions/healthcheck-library/ title="Health Check Library" class=dd-item data-depth=2><a href=/v1.10.0/concepts/extensions/healthcheck-library/><span class=toggle></span><span class=menu-item-text></span>Health Check Library</span></a></a></li><li data-nav-id=/v1.10.0/concepts/extensions/infrastructure/ title="Infrastructure resource" class=dd-item data-depth=2><a href=/v1.10.0/concepts/extensions/infrastructure/><span class=toggle></span><span class=menu-item-text></span>Infrastructure resource</span></a></a></li><li data-nav-id=/v1.10.0/concepts/extensions/logging-and-monitoring/ title="Logging and Monitoring for Extensions" class="dd-item active" data-depth=2><a href=/v1.10.0/concepts/extensions/logging-and-monitoring/><span class=toggle></span><span class=menu-item-text></span>Logging and Monitoring for Extensions</span></a></a></li><li data-nav-id=/v1.10.0/concepts/extensions/operatingsystemconfig/ title="OperatingSystemConfig resource" class=dd-item data-depth=2><a href=/v1.10.0/concepts/extensions/operatingsystemconfig/><span class=toggle></span><span class=menu-item-text></span>OperatingSystemConfig resource</span></a></a></li><li data-nav-id=/v1.10.0/concepts/extensions/referenced-resources/ title="Referenced Resources" class=dd-item data-depth=2><a href=/v1.10.0/concepts/extensions/referenced-resources/><span class=toggle></span><span class=menu-item-text></span>Referenced Resources</span></a></a></li><li data-nav-id=/v1.10.0/concepts/extensions/controllerregistration/ title="Registering Extension Controllers" class=dd-item data-depth=2><a href=/v1.10.0/concepts/extensions/controllerregistration/><span class=toggle></span><span class=menu-item-text></span>Registering Extension Controllers</span></a></a></li><li data-nav-id=/v1.10.0/concepts/extensions/shoot-maintenance/ title="Shoot maintenance" class=dd-item data-depth=2><a href=/v1.10.0/concepts/extensions/shoot-maintenance/><span class=toggle></span><span class=menu-item-text></span>Shoot maintenance</span></a></a></li><li data-nav-id=/v1.10.0/concepts/extensions/shoot-webhooks/ title="Shoot resource customization webhooks" class=dd-item data-depth=2><a href=/v1.10.0/concepts/extensions/shoot-webhooks/><span class=toggle></span><span class=menu-item-text></span>Shoot resource customization webhooks</span></a></a></li><li data-nav-id=/v1.10.0/concepts/extensions/worker/ title="Worker resource" class=dd-item data-depth=2><a href=/v1.10.0/concepts/extensions/worker/><span class=toggle></span><span class=menu-item-text></span>Worker resource</span></a></a></li></ul></li><li data-nav-id=/v1.10.0/concepts/networking/ title=Networking class="dd-item top-level collapsible collapsed" data-depth=1><a href=/v1.10.0/concepts/networking/><span class="toggle fa fa-angle-right"></span><span class=menu-item-text>Networking</span></a><ul><li data-nav-id=/v1.10.0/concepts/networking/dns-managment/ title="DNS Management" class=dd-item data-depth=2><a href=/v1.10.0/concepts/networking/dns-managment/><span class=toggle></span><span class=menu-item-text></span>DNS Management</span></a></a></li><li data-nav-id=/v1.10.0/concepts/networking/cert-managment/ title="Certificates Management" class=dd-item data-depth=2><a href=/v1.10.0/concepts/networking/cert-managment/><span class=toggle></span><span class=menu-item-text></span>Certificates Management</span></a></a></li><li data-nav-id=/v1.10.0/concepts/networking/networking-policies/ title="Network Policies" class=dd-item data-depth=2><a href=/v1.10.0/concepts/networking/networking-policies/><span class=toggle></span><span class=menu-item-text></span>Network Policies</span></a></a></li></ul></li><li data-nav-id=/v1.10.0/concepts/monitoring/ title=Monitoring class="dd-item top-level collapsible collapsed" data-depth=1><a href=/v1.10.0/concepts/monitoring/><span class="toggle fa fa-angle-right"></span><span class=menu-item-text>Monitoring</span></a><ul><li data-nav-id=/v1.10.0/concepts/monitoring/alerting/ title=Alerting class=dd-item data-depth=2><a href=/v1.10.0/concepts/monitoring/alerting/><span class=toggle></span><span class=menu-item-text></span>Alerting</span></a></a></li><li data-nav-id=/v1.10.0/concepts/monitoring/extending/ title="Extending the Monitoring Stack" class=dd-item data-depth=2><a href=/v1.10.0/concepts/monitoring/extending/><span class=toggle></span><span class=menu-item-text></span>Extending the Monitoring Stack</span></a></a></li><li data-nav-id=/v1.10.0/concepts/monitoring/operator-alerts/ title="Operator Alerts" class=dd-item data-depth=2><a href=/v1.10.0/concepts/monitoring/operator-alerts/><span class=toggle></span><span class=menu-item-text></span>Operator Alerts</span></a></a></li><li data-nav-id=/v1.10.0/concepts/monitoring/user_alerts/ title="User Alerts" class=dd-item data-depth=2><a href=/v1.10.0/concepts/monitoring/user_alerts/><span class=toggle></span><span class=menu-item-text></span>User Alerts</span></a></a></li></ul></li><li data-nav-id=/v1.10.0/concepts/deployment/deploy_gardenlet_automatically/ title="Automatic Deployment of Gardenlets" class="dd-item top-level" data-depth=1><a href=/v1.10.0/concepts/deployment/deploy_gardenlet_automatically/><span class=toggle></span><span class=menu-item-text></span>Automatic Deployment of Gardenlets</span></a></a></li><li data-nav-id=/components/bouquet/ title=Bouquet class="dd-item top-level" data-depth=1><a href=/components/bouquet/><span class=toggle></span><span class=menu-item-text></span>Bouquet</span></a></a></li><li data-nav-id=/components/dashboard/ title=Dashboard class="dd-item top-level" data-depth=1><a href=/components/dashboard/><span class=toggle></span><span class=menu-item-text></span>Dashboard</span></a></a></li><li data-nav-id=/v1.10.0/concepts/deployment/deploy_gardenlet_manually/ title="Deploy a Gardenlet Manually" class="dd-item top-level" data-depth=1><a href=/v1.10.0/concepts/deployment/deploy_gardenlet_manually/><span class=toggle></span><span class=menu-item-text></span>Deploy a Gardenlet Manually</span></a></a></li><li data-nav-id=/v1.10.0/concepts/deployment/deploy_gardenlet/ title="Deploying Gardenlets" class="dd-item top-level" data-depth=1><a href=/v1.10.0/concepts/deployment/deploy_gardenlet/><span class=toggle></span><span class=menu-item-text></span>Deploying Gardenlets</span></a></a></li><li data-nav-id=/v1.10.0/concepts/deployment/setup_gardener/ title="Deploying the Gardener into a Kubernetes cluster" class="dd-item top-level" data-depth=1><a href=/v1.10.0/concepts/deployment/setup_gardener/><span class=toggle></span><span class=menu-item-text></span>Deploying the Gardener into a Kubernetes cluster</span></a></a></li><li data-nav-id=/v1.10.0/concepts/deployment/ask/ title="Deploying the previous Gardener versions and a Seed into an AKS cluster" class="dd-item top-level" data-depth=1><a href=/v1.10.0/concepts/deployment/ask/><span class=toggle></span><span class=menu-item-text></span>Deploying the previous Gardener versions and a Seed into an AKS cluster</span></a></a></li><li data-nav-id=/v1.10.0/concepts/deployment/feature_gates/ title="Feature Gates" class="dd-item top-level" data-depth=1><a href=/v1.10.0/concepts/deployment/feature_gates/><span class=toggle></span><span class=menu-item-text></span>Feature Gates</span></a></a></li><li data-nav-id=/components/gardenctl/ title=gardenctl class="dd-item top-level" data-depth=1><a href=/components/gardenctl/><span class=toggle></span><span class=menu-item-text></span>gardenctl</span></a></a></li><li data-nav-id=/components/gardener/ title=Gardener class="dd-item top-level" data-depth=1><a href=/components/gardener/><span class=toggle></span><span class=menu-item-text></span>Gardener</span></a></a></li><li data-nav-id=/v1.10.0/concepts/deployment/image_vector/ title="Image Vector" class="dd-item top-level" data-depth=1><a href=/v1.10.0/concepts/deployment/image_vector/><span class=toggle></span><span class=menu-item-text></span>Image Vector</span></a></a></li><li data-nav-id=/components/kubify/ title=kubify class="dd-item top-level" data-depth=1><a href=/components/kubify/><span class=toggle></span><span class=menu-item-text></span>kubify</span></a></a></li><li data-nav-id=/v1.10.0/concepts/mcm/ title="Machine Controller Manager" class="dd-item top-level" data-depth=1><a href=/v1.10.0/concepts/mcm/><span class=toggle></span><span class=menu-item-text></span>Machine Controller Manager</span></a></a></li></ul></li></ul></div></nav><a href=# class=menu-toggler><i class="fa fa-angle-double-left"></i></a><script>$(document).ready(function(){$("#sidebar .dd-item:not(.top-level):not(.parent)").hide();$("#sidebar .dd-item.parent").siblings(".dd-item").show();$('.dd-item',"#sidebar .dd-item.parent").show();$(".menu-toggler").click(function(evt){$("#sidebar").toggleClass("collapsed");$(".menu-toggler span").toggleClass("fa-angle-double-left");$(".menu-toggler span").toggleClass("fa-angle-double-right");});})</script><section><div class="highlightable body-inner-wrapper"><div id=body-inner class=external><div class="docs page"><div class=git-wr><div class=page-contributors>Contributors to this page<div class=contributors-list><a href=mailto:rafael.franzke@sap.com><img class=user-icon src="https://avatars1.githubusercontent.com/u/19169361?v=4" title="Rafael Franzke"></a>
<a href=mailto:k.zhelyazkov@sap.com><img class=user-icon src="https://avatars3.githubusercontent.com/u/58623197?v=4" title=Zhelyazkov></a>
<a href=mailto:georgi.pavlov@sap.com><img class=user-icon src="https://avatars0.githubusercontent.com/u/52317188?v=4" title="Georgi Pavlov"></a>
<a href=mailto:vladimir.vasilev@sap.com><img class=user-icon src="https://avatars2.githubusercontent.com/u/38783428?v=4" title="Vladimir Vasilev"></a>
<a href=mailto:i.alidjikov@gmail.com><img class=user-icon src="https://avatars2.githubusercontent.com/u/9372594?v=4" title=ialidzhikov></a>
<a href=mailto:tim.ebert@sap.com><img class=user-icon src="https://avatars1.githubusercontent.com/u/46341950?v=4" title="Tim Ebert"></a>
<a href=https://github.com/gardener/gardener/blob/master/docs/extensions/logging-and-monitoring.md class=contributors-count>+ 5 more <i class="fa fa-external-link"></i></a></div></div><div class=page-edit><span class=last-update>Last update:
<span data-publishdate="2019-09-21 11:11:32"></span></span><div id=top-github-link><a class=github-link title="Edit this page" href=https://github.com/gardener/gardener/blob/master/docs/extensions/logging-and-monitoring.md target=blank><i class="fa fa-edit"></i><span id=top-github-link-text title="Edit this page"></span></a></div></div></div><h1 id=logging-and-monitoring-for-extensions>Logging and Monitoring for Extensions</h1><p>Gardener provides an integrated logging and monitoring stack for alerting, monitoring and troubleshooting of its managed components by operators or end users. For further information how to make use of it in these roles, refer to the corresponding guides for <a href=https://github.com/gardener/logging/tree/master/docs/usage/README.md>exploring logs</a> and for <a href=https://grafana.com/docs/grafana/latest/getting-started/getting-started/#all-users>monitoring with Grafana</a>.</p><p>The components that constitute the logging and monitoring stack are managed by Gardener. By default, it deploys <a href=https://prometheus.io/>Prometheus</a>, <a href=https://prometheus.io/docs/alerting/latest/alertmanager/>Alertmanager</a> and <a href=https://grafana.com/>Grafana</a> into the <code>garden</code> namespace of all seed clusters. If the <code>Logging</code> <a href=../../deployment/feature_gates>feature gate</a> in the <code>gardenlet</code> configuration is enabled, it will deploy <a href=https://fluentbit.io/>fluent-bit</a> and <a href=https://grafana.com/oss/loki/>Loki</a> in the <code>garden</code> namespace too.</p><p>Each shoot namespace hosts managed logging and monitoring components. As part of the shoot reconciliation flow, Gardener deploys a shoot-specific Prometheus, Grafana and, if configured, an Alertmanager into the shoot namespace, next to the other control plane components. If the <code>Logging</code> feature gate is enabled and the <a href=https://github.com/gardener/gardener/blob/master/docs/usage/shoot_purposes.md#behavioral-differences>shoot purpose</a> is not <code>testing</code>, it deploys a shoot-specific Loki in the shoot namespace too.</p><p>The logging and monitoring stack is extensible by configuration. Gardener extensions can take advantage of that and contribute configurations encoded in <code>ConfigMap</code>s for their own, specific dashboards, alerts, log parsers and other supported assets and integrate with it. As with other Gardener resources, they will be continuously reconciled.</p><p>This guide is about the roles and extensibility options of the logging and monitoring stack components, and how to integrate extensions with:</p><ul><li><a href=#monitoring>Monitoring</a></li><li><a href=#logging>Logging</a></li></ul><h2 id=monitoring>Monitoring</h2><p>The central Prometheus instance in the <code>garden</code> namespace fetches metrics and data from all seed cluster nodes and all seed cluster pods.
It uses the <a href=https://prometheus.io/docs/prometheus/latest/federation/>federation</a> concept to allow the shoot-specific instances to scrape only the metrics for the pods of the control plane they are responsible for.
This mechanism allows to scrape the metrics for the nodes/pods once for the whole cluster, and to have them distributed afterwards.</p><p>The shoot-specific metrics are then made available to operators and users in the shoot Grafana, using the shoot Prometheus as data source.</p><p>Extension controllers might deploy components as part of their reconciliation next to the shoot&rsquo;s control plane.
Examples for this would be a cloud-controller-manager or CSI controller deployments. Extensions that want to have their managed control plane components integrated with monitoring can contribute their per-shoot configuration for scraping Prometheus metrics, Alertmanager alerts or Grafana dashboards.</p><h3 id=extensions-monitoring-integration>Extensions monitoring integration</h3><p>Before deploying the shoot-specific Prometheus instance, Gardener will read all <code>ConfigMap</code>s in the shoot namespace, which are labeled with <code>extensions.gardener.cloud/configuration=monitoring</code>.
Such <code>ConfigMap</code>s may contain four fields in their <code>data</code>:</p><ul><li><p><code>scrape_config</code>: This field contains Prometheus scrape configuration for the component(s) and metrics that shall be scraped.</p></li><li><p><code>alerting_rules</code>: This field contains Alertmanager rules for alerts that shall be raised.</p></li><li><p><code>dashboard_operators</code>: This field contains a Grafana dashboard in JSON that is only relevant for Gardener operators.</p></li><li><p><code>dashboard_users</code>: This field contains a Grafana dashboard in JSON that is only relevant for Gardener users (shoot owners).</p></li></ul><p><strong>Example:</strong> A <code>ControlPlane</code> controller deploying a <code>cloud-controller-manager</code> into the shoot namespace wants to integrate monitoring configuration for scraping metrics, alerting rules and dashboards.</p><div class=highlight><pre class=chroma><code class=language-yaml data-lang=yaml><span class=k>apiVersion</span><span class=p>:</span><span class=w> </span>v1<span class=w>
</span><span class=w></span><span class=k>kind</span><span class=p>:</span><span class=w> </span>ConfigMap<span class=w>
</span><span class=w></span><span class=k>metadata</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=k>name</span><span class=p>:</span><span class=w> </span>extension-controlplane-monitoring-ccm<span class=w>
</span><span class=w>  </span><span class=k>namespace</span><span class=p>:</span><span class=w> </span>shoot--project--name<span class=w>
</span><span class=w>  </span><span class=k>labels</span><span class=p>:</span><span class=w>
</span><span class=w>    </span><span class=k>extensions.gardener.cloud/configuration</span><span class=p>:</span><span class=w> </span>monitoring<span class=w>
</span><span class=w></span><span class=k>data</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=k>scrape_config</span><span class=p>:</span><span class=w> </span><span class=sd>|
</span><span class=sd>    - job_name: cloud-controller-manager</span><span class=w>
</span><span class=w>      </span><span class=k>scheme</span><span class=p>:</span><span class=w> </span>https<span class=w>
</span><span class=w>      </span><span class=k>tls_config</span><span class=p>:</span><span class=w>
</span><span class=w>        </span><span class=k>insecure_skip_verify</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span><span class=w>        </span><span class=k>cert_file</span><span class=p>:</span><span class=w> </span>/etc/prometheus/seed/prometheus.crt<span class=w>
</span><span class=w>        </span><span class=k>key_file</span><span class=p>:</span><span class=w> </span>/etc/prometheus/seed/prometheus.key<span class=w>
</span><span class=w>      </span><span class=k>honor_labels</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=w>
</span><span class=w>      </span><span class=k>kubernetes_sd_configs</span><span class=p>:</span><span class=w>
</span><span class=w>      </span>- <span class=k>role</span><span class=p>:</span><span class=w> </span>endpoints<span class=w>
</span><span class=w>        </span><span class=k>namespaces</span><span class=p>:</span><span class=w>
</span><span class=w>          </span><span class=k>names</span><span class=p>:</span><span class=w> </span><span class=p>[</span>shoot--project--name<span class=p>]</span><span class=w>
</span><span class=w>      </span><span class=k>relabel_configs</span><span class=p>:</span><span class=w>
</span><span class=w>      </span>- <span class=k>source_labels</span><span class=p>:</span><span class=w>
</span><span class=w>        </span>- __meta_kubernetes_service_name<span class=w>
</span><span class=w>        </span>- __meta_kubernetes_endpoint_port_name<span class=w>
</span><span class=w>        </span><span class=k>action</span><span class=p>:</span><span class=w> </span>keep<span class=w>
</span><span class=w>        </span><span class=k>regex</span><span class=p>:</span><span class=w> </span>cloud-controller-manager;metrics<span class=w>
</span><span class=w>      </span><span class=c># common metrics</span><span class=w>
</span><span class=w>      </span>- <span class=k>action</span><span class=p>:</span><span class=w> </span>labelmap<span class=w>
</span><span class=w>        </span><span class=k>regex</span><span class=p>:</span><span class=w> </span>__meta_kubernetes_service_label_(.+)<span class=w>
</span><span class=w>      </span>- <span class=k>source_labels</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=w> </span>__meta_kubernetes_pod_name<span class=w> </span><span class=p>]</span><span class=w>
</span><span class=w>        </span><span class=k>target_label</span><span class=p>:</span><span class=w> </span>pod<span class=w>
</span><span class=w>      </span><span class=k>metric_relabel_configs</span><span class=p>:</span><span class=w>
</span><span class=w>      </span>- process_max_fds<span class=w>
</span><span class=w>      </span>- process_open_fds<span class=w>
</span><span class=w>
</span><span class=w>  </span><span class=k>alerting_rules</span><span class=p>:</span><span class=w> </span><span class=sd>|
</span><span class=sd>    cloud-controller-manager.rules.yaml: |</span><span class=w>
</span><span class=w>      </span><span class=k>groups</span><span class=p>:</span><span class=w>
</span><span class=w>      </span>- <span class=k>name</span><span class=p>:</span><span class=w> </span>cloud-controller-manager.rules<span class=w>
</span><span class=w>        </span><span class=k>rules</span><span class=p>:</span><span class=w>
</span><span class=w>        </span>- <span class=k>alert</span><span class=p>:</span><span class=w> </span>CloudControllerManagerDown<span class=w>
</span><span class=w>          </span><span class=k>expr</span><span class=p>:</span><span class=w> </span>absent(up{job=<span class=s2>&#34;cloud-controller-manager&#34;</span>}<span class=w> </span>==<span class=w> </span><span class=m>1</span>)<span class=w>
</span><span class=w>          </span><span class=k>for</span><span class=p>:</span><span class=w> </span>15m<span class=w>
</span><span class=w>          </span><span class=k>labels</span><span class=p>:</span><span class=w>
</span><span class=w>            </span><span class=k>service</span><span class=p>:</span><span class=w> </span>cloud-controller-manager<span class=w>
</span><span class=w>            </span><span class=k>severity</span><span class=p>:</span><span class=w> </span>critical<span class=w>
</span><span class=w>            </span><span class=k>type</span><span class=p>:</span><span class=w> </span>seed<span class=w>
</span><span class=w>            </span><span class=k>visibility</span><span class=p>:</span><span class=w> </span>all<span class=w>
</span><span class=w>          </span><span class=k>annotations</span><span class=p>:</span><span class=w>
</span><span class=w>            </span><span class=k>description</span><span class=p>:</span><span class=w> </span>All<span class=w> </span>infrastructure<span class=w> </span>specific<span class=w> </span>operations<span class=w> </span>cannot<span class=w> </span>be<span class=w> </span>completed<span class=w> </span>(e.g.<span class=w> </span>creating<span class=w> </span>load<span class=w> </span>balancers<span class=w> </span>or<span class=w> </span>persistent<span class=w> </span>volumes).<span class=w>
</span><span class=w>            </span><span class=k>summary</span><span class=p>:</span><span class=w> </span>Cloud<span class=w> </span>controller<span class=w> </span>manager<span class=w> </span>is<span class=w> </span>down.<span class=w>
</span><span class=w>
</span><span class=w>  </span><span class=k>dashboard_operators</span><span class=p>:</span><span class=w>
</span><span class=w>    </span>&lt;some-json-describing-a-grafana-dashboard-for-operators<span class=sd>&gt;
</span><span class=sd>
</span><span class=sd>  dashboard_users:</span><span class=w>
</span><span class=w>    </span>&lt;some-json-describing-a-grafana-dashboard-for-users&gt;<span class=w>
</span></code></pre></div><h2 id=logging>Logging</h2><p>In Kubernetes clusters, container logs are non-persistent and do not survive stopped and destroyed containers. Gardener addresses this problem for the components hosted in a seed cluster, by introducing its own managed logging solution. It is integrated with the Gardener monitoring stack to have all troubleshooting context in one place.</p><p><img src=../../../__resources/4a91c6bb-592b-429f-ac92-7d91eec3ef82.png alt="&ldquo;Cluster Logging Topology&rdquo;" title="Cluster Logging Topology"></p><p>Gardener logging consists of components in three roles - log collectors and forwarders, log persistency and exploration/consumption interfaces. All of them live in the seed clusters in multiple instances:</p><ul><li>Logs are persisted by Loki instances deployed as StatefulSets - one per shoot namespace, if the <code>Logging</code> feature gate is enabled and the <a href=https://github.com/gardener/gardener/blob/master/docs/usage/shoot_purposes.md#behavioral-differences>shoot purpose</a> is not <code>testing</code>, and one in the <code>garden</code> namespace. The shoot instances store logs from the control plane components hosted there. The <code>garden</code> Loki instance is responsible for logs from the rest of the seed namespaces - <code>kube-system</code>, <code>garden</code> <code>extension-*</code> and others.</li><li>Fluent-bit DaemonSets deployed on each seed node collect logs from it. A custom plugin takes care to distribute the collected log messages to the Loki instances that they are intended for. This allows to fetch the logs once for the whole cluster, and to distribute them afterwards.</li><li>Grafana is the UI component used to explore monitoring and log data together for easier troubleshooting and in context. Grafana instances are configured to use the coresponding Loki instances, sharing the same namespace, as data providers. There is one Grafana Deployment in the <code>garden</code> namespace and two Deployments per shoot namespace (one exposed to the end users and one for the operators).</li></ul><p>Logs can be produced from various sources, such as containers or systemd, and in different formats. The fluent-bit design supports configurable <a href=https://docs.fluentbit.io/manual/concepts/data-pipeline>data pipeline</a> to address that problem. Gardener provides such <a href=https://github.com/gardener/gardener/blob/master/charts/seed-bootstrap/charts/fluent-bit/templates/fluent-bit-configmap.yaml>configuration</a> for logs produced by all its core managed components as a <code>ConfigMap</code>. Extensions can contribute their own, specific configurations as <code>ConfigMap</code>s too. See for example the <a href=https://github.com/gardener/gardener-extension-provider-aws/blob/master/charts/gardener-extension-provider-aws/templates/configmap-logging.yaml>logging configuration</a> for the Gardener AWS provider extension. The Gardener reconciliation loop watches such resources and updates the fluent-bit agents dynamically.</p><h3 id=extensions-logging-integration>Extensions logging integration</h3><h4 id=fluent-bit-log-parsers-and-filters>Fluent-bit log parsers and filters</h4><p>To integrate with Gardener logging, extensions can and <em>should</em> specify how fluent-bit will handle the logs produced by the managed components that they contribute to Gardener. Normally, that would require to configure a <em>parser</em> for the specific logging format, if none of the available is applicable, and a <em>filter</em> defining how to apply it. For a complete reference for the configuration options, refer to fluent-bit&rsquo;s <a href=https://docs.fluentbit.io/manual/>documentation</a>.</p><p><strong>Note:</strong> At the moment only <em>parser</em> and <em>filter</em> configurations are supported.</p><p>To contribute its own configuration to the fluent-bit agents data pipelines, an extension must provide it as a <code>ConfigMap</code> labeled <code>extensions.gardener.cloud/configuration=logging</code> and deployed in the seed&rsquo;s <code>garden</code> namespace. Unlike the monitoring stack, where configurations are deployed per shoot, here a <em>single</em> configuration <code>ConfigMap</code> is sufficient and it applies to all fluent-bit agents in the seed. Its <code>data</code> field can have the following properties:</p><ul><li><code>filter-kubernetes.conf</code> - configuration for data pipeline <a href=https://docs.fluentbit.io/manual/concepts/data-pipeline/filter>filters</a></li><li><code>parser.conf</code> - configuration for data pipeline <a href=https://docs.fluentbit.io/manual/concepts/data-pipeline/parser>parsers</a></li></ul><p><strong>Note:</strong> Take care to provide the correct data pipeline elements in the coresponding data field and not to mix them.</p><p><strong>Example:</strong> Logging configuration for provider-specific (OpenStack) worker controller deploying a <code>machine-controller-manager</code> component into a shoot namespace that reuses the <code>kubeapiserverParser</code> defined in <a href=https://github.com/gardener/gardener/blob/master/charts/seed-bootstrap/charts/fluent-bit/templates/fluent-bit-configmap.yaml#L304-L309>fluent-bit-configmap.yaml</a> to parse the component logs</p><div class=highlight><pre class=chroma><code class=language-yaml data-lang=yaml><span class=k>apiVersion</span><span class=p>:</span><span class=w> </span>v1<span class=w>
</span><span class=w></span><span class=k>kind</span><span class=p>:</span><span class=w> </span>ConfigMap<span class=w>
</span><span class=w></span><span class=k>metadata</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=k>name</span><span class=p>:</span><span class=w> </span>gardener-extension-provider-openstack-logging-config<span class=w>
</span><span class=w>  </span><span class=k>namespace</span><span class=p>:</span><span class=w> </span>garden<span class=w>
</span><span class=w>  </span><span class=k>labels</span><span class=p>:</span><span class=w>
</span><span class=w>    </span><span class=k>extensions.gardener.cloud/configuration</span><span class=p>:</span><span class=w> </span>logging<span class=w>
</span><span class=w></span><span class=k>data</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=k>filter-kubernetes.conf</span><span class=p>:</span><span class=w> </span><span class=sd>|
</span><span class=sd>    [FILTER]</span><span class=w>
</span><span class=w>        </span>Name<span class=w>                </span>parser<span class=w>
</span><span class=w>        </span>Match<span class=w>               </span>kubernetes.machine-controller-manager<span class=cp>*openstack-machine-controller-manager*</span><span class=w>
</span><span class=w>        </span>Key_Name<span class=w>            </span>log<span class=w>
</span><span class=w>        </span>Parser<span class=w>              </span>kubeapiserverParser<span class=w>
</span><span class=w>        </span>Reserve_Data<span class=w>        </span>True<span class=w>
</span></code></pre></div><p>Further details how to define parsers and use them with examples can be found in the following <a href=https://github.com/gardener/gardener/blob/master/docs/development/log_parsers.md>guide</a>.</p><h4 id=grafana>Grafana</h4><p>The three types of Grafana instances found in a seed cluster are configured to expose logs of different origin in their dashboards:</p><ul><li>Garden Grafana dashboards expose logs from non-shoot namespaces of the seed clusters</li><li><a href=https://github.com/gardener/gardener/blob/master/charts/seed-bootstrap/dashboards/pod-logs.json>Pod Logs</a></li><li><a href=https://github.com/gardener/gardener/blob/master/charts/seed-bootstrap/dashboards/extensions-dashboard.json>Extensions</a></li><li><a href=https://github.com/gardener/gardener/blob/master/charts/seed-bootstrap/dashboards/systemd-logs.json>Systemd Logs</a></li><li>Shoot User Grafana dashboards expose a subset of the logs shown to operators</li><li>Kube Apiserver</li><li>Kube Controller Manager</li><li>Kube Scheduler</li><li>Cluster Autoscaler</li><li>Shoot Operator Grafana dashboards expose logs from the shoot cluster namespace where they belong</li><li>All user&rsquo;s dashboards</li><li><a href=https://github.com/gardener/gardener/blob/master/charts/seed-monitoring/charts/grafana/dashboards/operators/kubernetes-pods-dashboard.json>Kubernetes Pods</a></li></ul><p>If the type of logs exposed in the Grafana instances needs to be changed, it is necessary to update the coresponding instance dashboard configurations.</p><h2 id=tips>Tips</h2><ul><li><p>Be careful to match exactly the log names that you need for a particular parser in your filters configuration. The regular expression you will supply will match names in the form <code>kubernetes.pod_name.&lt;metadata>.container_name</code>. If there are extensions with the same container and pod names, they will all match the same parser in a filter. That may be a desired effect, if they all share the same log format. But it will be a problem if they don&rsquo;t. To solve it, either the pod or container names must be unique, and the regular expression in the filter has to match that unique pattern. A recommended approach is to prefix containers with the extension name and tune the regular expression to match it. For example, using <code>myextension-container</code> as container name, and a regular expression <code>kubernetes.mypod.*myextension-container</code> will guarantee match of the right log name. Make sure that the regular expression does not match more than you expect. For example, <code>kubernetes.systemd.*systemd.*</code> will match both <code>systemd-service</code> and <code>systemd-monitor-service</code>. You will want to be as specific as possible.</p></li><li><p>It&rsquo;s a good idea to put the logging configuration into the Helm chart that also deploys the extension <em>controller</em>, while the monitoring configuration can be part of the Helm chart/deployment routine that deploys the <em>component</em> managed by the controller.</p></li></ul><h2 id=references-and-additional-resources>References and additional resources</h2><ul><li><p><a href=https://github.com/gardener/gardener/issues/1351>GitHub issue describing the concept</a></p></li><li><p><a href=https://github.com/gardener/gardener-extension-provider-gcp/blob/master/charts/internal/seed-controlplane/charts/cloud-controller-manager/templates/configmap-monitoring.yaml>Exemplary implementation (monitoring) for the GCP provider</a></p></li><li><p><a href=https://github.com/gardener/gardener-extension-provider-openstack/blob/master/charts/gardener-extension-provider-openstack/templates/configmap-logging.yaml>Exemplary implementation (logging) for the OpenStack provider</a></p></li></ul></div></div></div><div class=howto_tickets><a href=https://github.com/gardener/gardener/issues/new/choose target=_blank><span>Let us know how can we improve.</span>
<span>Open <img src=https://gardener.cloud/images/branding/github-mark-logo-green.svg> GitHub Issue <i class="fa fa-external-link" aria-hidden=true></i></span></a></div></section></div><style></style><footer class=footer><div class="container footer-wrapper"><ul class=nav><li><a href=/blog/>Blogs</a></li><li><a href=/news/>News</a></li><li><a href=/community/>Community</a></li><li><a href=/adopter/>Adopters</a></li><li><a href=/documentation/home>Documentation</a></li></ul><img src=/images/lp/gardener-logo.svg alt="Logo Gardener" class=logo><ul class=media-wr><li><a target=_blank href=https://kubernetes.slack.com/archives/CB57N0BFG><img src=/images/branding/slack-logo-white.svg class=media-icon><div class=media-text>Slack</div></a></li><li><a target=_blank href=https://github.com/gardener><img src=/images/branding/github-mark-logo.png class=media-icon><div class=media-text>GitHub</div></a></li><li><a target=_blank href=https://www.youtube.com/channel/UCwUhwKFREV8Su0gwAJQX7tw><img src=/images/branding/youtube-logo-dark.svg class=media-icon><div class=media-text>YouTube</div></a></li><li><a target=_blank href=https://twitter.com/GardenerProject><img src=/images/branding/twitter-logo-white.svg class=media-icon><div class=media-text>Twitter</div></a></li></ul><span class=copyright>Copyright 2020 Gardener project authors. Privacy Statement</span></div></footer><script src=/js/perfect-scrollbar.min.js?1604308781></script><script src=/js/perfect-scrollbar.jquery.min.js?1604308781></script><script src=/js/jquery.sticky.js?1604308781></script><script src=/js/featherlight.min.js?1604308781></script><script src=/js/html5shiv-printshiv.min.js?1604308781></script><script src=/js/modernizr.custom.71422.js?1604308781></script><link href=/mermaid/mermaid.css?1604308781 type=text/css rel=stylesheet><script src=/mermaid/mermaid.js?1604308781></script><script src=/js/code-snippets.js?1604308781></script><script>mermaid.initialize({startOnLoad:true,htmlLables:true});function createIssue(issueUrl,page,url){var uri=issueUrl+"?title=Documentation issue on page \""+page+"\"";uri=uri+"&body=\n\n<- DESCRIBE MISSING OR FAULTY DOCUMENTATION HERE->\n\n---\nPage: ["+page+"]("+
url+")\ndon't remove the link to the page. It's required for the processor"
var res=encodeURI(uri);res+="&labels=area/documentation"
window.open(res,"issue")
return false;}
$(document).ready(function(){inlineSVG.init();$("[data-publishdate]").each(function(){$(this).text(moment($(this,"YYYY-MM-DD","YYYY-MM-DD hh:mm:ss").attr("data-publishdate")).fromNow());});new ClipboardJS('.clipboard-copy');$("body").codeSnippets();});</script><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-W2FGNSX" height=0 width=0 style=display:none;visibility:hidden></iframe></noscript></body></html>