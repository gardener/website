<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Gardener â€“ Usage</title><link>https://gardener.cloud/docs/extensions/others/gardener-extension-shoot-networking-filter/usage/</link><description>Recent content in Usage on Gardener</description><generator>Hugo -- gohugo.io</generator><language>en-US</language><atom:link href="https://gardener.cloud/docs/extensions/others/gardener-extension-shoot-networking-filter/usage/index.xml" rel="self" type="application/rss+xml"/><item><title>Docs: Shoot Networking Filter</title><link>https://gardener.cloud/docs/extensions/others/gardener-extension-shoot-networking-filter/usage/shoot-networking-filter/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://gardener.cloud/docs/extensions/others/gardener-extension-shoot-networking-filter/usage/shoot-networking-filter/</guid><description>
&lt;h1 id="register-shoot-networking-filter-extension-in-shoot-clusters">Register Shoot Networking Filter Extension in Shoot Clusters&lt;/h1>
&lt;h2 id="introduction">Introduction&lt;/h2>
&lt;p>Within a shoot cluster, it is possible to enable the networking filter. It is necessary that the Gardener installation your shoot cluster runs in is equipped with a &lt;code>shoot-networking-filter&lt;/code> extension. Please ask your Gardener operator if the extension is available in your environment.&lt;/p>
&lt;h2 id="shoot-feature-gate">Shoot Feature Gate&lt;/h2>
&lt;p>In most of the Gardener setups the &lt;code>shoot-networking-filter&lt;/code> extension is not enabled globally and thus must be configured per shoot cluster. Please adapt the shoot specification by the configuration shown below to activate the extension individually.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="display:flex;">&lt;span>kind: Shoot
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>...
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>spec:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> extensions:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - type: shoot-networking-filter
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>...
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="opt-out">Opt-out&lt;/h2>
&lt;p>If the shoot networking filter is globally enabled by default, it can be disabled per shoot. To disable the service for a shoot, the shoot manifest must explicitly state it.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="display:flex;">&lt;span>apiVersion: core.gardener.cloud/v1beta1
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>kind: Shoot
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>...
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>spec:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> extensions:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - type: shoot-networking-filter
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> disabled: &lt;span style="color:#00f">true&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>...
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="ingress-filtering">Ingress Filtering&lt;/h2>
&lt;p>By default, the networking filter only filters egress traffic. However, if you enable blackholing, incoming traffic will also be blocked.
You can enable blackholing on a per-shoot basis.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="display:flex;">&lt;span>apiVersion: core.gardener.cloud/v1beta1
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>kind: Shoot
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>...
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>spec:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> extensions:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - type: shoot-networking-filter
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> providerConfig:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> egressFilter:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> blackholingEnabled: &lt;span style="color:#00f">true&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>...
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Ingress traffic can only be blocked by blackhole routing, if the source IP address is preserved. On Azure, GCP and AliCloud this works by default.
The default on AWS is a classic load balancer that replaces the source IP by it&amp;rsquo;s own IP address. Here, a network load balancer has to be
configured adding the annotation &lt;code>service.beta.kubernetes.io/aws-load-balancer-type: &amp;quot;nlb&amp;quot;&lt;/code> to the service.
On OpenStack, load balancers don&amp;rsquo;t preserve the source address.&lt;/p>
&lt;p>Please note that if you disable &lt;code>blackholing&lt;/code> in an existing shoot, the associated blackhole routes will not be removed automatically.
To remove these routes, you can either replace the affected nodes or delete the routes manually.&lt;/p>
&lt;h2 id="custom-ip">Custom IP&lt;/h2>
&lt;p>It is possible to add custom IP addresses to the network filter. This can be useful for testing purposes.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="display:flex;">&lt;span>apiVersion: core.gardener.cloud/v1beta1
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>kind: Shoot
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>...
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>spec:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> extensions:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - type: shoot-networking-filter
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> providerConfig:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> egressFilter:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> staticFilterList:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - network: 1.2.3.4/31
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> policy: BLOCK_ACCESS
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - network: 5.6.7.8/32
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> policy: BLOCK_ACCESS
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - network: ::2/128
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> policy: BLOCK_ACCESS
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>...
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item></channel></rss>