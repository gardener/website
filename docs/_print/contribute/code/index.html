<!doctype html><html lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.83.1"><link rel=canonical type=text/html href=https://gardener.cloud/contribute/code/><link rel=alternate type=application/rss+xml href=https://gardener.cloud/contribute/code/index.xml><meta name=ROBOTS content="NOINDEX, NOFOLLOW"><link rel=icon type=image/x-icon href=https://gardener.cloud/images/favicon.ico><link rel=icon type=image/png href=https://gardener.cloud/images/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=https://gardener.cloud/images/favicon-16x16.png sizes=16x16><title>Code | Gardener</title><meta name=description content="Project Gardener Website - A Managed Kubernetes Service Done Right"><meta property="og:title" content="Code"><meta property="og:description" content="Project Gardener Website - A Managed Kubernetes Service Done Right"><meta property="og:type" content="website"><meta property="og:url" content="https://gardener.cloud/contribute/code/"><meta itemprop=name content="Code"><meta itemprop=description content="Project Gardener Website - A Managed Kubernetes Service Done Right"><meta name=twitter:card content="summary"><meta name=twitter:title content="Code"><meta name=twitter:description content="Project Gardener Website - A Managed Kubernetes Service Done Right"><link rel=preload href=/scss/main.min.122f9effc36493edf1f25030c2ce7965b16b3b0eaeb02528b9a50e0fa9110c15.css as=style><link href=/scss/main.min.122f9effc36493edf1f25030c2ce7965b16b3b0eaeb02528b9a50e0fa9110c15.css rel=stylesheet integrity><script src=https://code.jquery.com/jquery-3.5.1.min.js integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin=anonymous></script><script src=https://unpkg.com/lunr@2.3.8/lunr.min.js integrity=sha384-vRQ9bDyE0Wnu+lMfm57BlYLO0/XauFuKpVsZPs7KEDwYKktWi5+Kz3MP8++DFlRY crossorigin=anonymous></script></head><body class=td-section><header><nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar"><a class=navbar-brand href=/><span class=navbar-logo><svg width="90" height="90" viewBox="0 0 90 90" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>logo</title><desc>Created with Sketch.</desc><defs><path d="M41.8864954.994901575c.996545099999999-.479910833 2.6164002-.477918931 3.6088091.0L76.8159138 16.0781121C77.8124589 16.5580229 78.8208647 17.8257185 79.0659694 18.8995926l7.7355517 33.8916663C87.0476474 53.8696088 86.6852538 55.4484075 85.9984855 56.3095876L64.3239514 83.4885938C63.6343208 84.3533632 62.1740175 85.0543973 61.0725268 85.0543973H26.3092731c-1.1060816.0-2.5646564-.704623400000003-3.2514246-1.5658035L1.38331434 56.3095876C.693683723 55.4448182.335174016 53.865133.580278769 52.7912589L8.31583044 18.8995926C8.56195675 17.8212428 9.57347722 16.556031 10.5658861 16.0781121L41.8864954.994901575z" id="path-1"/><linearGradient x1="12.7542673%" y1="-18.6617048%" x2="88.2666158%" y2="84.6075483%" id="linearGradient-3"><stop stop-color="#fff" offset="0"/><stop stop-color="#439246" offset="100%"/></linearGradient><linearGradient x1="50%" y1="4.93673768%" x2="148.756007%" y2="175.514523%" id="linearGradient-4"><stop stop-color="#fff" offset="0"/><stop stop-color="#439246" offset="100%"/></linearGradient><linearGradient x1="19.1574381%" y1="-9.04800713%" x2="82.2203149%" y2="77.9084293%" id="linearGradient-5"><stop stop-color="#fff" offset="0"/><stop stop-color="#439246" offset="100%"/></linearGradient><linearGradient x1="57.4403751%" y1="26.3148481%" x2="137.966711%" y2="158.080556%" id="linearGradient-6"><stop stop-color="#fff" offset="0"/><stop stop-color="#439246" offset="100%"/></linearGradient></defs><g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="logo"><g id="Rectangle-2" transform="translate(1.000000, 0.000000)"><mask id="mask-2" fill="#fff"><use xlink:href="#path-1"/></mask><use id="Mask" fill="#009f76" xlink:href="#path-1"/><polygon fill="#000" opacity=".289628623" mask="url(#mask-2)" points="-17.6484375 54.5224609 30.8242188 25.0791016 63.4726562 58.5 24.7324219 92.6689453"/></g><path d="M56.8508631 39.260019C56.4193519 40.443987 55.6088085 41.581593 54.6736295 42.1938694l-8.0738997 5.2861089c-1.3854671.907087099999998-3.6247515.9116711-5.0172201.0L33.50861 42.1938694C32.123143 41.2867823 31 39.206345 31 37.545932V26.4150304c0-.725313.2131118-1.5301454.569268099999999-2.2825772L56.8508631 39.260019z" id="Combined-Shape" fill="url(#linearGradient-3)" transform="translate(43.925432, 36.147233) scale(-1, 1) translate(-43.925432, -36.147233)"/><path d="M56.0774672 25.1412464C56.4306829 25.8903325 56.6425556 26.6907345 56.6425556 27.4119019V38.5428034c0 1.6598979-1.1161415 3.73626640000001-2.50861 4.6479374l-8.0738997 5.286109c-1.3854671.907087000000004-3.6247516.911671000000005-5.0172201.0L32.9689261 43.1907408C32.2918101 42.7474223 31.6773514 42.0238435 31.2260376 41.206007L56.0774672 25.1412464z" id="Combined-Shape" fill="url(#linearGradient-4)" transform="translate(43.821278, 37.246598) scale(-1, 1) translate(-43.821278, -37.246598)"/><path d="M65.0702134 57.1846889C64.5985426 58.2007851 63.8367404 59.1236871 62.9788591 59.6189851L47.37497 68.6278947c-1.4306165.825966800000003-3.75236779999999.8246599-5.1807206.0L26.5903603 59.6189851C25.1597438 58.7930183 24 56.7816693 24 55.1323495V37.1145303C24 36.3487436 24.249712 35.5060005 24.6599102 34.7400631L65.0702134 57.1846889z" id="Combined-Shape" fill="url(#linearGradient-5)"/><path d="M65.0189476 34.954538C65.3636909 35.6617313 65.5692194 36.42021 65.5692194 37.1145303V55.1323495C65.5692194 56.7842831 64.4072119 58.7943252 62.9788591 59.6189851L47.37497 68.6278947c-1.4306165.825966800000003-3.75236779999999.8246599-5.1807206.0L26.5903603 59.6189851C25.9237304 59.2341061 25.3159155 58.5918431 24.8568495 57.8487596L65.0189476 34.954538z" id="Combined-Shape" fill="url(#linearGradient-6)"/></g></g></svg></span><span class=text-capitalize>Gardener</span></a><div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar><ul class="navbar-nav mt-2 mt-lg-0"><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/adopter><span>Adopters</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/blog><span>Blogs</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/community><span>Community</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/docs><span>Documentation</span></a></li></ul></div><div class="navbar-nav d-none d-lg-block"><input type=search class="form-control td-search-input" placeholder="&#xf002; Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=/offline-search-index.c5d35d3c5f53aef49052eda889e3e35a.json data-offline-search-base-href=/ data-offline-search-max-results=10></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><div class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"></div><div class="d-none d-xl-block col-xl-2 td-toc d-print-none"></div><main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main><div class=td-content><div class="pageinfo pageinfo-primary d-print-none"><p>This the multi-page printable view of this section.
<a href=# onclick="return print(),!1">Click here to print</a>.</p><p><a href=/contribute/code/>Return to the regular view of this page</a>.</p></div><h1 class=title>Code</h1><div class=content><p>You are welcome to <strong>contribute code</strong> to Gardener in order to fix a bug or to implement a new feature.</p><p>The following rules govern code contributions:</p><ul><li>Contributions must be licensed under the <a href=http://www.apache.org/licenses/LICENSE-2.0>Apache 2.0 License</a></li><li>You need to sign the Contributor License Agreement. We are using <em><a href=https://cla-assistant.io/>CLA assistant</a></em> providing a click-through workflow for accepting the CLA. For company contributors additionally the company needs to sign a corporate license agreement. See the following sections for details.</li></ul></div></div><div class=td-content style=page-break-before:always><h1 id=pg-2525203726f294062263705771e54f3f>1 - CI/CD</h1><h1 id=cicd>CI/CD</h1><p>As an execution environment for CI/CD workloads, we use <a href=https://concourse-ci.org>Concourse</a>.
We however abstract from the underlying &ldquo;build executor&rdquo; and instead offer a
<code>Pipeline Definition Contract</code>, through which components declare their build pipelines as
required.</p><p><img src=/__resources/overview_63fb18.png alt=Overview></p><p>In order to run continuous delivery workloads for all components contributing to the
<a href=https://github.com/gardener>Gardener</a> project, we operate a central service.</p><p>Typical workloads encompass the execution of tests and builds of a variety of technologies,
as well as building and publishing container images, typically containing build results.</p><p>We are building our CI/CD offering around some principles:</p><ul><li><em>container-native</em> - each workload is executed within a container environment. Components may customise used container images</li><li><em>automation</em> - pipelines are generated without manual interaction</li><li><em>self-service</em> - components customise their pipelines by changing their sources</li><li><em>standardisation</em></li></ul><p><strong>Learn more on our: <a href=https://gardener.github.io/cc-utils/>Build Pipeline Reference Manual</a></strong></p></div><div class=td-content style=page-break-before:always><h1 id=pg-82bb154ddb490dade2d3681b3c82db85>2 - Configuration and Usage</h1><h1 id=gardener-configuration-and-usage>Gardener Configuration and Usage</h1><p>Gardener automates the full lifecycle of Kubernetes clusters as a service.
Additionally, it has several extension points allowing external controllers to plug-in to the lifecycle.
As a consequence, there are several configuration options for the various custom resources that are partially required.</p><p>This document describes the</p><ol><li><a href=#configuration-and-usage-of-gardener-as-operatoradministrator>configuration and usage of Gardener as operator/administrator</a>.</li><li><a href=#configuration-and-usage-of-gardener-as-end-userstakeholdercustomer>configuration and usage of Gardener as end-user/stakeholder/customer</a>.</li></ol><h2 id=configuration-and-usage-of-gardener-as-operatoradministrator>Configuration and Usage of Gardener as Operator/Administrator</h2><p>When we use the terms &ldquo;operator/administrator&rdquo; we refer to both the people deploying and operating Gardener.
Gardener consists out of four components:</p><ol><li><code>gardener-apiserver</code>, a Kubernetes-native API extension that serves custom resources in the Kubernetes-style (like <code>Seed</code>s and <code>Shoot</code>s), and a component that contains multiple admission plugins.</li><li><code>gardener-controller-manager</code>, a component consisting out of multiple controllers that implement reconciliation and deletion flows for some of the custom resources (e.g., it contains the logic for maintaining <code>Shoot</code>s, reconciling <code>Plant</code>s, etc.).</li><li><code>gardener-scheduler</code>, a component that assigns newly created <code>Shoot</code> clusters to appropriate <code>Seed</code> clusters.</li><li><code>gardenlet</code>, a component running in seed clusters and consisting out of multiple controllers that implement reconciliation and deletion flows for some of the custom resources (e.g., it contains the logic for reconciliation and deletion of <code>Shoot</code>s).</li></ol><p>Each of these components have various configuration options.
The <code>gardener-apiserver</code> uses the standard API server library maintained by the Kubernetes community, and as such it mainly supports command line flags.
The two other components are using so-called componentconfig files that describe their configuration in a Kubernetes-style versioned object.</p><h3 id=configuration-file-for-gardener-controller-manager>Configuration file for Gardener controller manager</h3><p>The Gardener controller manager does only support one command line flag which should be a path to a valid controller-manager configuration file.
Please take a look at <a href=https://raw.githubusercontent.com/gardener/gardener/master/docs/usage/../../example/20-componentconfig-gardener-controller-manager.yaml>this</a> example configuration.</p><h3 id=configuration-file-for-gardener-scheduler>Configuration file for Gardener scheduler</h3><p>The Gardener scheduler also only supports one command line flag which should be a path to a valid scheduler configuration file.
Please take a look at <a href=https://raw.githubusercontent.com/gardener/gardener/master/docs/usage/../../example/20-componentconfig-gardener-scheduler.yaml>this</a> example configuration.
Information about the concepts of the Gardener scheduler can be found <a href=https://raw.githubusercontent.com/gardener/gardener/master/docs/usage/../concepts/scheduler.md>here</a></p><h3 id=configuration-file-for-gardenlet>Configuration file for Gardenlet</h3><p>The Gardenlet also only supports one command line flag which should be a path to a valid gardenlet configuration file.
Please take a look at <a href=https://raw.githubusercontent.com/gardener/gardener/master/docs/usage/../../example/20-componentconfig-gardenlet.yaml>this</a> example configuration.
Information about the concepts of the Gardenlet can be found <a href=https://raw.githubusercontent.com/gardener/gardener/master/docs/usage/../concepts/gardenlet.md>here</a></p><h3 id=system-configuration>System configuration</h3><p>After successful deployment of the four components you need to setup the system.
Let&rsquo;s first focus on some &ldquo;static&rdquo; configuration.
When the <code>gardenlet</code> starts it scans the <code>garden</code> namespace of the garden cluster for <code>Secret</code>s that have influence on its reconciliation loops, mainly the <code>Shoot</code> reconciliation:</p><ul><li><p><strong>Internal domain secret</strong>, contains the DNS provider credentials (having appropriate privileges) which will be used to create/delete so-called &ldquo;internal&rdquo; DNS records for the Shoot clusters, please see <a href=https://raw.githubusercontent.com/gardener/gardener/master/docs/usage/../../example/10-secret-internal-domain.yaml>this</a> for an example.</p><ul><li>This secret is used in order to establish a stable endpoint for shoot clusters which is used internally by all control plane components.</li><li>The DNS records are normal DNS records but called &ldquo;internal&rdquo; in our scenario because only the kubeconfigs for the control plane components use this endpoint when talking to the shoot clusters.</li><li>It is forbidden to change the internal domain secret if there are existing shoot clusters.</li></ul></li><li><p><strong>Default domain secrets</strong> (optional), contain the DNS provider credentials (having appropriate privileges) which will be used to create/delete DNS records for a default domain for shoots (e.g., <code>example.com</code>), please see <a href=https://raw.githubusercontent.com/gardener/gardener/master/docs/usage/../../example/10-secret-default-domain.yaml>this</a> for an example.</p><ul><li>Not every end-user/stakeholder/customer has its own domain, however, Gardener needs to create a DNS record for every shoot cluster.</li><li>As landscape operator you might want to define a default domain owned and controlled by you that is used for all shoot clusters that don&rsquo;t specify their own domain.</li></ul></li></ul><p>:warning: Please note that the mentioned domain secrets are only needed if you have at least one seed cluster that is not tainted with <code>seed.gardener.cloud/disable-dns</code>.
Seeds with this taint don&rsquo;t create any DNS records for shoots scheduled on it, hence, if you only have such seeds, you don&rsquo;t need to create the domain secrets.</p><ul><li><p><strong>Alerting secrets</strong> (optional), contain the alerting configuration and credentials for the <a href=https://prometheus.io/docs/alerting/alertmanager/>AlertManager</a> to send email alerts. It is also possible to configure the monitoring stack to send alerts to an AlertManager not deployed by Gardener to handle alerting. Please see <a href=https://raw.githubusercontent.com/gardener/gardener/master/docs/usage/../../example/10-secret-alerting.yaml>this</a> for an example.</p><ul><li>If email alerting is configured:<ul><li>An AlertManager is deployed into each seed cluster that handles the alerting for all shoots on the seed cluster.</li><li>Gardener will inject the SMTP credentials into the configuration of the AlertManager.</li><li>The AlertManager will send emails to the configured email address in case any alerts are firing.</li></ul></li><li>If an external AlertManager is configured:<ul><li>Each shoot has a <a href=https://prometheus.io/docs/introduction/overview/>Prometheus</a> responsible for monitoring components and sending out alerts. The alerts will be sent to a URL configured in the alerting secret.</li><li>This external AlertManager is not managed by Gardener and can be configured however the operator sees fit.</li><li>Supported authentication types are no authentication, basic, or mutual TLS.</li></ul></li></ul></li><li><p><strong>OpenVPN Diffie-Hellmann Key secret</strong> (optional), contains the self-generated Diffie-Hellmann key used by OpenVPN in your landscape, please see <a href=https://raw.githubusercontent.com/gardener/gardener/master/docs/usage/../../example/10-secret-openvpn-diffie-hellman.yaml>this</a> for an example.</p><ul><li>If you don&rsquo;t specify a custom key then a default key is used, but for productive landscapes it&rsquo;s recommend to create a landscape-specific key and define it.</li></ul></li><li><p><strong>Global monitoring secrets</strong> (optional), contains basic authentication credentials for the Prometheus aggregating metrics for all clusters.</p><ul><li>These secrets are synced to each seed cluster and used to gain access to the aggregate monitoring components.</li></ul></li></ul><p>Apart from this &ldquo;static&rdquo; configuration there are several custom resources extending the Kubernetes API and used by Gardener.
As an operator/administrator you have to configure some of them to make the system work.</p><h3 id=configuration-and-usage-of-gardener-as-end-userstakeholdercustomer>Configuration and Usage of Gardener as End-User/Stakeholder/Customer</h3><p>As an end-user/stakeholder/customer you are using a Gardener landscape that has been setup for you by another team.
You don&rsquo;t need to care about how Gardener itself has to be configured or how it has to be deployed.
Take a look at <a href=https://raw.githubusercontent.com/gardener/gardener/master/docs/usage/../concepts/apiserver.md>this document</a> - it describes which resources are offered by Gardener.
You may want to have a more detailed look for <code>Project</code>s, <code>SecretBinding</code>s, <code>Shoot</code>s, <code>Plant</code>s, and <code>(Cluster)OpenIDConnectPreset</code>s.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-279d8411d77850358749a0c9f0e65b7c>3 - Contribution Guide</h1><h1 id=contributing-to-gardener>Contributing to Gardener</h1><h2 id=code-of-conduct>Code of conduct</h2><p>All members of the Gardener community must abide by the
<a href=https://github.com/cncf/foundation/blob/master/code-of-conduct.md>CNCF Code of Conduct</a>.
Only by respecting each other can we develop a productive, collaborative community.
Instances of abusive, harassing, or otherwise unacceptable behavior may be reported by contacting <a href=mailto:gardener.opensource@sap.com>gardener.opensource@sap.com</a> and/or a Gardener project maintainer.</p><h2 id=contributing>Contributing</h2><p>Gardener uses GitHub to manage reviews of pull requests.</p><ul><li><p>If you are a new contributor see: <a href=#steps-to-contribute>Steps to Contribute</a></p></li><li><p>If you have a trivial fix or improvement, go ahead and create a pull request,
addressing (with <code>@...</code>) a suitable maintainer of this repository (see
<a href=https://github.com/gardener/gardener/blob/master/CODEOWNERS>CODEOWNERS</a> of the
repository you want to contribute to) in the description of the pull request.</p></li><li><p>If you plan to do something more involved, first discuss your ideas
on our <a href=https://groups.google.com/forum/?fromgroups#!forum/gardener>mailing list</a>.
This will avoid unnecessary work and surely give you and us a good deal
of inspiration.</p></li><li><p>Relevant coding style guidelines are the <a href=https://github.com/golang/go/wiki/CodeReviewComments>Go Code Review
Comments</a>
and the <em>Formatting and style</em> section of Peter Bourgon&rsquo;s <a href=http://peter.bourgon.org/go-in-production/#formatting-and-style>Go: Best
Practices for Production
Environments</a>.</p></li></ul><h2 id=steps-to-contribute>Steps to Contribute</h2><p>Should you wish to work on an issue, please claim it first by commenting on the GitHub issue that you want to work on it. This is to prevent duplicated efforts from contributors on the same issue.</p><p>If you have questions about one of the issues, with or without the tag, please comment on them and one of the maintainers will clarify it.</p><p>We kindly ask you to follow the <a href=#Pull-Request-Checklist>Pull Request Checklist</a> to ensure reviews can happen accordingly.</p><h2 id=contributing-code>Contributing Code</h2><p>You are welcome to contribute code to Gardener in order to fix a bug or to implement a new feature.</p><p>The following rules govern code contributions:</p><ul><li>Contributions must be licensed under the <a href=http://www.apache.org/licenses/LICENSE-2.0>Apache 2.0 License</a></li><li>You need to sign the <a href=#developer-certificate-of-origin>Developer Certificate of Origin</a>.</li></ul><h2 id=contributing-documentation>Contributing Documentation</h2><p>You are welcome to contribute documentation to Gardener.</p><p>The following rules govern documentation contributions:</p><ul><li>Contributions must be licensed under the <a href=https://creativecommons.org/licenses/by/4.0/legalcode>Creative Commons Attribution 4.0 International License</a></li><li>You need to sign the <a href=#developer-certificate-of-origin>Developer Certificate of Origin</a>.</li></ul><h2 id=developer-certificate-of-origin>Developer Certificate of Origin</h2><p>Due to legal reasons, contributors will be asked to accept a Developer Certificate of Origin (DCO) before they submit the first pull request to this projects, this happens in an automated fashion during the submission process. We use <a href=https://developercertificate.org/>the standard DCO text of the Linux Foundation</a>.</p><h2 id=pull-request-checklist>Pull Request Checklist</h2><ul><li><p>Branch from the master branch and, if needed, rebase to the current master branch before submitting your pull request. If it doesn&rsquo;t merge cleanly with master you may be asked to rebase your changes.</p></li><li><p>Commits should be as small as possible, while ensuring that each commit is correct independently (i.e., each commit should compile and pass tests).</p></li><li><p>Test your changes as thoroughly as possible before your commit them. Preferably, automate your test by unit / integration (e.g. <a href=/docs/gardener/testing/integration_tests>Gardener integration testing</a>) tests. If tested manually, provide information about the test scope in the PR description (e.g. “Test passed: Upgrade K8s version from 1.14.5 to 1.15.2 on AWS, Azure, GCP, Alicloud, Openstack.”).</p></li><li><p>Create <em>Work In Progress [WIP]</em> pull requests only if you need a clarification or an explicit review before you can continue your work item.</p></li><li><p>If your patch is not getting reviewed or you need a specific person to review it, you can @-reply a reviewer asking for a review in the pull request or a comment, or you can ask for a review on our <a href=https://groups.google.com/forum/?fromgroups#!forum/gardener>mailing list</a>.</p></li><li><p>Post review:</p><ul><li>If a review requires you to change your commit(s), please test the changes again.</li><li>Amend the affected commit(s) and force push onto your branch.</li><li>Set respective comments in your GitHub review to resolved.</li><li>Create a general PR comment to notify the reviewers that your amendments are ready for another round of review.</li></ul></li></ul><h2 id=issues-and-planning>Issues and Planning</h2><p>We use GitHub issues to track bugs and enhancement requests. Please provide as much context as possible when you open an issue. The information you provide must be comprehensive enough to reproduce that issue for the assignee. Therefore, contributors may use but aren&rsquo;t restricted to the issue template provided by the Gardener maintainers.</p><p>ZenHub is used for planning:</p><ul><li>Install the <a href=https://chrome.google.com/webstore/detail/zenhub-for-github/ogcgkffhplmphkaahpmffcafajaocjbd>ZenHub Chrome plugin</a></li><li>Login to <a href=https://www.zenhub.com/>ZenHub</a></li><li>Open the <a href=https://app.zenhub.com/workspace/o/gardener/gardener>Gardener ZenHub workspace</a></li></ul><h2 id=security-release-process>Security Release Process</h2><p>See <a href=/docs/contribute/10_code/12-security_guide>Security Release Process</a></p><h2 id=community>Community</h2><h3 id=slack-channel>Slack Channel</h3><p><a href=https://kubernetes.slack.com/messages/gardener>#gardener</a>, sign up <a href=http://slack.k8s.io/>here</a></p><h3 id=mailing-list>Mailing List</h3><p><a href=https://groups.google.com/forum/?fromgroups#!forum/gardener>gardener@googlegroups.com</a></p><p>The mailing list is hosted through Google Groups. To receive the lists' emails, <a href=https://support.google.com/groups/answer/1067205>join</a> the group, as you would any other Google Group.</p><h3 id=twitter>Twitter</h3><p>Follow <a href=https://twitter.com/GardenerProject>@GardenerProject</a> on Twitter. Please mention @GardenerProject
in your own posts about Gardener.</p><h3 id=accessing-community-documents>Accessing community documents</h3><p>In order to foster real time collaboration there are working documents and notes that are taken in Google Docs,
and then transferred to this repository if appropriate.</p><p>To gain edit access for these documents, you must subscribe to the
<a href=https://groups.google.com/forum/?fromgroups#!forum/gardener>gardener mailing list</a>,
as these documents are shared automatically with anyone who subscribes to that list.</p><h3 id=weekly-meeting>Weekly Meeting</h3><p>We have a PUBLIC and RECORDED bi-weekly meeting. We meet every other Thursday at <a href="https://www.google.de/search?q=10+CET+to+local+time">10:00 CET</a> over Zoom. Find recordings in the <a href=https://www.youtube.com/channel/UCwUhwKFREV8Su0gwAJQX7tw/videos>Gardener Youtube channel</a>. Let us know if you want to participate and live in a timezone which isn&rsquo;t compatible with 10:00 CET.</p><p>See the meeting calendar on the web at <a href="https://calendar.google.com/calendar/embed?src=gardener.cloud.community%40gmail.com">calendar.google.com</a>, or paste this <a href=https://calendar.google.com/calendar/ical/gardener.cloud.community%40gmail.com/public/basic.ics>iCal url</a> into any iCal client.</p><p>If you have a topic you&rsquo;d like to present or would like to see discussed, please propose a specific date on the <a href=https://docs.google.com/document/d/1314v8ziVNQPjdBrWp-Y4BYrTDlv7dq2cWDFIa9SMaP4>Gardener Community Meeting Agenda</a>. Find minutes in the same document. Please upload slides or other documents you presented to the
<a href=https://drive.google.com/drive/u/0/folders/1myXFoaFL_9fYJdUwnZcIXMBpx3dynhM8>Gardener Community Meeting folder</a>. Subscribe to the <a href=https://groups.google.com/forum/?fromgroups#!forum/gardener>gardener mailing list</a> to get edit permissions.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-1cf3a14a3a218c3fe1bbf3356a18e887>4 - Dependencies</h1><h1 id=testing>Testing</h1><p>We follow the BDD-style testing principles and are leveraging the <a href=https://onsi.github.io/ginkgo/>Ginkgo</a> framework along with <a href=http://onsi.github.io/gomega/>Gomega</a> as matcher library. In order to execute the existing tests, you can use</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>make <span class=nb>test</span>         <span class=c1># runs tests</span>
make verify       <span class=c1># runs static code checks and test</span>
</code></pre></div><p>There is an additional command for analyzing the code coverage of the tests. Ginkgo will generate standard Golang cover profiles which will be translated into a HTML file by the <a href=https://blog.golang.org/cover>Go Cover Tool</a>. Another command helps you to clean up the filesystem from the temporary cover profile files and the HTML report:</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>make test-cov
open gardener.coverage.html
make test-cov-clean
</code></pre></div><h3 id=sigsk8siocontroller-runtime-env-test>sigs.k8s.io/controller-runtime env test</h3><p>Some of the integration tests in Gardener are using the <code>sigs.k8s.io/controller-runtime/pkg/envtest</code> package.
It sets up a temporary control plane (etcd + kube-apiserver) against the integration tests can run.
The <code>test</code> and <code>test-cov</code> rules in the <code>Makefile</code> prepare this env test automatically by downloading the respective binaries (if not yet present) and set the necessary environment variables.</p><p>You can also run <code>go test</code> or <code>ginkgo</code> without the <code>test</code>/<code>test-cov</code> rules.
In this case you have to set the <code>KUBEBUILDER_ASSETS</code> environment variable to the path that contains the etcd + kube-apiserver binaries or you need to have the binaries pre-installed under <code>/usr/local/kubebuilder/bin</code>.</p><h2 id=dependency-management>Dependency Management</h2><p>We are using <a href=https://github.com/golang/go/wiki/Modules>go modules</a> for depedency management.
In order to add a new package dependency to the project, you can perform <code>go get &lt;PACKAGE>@&lt;VERSION></code> or edit the <code>go.mod</code> file and append the package along with the version you want to use.</p><h3 id=updating-dependencies>Updating Dependencies</h3><p>The <code>Makefile</code> contains a rule called <code>revendor</code> which performs <code>go mod vendor</code> and <code>go mod tidy</code>.
<code>go mod vendor</code> resets the main module&rsquo;s vendor directory to include all packages needed to build and test all the main module&rsquo;s packages. It does not include test code for vendored packages.
<code>go mod tidy</code> makes sure go.mod matches the source code in the module. It adds any missing modules necessary to build the current module&rsquo;s packages and dependencies, and it removes unused modules that don&rsquo;t provide any relevant packages.</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>make revendor
</code></pre></div><p>The dependencies are installed into the <code>vendor</code> folder which <strong>should be added</strong> to the VCS.</p><p>:warning: Make sure that you test the code after you have updated the dependencies!</p></div><div class=td-content style=page-break-before:always><h1 id=pg-bfd4e0d1fff2782a11d588066baf1e21>5 - Deploy into a Cluster</h1><h1 id=deploying-the-gardener-into-a-kubernetes-cluster>Deploying the Gardener into a Kubernetes cluster</h1><p>Similar to Kubernetes, Gardener consists out of control plane components (Gardener API server, Gardener controller manager, Gardener scheduler), and an agent component (Gardenlet).
The control plane is deployed in the so-called garden cluster while the agent is installed into every seed cluster.
Please note that it is possible to use the garden cluster as seed cluster by simply deploying the Gardenlet into it.</p><p>We are providing <a href=https://github.com/gardener/gardener/tree/master/charts/gardener>Helm charts</a> in order to manage the various resources of the components.
Please always make sure that you use the Helm chart version that matches the Gardener version you want to deploy.</p><h2 id=deploying-the-gardener-control-plane-api-server-controller-manager-scheduler>Deploying the Gardener control plane (API server, controller manager, scheduler)</h2><p>The <a href=https://raw.githubusercontent.com/gardener/gardener/master/docs/deployment/../../charts/gardener/controlplane/values.yaml>configuration values</a> depict the various options to configure the different components.
Please consult <a href=https://raw.githubusercontent.com/gardener/gardener/master/docs/deployment/../usage/configuration.md>this document</a> to get a detailed explanation of what can be configured for which component.
Also note that all resources and deployments need to be created in the <code>garden</code> namespace (not overrideable).</p><p>After preparing your values in a separate <code>controlplane-values.yaml</code> file, you can run the following command against your garden cluster:</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>helm install charts/gardener/controlplane <span class=se>\
</span><span class=se></span>  --namespace garden <span class=se>\
</span><span class=se></span>  -f controlplane-values.yaml <span class=se>\
</span><span class=se></span>  --wait
</code></pre></div><h2 id=deploying-gardener-extensions>Deploying Gardener extensions</h2><p>Gardener is an extensible system that does not contain the logic for provider-specific things like DNS management, cloud infrastructures, network plugins, operating system configs, and many more.</p><p>You have to install extension controllers for these parts.
Please consult <a href=https://raw.githubusercontent.com/gardener/gardener/master/docs/deployment/../extensions/overview.md>the documentation regarding extensions</a> to get more information.</p><h2 id=deploying-the-gardener-agent-gardenlet>Deploying the Gardener agent (Gardenlet)</h2><p>The Gardenlet requires a bootstrap token as well as a bootstrap kubeconfig in order to properly register itself with the Gardener control plane.</p><p>The <a href=https://raw.githubusercontent.com/gardener/gardener/master/docs/deployment/../../charts/gardener/gardenlet/values.yaml>configuration values</a> depict the various options to configure it.
Please consult <a href=https://raw.githubusercontent.com/gardener/gardener/master/docs/deployment/../concepts/gardenlet.md#component-configuration>this document</a> to get a detailed explanation of what can be configured.</p><p>Prepare your values in a separate <code>gardenlet-values.yaml</code> file:</p><ol><li>Create a bootstrap token secret in the <code>kube-system</code> namespace of the garden cluster (see <a href=https://kubernetes.io/docs/reference/access-authn-authz/bootstrap-tokens/>this</a> and <a href=https://kubernetes.io/docs/reference/command-line-tools-reference/kubelet-tls-bootstrapping/#bootstrap-tokens>this</a>).</li><li>Create a bootstrap kubeconfig containing this token:</li></ol><div class=highlight><pre class=chroma><code class=language-yaml data-lang=yaml><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>v1</span><span class=w>
</span><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Config</span><span class=w>
</span><span class=w></span><span class=nt>current-context</span><span class=p>:</span><span class=w> </span><span class=l>gardenlet-bootstrap@default</span><span class=w>
</span><span class=w></span><span class=nt>clusters</span><span class=p>:</span><span class=w>
</span><span class=w></span>- <span class=nt>cluster</span><span class=p>:</span><span class=w>
</span><span class=w>    </span><span class=nt>certificate-authority-data</span><span class=p>:</span><span class=w> </span><span class=l>&lt;ca-of-garden-cluster&gt;</span><span class=w>
</span><span class=w>    </span><span class=nt>server</span><span class=p>:</span><span class=w> </span><span class=l>https://&lt;endpoint-of-garden-cluster&gt;</span><span class=w>
</span><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>default</span><span class=w>
</span><span class=w></span><span class=nt>contexts</span><span class=p>:</span><span class=w>
</span><span class=w></span>- <span class=nt>context</span><span class=p>:</span><span class=w>
</span><span class=w>    </span><span class=nt>cluster</span><span class=p>:</span><span class=w> </span><span class=l>default</span><span class=w>
</span><span class=w>    </span><span class=nt>user</span><span class=p>:</span><span class=w> </span><span class=l>gardenlet-bootstrap</span><span class=w>
</span><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>gardenlet-bootstrap@default</span><span class=w>
</span><span class=w></span><span class=nt>users</span><span class=p>:</span><span class=w>
</span><span class=w></span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>gardenlet-bootstrap</span><span class=w>
</span><span class=w>  </span><span class=nt>user</span><span class=p>:</span><span class=w>
</span><span class=w>    </span><span class=nt>token</span><span class=p>:</span><span class=w> </span><span class=l>&lt;bootstrap-token&gt;</span><span class=w>
</span></code></pre></div><ol start=3><li>Provide this bootstrap kubeconfig together with a desired name and namespace to the Gardenlet Helm chart values <a href=https://raw.githubusercontent.com/gardener/gardener/master/docs/deployment/../../charts/gardener/gardenlet/values.yaml#L31-L35>here</a>:</li></ol><div class=highlight><pre class=chroma><code class=language-yaml data-lang=yaml><span class=nt>gardenClientConnection</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=nt>bootstrapKubeconfig</span><span class=p>:</span><span class=w>
</span><span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>gardenlet-kubeconfig-bootstrap</span><span class=w>
</span><span class=w>    </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class=l>garden</span><span class=w>
</span><span class=w>    </span><span class=nt>kubeconfig</span><span class=p>:</span><span class=w> </span><span class=p>|</span><span class=sd>
</span><span class=sd>      </span><span class=w>      </span><span class=l>&lt;bootstrap-kubeconfig&gt;</span><span class=w>
</span></code></pre></div><ol start=4><li>Define a name and namespace where the Gardenlet shall store the real kubeconfig it creates during the bootstrap process <a href=https://raw.githubusercontent.com/gardener/gardener/master/docs/deployment/../../charts/gardener/gardenlet/values.yaml#L31-L35>here</a>:</li></ol><div class=highlight><pre class=chroma><code class=language-yaml data-lang=yaml><span class=nt>gardenClientConnection</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=nt>kubeconfigSecret</span><span class=p>:</span><span class=w>
</span><span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>gardenlet-kubeconfig</span><span class=w>
</span><span class=w>    </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class=l>garden</span><span class=w>
</span></code></pre></div><ol start=5><li>Define either <code>seedSelector</code> or <code>seedConfig</code> (see <a href=https://raw.githubusercontent.com/gardener/gardener/master/docs/deployment/../concepts/gardenlet.md#seed-config-vs-seed-selector>this document</a></li></ol><p>Now you are ready to deploy the Helm chart:</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>helm install charts/gardener/gardenlet <span class=se>\
</span><span class=se></span>  --namespace garden <span class=se>\
</span><span class=se></span>  --name gardenlet <span class=se>\
</span><span class=se></span>  -f gardenlet-values.yaml <span class=se>\
</span><span class=se></span>  --wait
</code></pre></div><p>:warning: A current prerequisite of Kubernetes clusters that are used as seeds is to have a pre-deployed <code>nginx-ingress-controller</code> to make the Gardener work properly.
Moreover, there should exist a DNS record <code>*.ingress.&lt;SEED-CLUSTER-DOMAIN></code> where <code>&lt;SEED-CLUSTER-DOMAIN></code> is the value of the <code>.dns.ingressDomain</code> field of <a href=https://raw.githubusercontent.com/gardener/gardener/master/docs/deployment/../../example/50-seed.yaml>a Seed cluster resource</a> (or the <a href=https://raw.githubusercontent.com/gardener/gardener/master/docs/deployment/../../example/20-componentconfig-gardenlet.yaml#L84-L85>respective Gardenlet configuration</a>).</p></div><div class=td-content style=page-break-before:always><h1 id=pg-ad025ee5c7e0c8dfb30028f708b6c9cf>6 - Deploy into AKS</h1><h1 id=deploying-the-previous-gardener-versions-and-a-seed-into-an-aks-cluster>Deploying the previous Gardener versions and a Seed into an AKS cluster</h1><p>This document demonstrates how to install Gardener into an existing
AKS cluster. We&rsquo;ll use a single cluster to host both Gardener and a Seed to the
same cluster for the sake of simplicity .</p><p>Please note that this document is to provide you an example
installation and is not to be used in a production environment since
there are some certificates hardcoded, non-HA and non-TLS-enabled etcd
setup.</p><h1 id=high-level-overview>High Level Overview</h1><p>In this example we&rsquo;ll follow these steps to create a Seed cluster on AKS:</p><ul><li><a href=#deploying-the-gardener-and-a-seed-into-an-aks-cluster>Deploying the Gardener and a Seed into an AKS cluster</a></li><li><a href=#high-level-overview>High Level Overview</a></li><li><a href=#prerequisites>Prerequisites</a><ul><li><a href=#aws-credentials-for-route-53-hosted-zone>AWS credentials for Route 53 Hosted Zone</a></li><li><a href=#deploy-aks-cluster>Deploy AKS cluster</a><ul><li><a href=#initialize-helm-on-the-cluster>Initialize Helm on the Cluster</a></li><li><a href=#deploy-stablenginx-ingress-chart-to-aks>Deploy stable/nginx-ingress chart to AKS</a></li><li><a href=#create-wildcard-dns-record-for-the-ingress>Create wildcard DNS record for the ingress</a></li></ul></li><li><a href=#create-azure-service-principle-to-get-azure-credentials>Create Azure Service Principle to get Azure credentials</a></li><li><a href=#install-gardenctl>Install gardenctl</a></li></ul></li><li><a href=#install-gardener>Install Gardener</a><ul><li><a href=#create-garden-namespace>Create garden namespace</a></li><li><a href=#deploy-etcd>Deploy etcd</a></li><li><a href=#deploy-gardener-helm-chart>Deploy Gardener Helm Chart</a></li></ul></li><li><a href=#create-a-cloudprofile>Create a CloudProfile</a></li><li><a href=#define-seed-cluster-in-gardener>Define Seed cluster in Gardener</a><ul><li><a href=#create-the-seed-resource-definition-with-its-secret>Create the Seed resource definition with its Secret</a></li></ul></li><li><a href=#create-a-shoot-cluster>Create a Shoot cluster</a><ul><li><a href=#create-a-project-namespace-for-shoots>Create a Project (namespace) for Shoots</a></li><li><a href=#create-a-secretbinding-and-related-secret>Create a SecretBinding and related Secret</a></li><li><a href=#create-the-shoot-resource>Create the Shoot resource</a><ul><li><a href=#cluster-resources-after-shoot-is-created>Cluster Resources After Shoot is Created</a></li><li><a href=#troubleshooting-shoot-creation-issues>Troubleshooting Shoot Creation Issues</a></li></ul></li></ul></li><li><a href=#access-shoot-cluster>Access Shoot cluster</a></li><li><a href=#delete-shoot-cluster>Delete Shoot cluster</a></li></ul><h1 id=prerequisites>Prerequisites</h1><p>Summary of prerequisites:</p><ul><li>An Azure AKS cluster with:<ul><li>Helm initialized,</li><li>an ingress controller deployed,</li><li>a wildcard DNS record pointing the ingress,</li><li><code>az</code> command line client configured for Azure subscription,</li></ul></li><li>An Azure service principle to provide Azure credentials to Gardener,</li><li>A Route53 Hosted Zone and AWS account credentials with permissions on that Route53 Zone,<ul><li><code>aws</code> command line client configured for this account,</li></ul></li><li><code>gardenctl</code> command line client configured for the AKS cluster&rsquo;s kubeconfig</li></ul><p><strong>Note</strong>: Gardener doesn&rsquo;t have support for Azure DNS yet (see
<a href=https://github.com/gardener/gardener/issues/494>#494</a>). So, we use a Route53 Hosted Zone
even if we are deploying on Azure.</p><h2 id=aws-credentials-for-route-53-hosted-zone>AWS credentials for Route 53 Hosted Zone</h2><p>You need to provide credentials for AWS with permission to access Route53
Hosted Zone. In this example we&rsquo;ll assume your domain for the Hosted
Zone is <code>.your.domain.here</code>.</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>HOSTED_ZONE_ID=        # place your AWS Route53 hostedZoneID here
</code></pre></div><p>Create an AWS user, define policy to allow permission for the Hosted
Zone and note the <code>hostedZoneID</code>, <code>accessKeyID</code> and <code>secretAccessKey</code>
for later use.</p><h2 id=deploy-aks-cluster>Deploy AKS cluster</h2><p>Here you can find a summary for creating an AKS cluster, if you already
have one, skip this step.</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>az group create --name garden-1 --location eastus
az aks create --resource-group garden-1 --name garden-1 \
  --kubernetes-version 1.11.5 \
  --node-count 2 --node-vm-size Standard_DS4_v2 \
  --generate-ssh-keys
az aks get-credentials --resource-group garden-1 --name garden-1 --admin
</code></pre></div><h3 id=initialize-helm-on-the-cluster>Initialize Helm on the Cluster</h3><p>Since RBAC is enabled by default we need to deploy helm with an RBAC config.</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>kubectl apply -f https://raw.githubusercontent.com/Azure/helm-charts/master/docs/prerequisities/helm-rbac-config.yaml
helm init --service-account tiller
</code></pre></div><h3 id=deploy-stablenginx-ingress-chart-to-aks>Deploy stable/nginx-ingress chart to AKS</h3><p>At the moment the <code>Ingress</code> resources created by the Gardener are
expecting the nginx-ingress style annotations to work.</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>helm upgrade --install \
  --namespace kube-system \
  nginx-ingress stable/nginx-ingress
</code></pre></div><h3 id=create-wildcard-dns-record-for-the-ingress>Create wildcard DNS record for the ingress</h3><p>You need to pick a wildcard subdomain matching your Route53 Hosted
Zone here. This ingress wildcard record is supposed to be part of the Seed
cluster rather than Gardener cluster, in our example we&rsquo;ll use
<code>*.seed-1.your.domain.here</code>.</p><p>Assuming you have the AWS cli for your Route53 Hosted Zone is
configured on your local, here we&rsquo;ll create the wildcard DNS record
using the <a href=https://github.com/wallix/awless#readme><code>awless</code></a>. You can also use the AWS
console or any other tool of your choice to create the wildcard
record:</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>HOSTED_ZONE_DOMAIN=$(aws route53 get-hosted-zone --id /hostedzone/${HOSTED_ZONE_ID:?&#34;HOSTED_ZONE_ID is missing&#34;} --query &#39;HostedZone.Name&#39; --output text)
INGRESS_DOMAIN=&#34;seed-1.${HOSTED_ZONE_DOMAIN%%.}&#34;
# Get LB IP address from `kubectl -n kube-system get svc shared-ingress-nginx-ingress-controller`
LB_IP=$(kubectl -n kube-system get svc nginx-ingress-controller --template &#39;{{(index .status.loadBalancer.ingress 0).ip}}&#39;)
awless create record \
  zone=$HOSTED_ZONE_ID \
  name=&#34;*.$INGRESS_DOMAIN&#34; \
  value=$LB_IP \
  type=A \
  ttl=300
</code></pre></div><h2 id=create-azure-service-principle-to-get-azure-credentials>Create Azure Service Principle to get Azure credentials</h2><p>We need <code>client_id</code> and <code>client_secret</code> to allow Gardener to reach
Azure services, we can generate a pair by creating a Service Principle
on Azure:</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>$ az ad sp create-for-rbac --role=&#34;Contributor&#34;
Retrying role assignment creation: 1/36
{
  &#34;appId&#34;: &#34;xxxxxx-xxx-xxxx-xxx-xxxxx&#34;,     #az_client_id
  &#34;displayName&#34;: &#34;azure-cli-2018-05-23-16-15-49&#34;,
  &#34;name&#34;: &#34;http://azure-cli-2018-05-23-16-15-49&#34;,
  &#34;password&#34;: &#34;xxxxxx-xxx-xxxx-xxx-xxxxx&#34;,  #az_client_secret
  &#34;tenant&#34;: &#34;xxxxxx-xxx-xxxx-xxx-xxxxx&#34;     #az_tenant_id
}
</code></pre></div><p>Let&rsquo;s define some env variables for later use</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>CLIENT_ID=       # place your Azure Service Principal appId
CLIENT_SECRET=   # place your Azure Service Principal password here
</code></pre></div><h2 id=install-gardenctl>Install gardenctl</h2><p>In this example we&rsquo;ll be using <code>gardenctl</code> to interact with
Gardener. You can install <code>gardenctl</code> following instruction in its
repo: <a href=https://github.com/gardener/gardenctl>https://github.com/gardener/gardenctl</a></p><p>Here is a sample configuration for gardenctl:</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>$ cat ~/.garden/config
gardenClusters:
- name: dev
  kubeConfig: ~/.kube/config
</code></pre></div><h1 id=install-gardener>Install Gardener</h1><h2 id=create-garden-namespace>Create garden namespace</h2><p>This is where we deploy Gardener components.</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>kubectl apply -f example/00-namespace-garden.yaml
</code></pre></div><h2 id=deploy-etcd>Deploy etcd</h2><p>Since Gardener is an extension API Server, it can share the etcd
backing native Kubernetes cluster&rsquo;s API Server, and hence explicit etcd
installation is optional. But in our case we have no access to the
control plane components of the AKS cluster and we have to deploy our
own etcd ourselves for Gardener. Lets deploy an etcd using the
<a href=https://github.com/gardener/etcd-backup-restore>gardener/etcd-backup-restore</a>
project, which is also used by the Gardener for Shoot control plane.</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback># pull the etcd-backup-restore
git clone https://github.com/gardener/etcd-backup-restore.git

# deploy etcd
helm upgrade --install \
  --namespace garden \
  etcd etcd-backup-restore/chart \
  --set tls=
</code></pre></div><p><strong>Note</strong>: This etcd installation doesn&rsquo;t provide HA. But etcd will be
auto recovered by the Deployment. This could be sufficient for some
deployments but may not be suitable for production usage. Also note
that this etcd is not deployed with TLS enabled and doesn&rsquo;t use
certificates for authentication.</p><p>Check etcd pod&rsquo;s health, it should have <code>READY:2/2</code> and <code>STATUS:Running</code>:</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>$ kubectl -n garden get pods
NAME              READY   STATUS    RESTARTS   AGE
etcd-for-test-0   2/2     Running   0          1m
</code></pre></div><h2 id=deploy-gardener-helm-chart>Deploy Gardener Helm Chart</h2><p>Check (current releases)[https://github.com/gardener/gardener/releases] and
pick a suitable one to install.</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>GARDENER_RELEASE=0.17.1
</code></pre></div><p>gardener-controller-manager will need to maintain some DNS records for Seed.
So, you need to provide Route53 credentials in the values.yaml file:</p><ul><li><strong>global.controller.internalDomain.hostedZoneID</strong></li><li><strong>global.controller.internalDomain.domain</strong>: Here pick a subdomain for your
Gardener to maintain DNS records for your Shoot clusters. This domain has
to be within your Route53 Hosted Zone. e.g. <code>garden-1.your.domain.here</code></li><li><strong>global.controller.internalDomain.credentials</strong></li><li><strong>global.controller.internalDomain.secretAccessKey</strong></li></ul><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>HOSTED_ZONE_DOMAIN=$(
  aws route53 get-hosted-zone \
    --id /hostedzone/${HOSTED_ZONE_ID:?&#34;HOSTED_ZONE_ID is missing&#34;} \
    --query &#39;HostedZone.Name&#39; \
    --output text)
HOSTED_ZONE_DOMAIN=${HOSTED_ZONE_DOMAIN%%.}
GARDENER_DOMAIN=&#34;garden-1.${HOSTED_ZONE_DOMAIN}&#34;
ACCESS_KEY_ID=$(aws configure get aws_access_key_id)
SECRET_ACCESS_KEY=$(aws configure get aws_secret_access_key)
cat &lt;&lt;EOF &gt; gardener-values.yaml
global:
  apiserver:
    image:
      tag: ${GARDENER_RELEASE:?&#34;GARDENER_RELEASE is missing&#34;}
    etcd:
      servers: http://etcd-for-test-client:2379
      useSidecar: false
  controller:
    image:
      tag: ${GARDENER_RELEASE:?&#34;GARDENER_RELEASE is missing&#34;}
    internalDomain:
      provider: aws-route53
      hostedZoneID: ${HOSTED_ZONE_ID}
      domain: ${HOSTED_ZONE_DOMAIN}
      credentials:
        AWS_ACCESS_KEY_ID: ${ACCESS_KEY_ID}
        AWS_SECRET_ACCESS_KEY: ${SECRET_ACCESS_KEY}
EOF
</code></pre></div><p>After creating the <code>gardener-values.yaml</code> file, since chart definition in
master branch can have breaking changes after the release, checkout the
gardener tag for that release, and run:</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>git checkout ${GARDENER_RELEASE:?&#34;GARDENER_RELEASE is missing&#34;}
helm upgrade --install \
  --namespace garden \
  garden charts/gardener \
  -f charts/gardener/local-values.yaml \
  -f gardener-values.yaml
</code></pre></div><p>Validate the Gardener is deployed:</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>helm status garden  # Wait for `STATUS: DEPLOYED`

kubectl -n garden get deploy,pod -l app=gardener

# Better if you leave two terminals open in for below commands, and
# keep an eye on whats going on behind the scenes as you create/delete
# Gardener specific resources (Seed, CloudProfile, SecretBinding, Shoot).
kubectl -n garden logs -f deployment/gardener-apiserver           # confirm no issues
kubectl -n garden logs -f deployment/gardener-controller-manager  # confirm no issues, except some &#34;Failed to list *v1beta1...&#34; messages
</code></pre></div><p><strong>Note</strong>: This is not meant to be used in production. You may not want
to use <code>apiserver.insecureSkipTLSVerify=true</code>, the hardcoded apiserver
certificates, and insecure (non-tls enabled) etcd. But for the sake of
keeping this example simple you can just keep those values as they
are.</p><h1 id=create-a-cloudprofile>Create a CloudProfile</h1><p>We need to create a CloudProfile to be referred from the Shoot
(<a href=https://github.com/gardener/gardener/blob/master/example/30-cloudprofile.yaml><code>example/30-cloudprofile.yaml</code></a>):</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>kubectl apply -f example/30-cloudprofile.yaml
</code></pre></div><p>Validate that CloudProfile is created:</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>kubectl describe -f example/30-cloudprofile.yaml
</code></pre></div><h1 id=define-seed-cluster-in-gardener>Define Seed cluster in Gardener</h1><p>In our setup we&rsquo;ll use the cluster for Gardener also as a Seed, this
saves us from creating a new Kubernetes cluster. But you can also
create an explicit cluster for the Seed. Seed cluster can also be
placed into any other cloud provider or on prem. But keep in mind that
below steps may differ if you use a different cluster for seed.</p><p>Currently, a Seed cluster is just a Kubeconfig for the Gardener. The
seed cluster could have been created by any tool, Gardener only cares
about having a valid Kubeconfig to talk to its API.</p><h2 id=create-the-seed-resource-definition-with-its-secret>Create the Seed resource definition with its Secret</h2><p>Lets start with the required seed secret first. Here we need to
provide it&rsquo;s cloud provider credentials and kubeconfig in the seed
secret. Update
<a href=https://github.com/gardener/gardener/blob/master/example/40-secret-seed.yaml><code>example/40-secret-seed.yaml</code></a>
and place the secrets for your environment:</p><ul><li><strong>data.subscriptionID</strong>: you can learn this one with <code>az account show</code></li><li><strong>data.tenantID</strong>: from <code>az ad sp create-for-rbac</code> output as you can see above</li><li><strong>data.clientID</strong>: from <code>az ad sp create-for-rbac</code> output as you can see above</li><li><strong>data.clientSecret</strong>: from <code>az ad sp create-for-rbac</code> output as you can see above</li><li><strong>data.kubeconfig</strong>: you can get this one with <code>az aks get-credentials --resource-group garden-1 --name garden-1 -f - | base64</code>)</li></ul><p><strong>Note</strong>: All of the above values must be base64 encoded. If you skip this it will hurt you later.</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>SUBSCRIPTION_ID=$(az account list -o json | jq -r &#39;.[] | select(.isDefault == true) | .id&#39;)
TENANT_ID=$(az account show -o tsv --query &#39;tenantId&#39;)
KUBECONFIG_FOR_SEED_CLUSTER=$(az aks get-credentials --resource-group garden-1 --name garden-1 -f -)
sed -i \
  -e &#34;s@base64(uuid-of-subscription)@$(echo $SUBSCRIPTION_ID | tr -d &#39;\n&#39; | base64)@&#34; \
  -e &#34;s@base64(uuid-of-tenant)@$(echo &#34;$TENANT_ID&#34; | tr -d &#39;\n&#39; | base64)@&#34; \
  -e &#34;s@base64(uuid-of-client)@$(echo &#34;${CLIENT_ID:?&#34;CLIENT_ID is missing&#34;}&#34; | tr -d &#39;\n&#39; | base64)@&#34; \
  -e &#34;s@base64(client-secret)@$(echo &#34;${CLIENT_SECRET:?&#34;CLIENT_SECRET is missing&#34;}&#34; | tr -d &#39;\n&#39; | base64)@&#34; \
  -e &#34;s@base64(kubeconfig-for-seed-cluster)@$(echo &#34;$KUBECONFIG_FOR_SEED_CLUSTER&#34; | base64 -w 0)@&#34; \
  example/40-secret-seed.yaml
</code></pre></div><p>After updating the fields, create the Seed secret:</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>kubectl apply -f example/40-secret-seed.yaml
</code></pre></div><p>Before creating Seed, we need to update the
<a href=https://github.com/gardener/gardener/blob/master/example/50-seed.yaml><code>example/50-seed.yaml</code></a> file and
update:</p><ul><li><strong>spec.networks</strong>: IP ranges used in your AKS cluster.</li><li><strong>spec.ingressDomain</strong>: Place here the wildcard domain you have for
the ingress controller (we created this record in prerequisites).
Gardener doesn&rsquo;t create this DNS records but assumes its created
ahead of time, Seed clusters are not provisioned by Gardener.</li><li><strong>spec.cloud.region</strong>: <code>eastus</code> (the region of the existing AKS cluster)</li></ul><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>HOSTED_ZONE_DOMAIN=$(aws route53 get-hosted-zone --id /hostedzone/${HOSTED_ZONE_ID:?&#34;HOSTED_ZONE_ID is missing&#34;} --query &#39;HostedZone.Name&#39; --output text)
INGRESS_DOMAIN=&#34;seed-1.${HOSTED_ZONE_DOMAIN%%.}&#34;
# discover AKS CIDRs
NODE_CIDR=$(az network vnet list -g MC_garden-1_garden-1_eastus -o json | jq -r &#39;.[] | .subnets[] | .addressPrefix&#39;)
POD_CIDR=$(kubectl -n kube-system get daemonset/kube-proxy -o yaml | grep cluster-cidr= | grep -v annotations | cut -d = -f2)
SERVICE_CIDR=10.0.0.0/16  # This one is hardcoded for now, not easy to discover
sed -i \
  -e &#34;s/ingressDomain: dev.azure.seed.example.com/ingressDomain: $INGRESS_DOMAIN/&#34; \
  -e &#34;s/region: westeurope/region: eastus/&#34; \
  -e &#34;s@nodes: 10.240.0.0/16@nodes: $NODE_CIDR@&#34; \
  -e &#34;s@pods: 10.241.128.0/17@pods: $POD_CIDR@&#34; \
  -e &#34;s@services: 10.241.0.0/17@services: $SERVICE_CIDR@&#34; \
  example/50-seed.yaml
</code></pre></div><p>Now we are ready to create the seed:</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>kubectl apply -f example/50-seed.yaml
</code></pre></div><p>Check the logs in gardener-controller-manager and also wait for seed
to be <code>Ready: True</code>. This means gardener-controller-manager is able to
reach the Seed cluster with the credentials you provide.</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>$ gardenctl target garden dev
KUBECONFIG=/Users/user/.kube/config
$ kubectl get seed azure
NAME    CLOUDPROFILE   REGION   INGRESS DOMAIN            AVAILABLE   AGE
azure   azure          eastus   seed-1.your.domain.here   True        1m
$ gardenctl ls seeds
seeds:
- seed: azure
</code></pre></div><p>If something goes wrong verify that you provided right credentials,
and base64 encoded strings of those in the secret. Also check the
status field in the Seed resource and gardener-controller-manager
logs:</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>$ kubectl get seed azure -o json | jq .status
{
  &#34;conditions&#34;: [
    {
      &#34;lastTransitionTime&#34;: &#34;2018-05-31T14:56:49Z&#34;,
      &#34;message&#34;: &#34;all checks passed&#34;,
      &#34;reason&#34;: &#34;Passed&#34;,
      &#34;status&#34;: &#34;True&#34;,
      &#34;type&#34;: &#34;Available&#34;
    }
  ]
}
</code></pre></div><h1 id=create-a-shoot-cluster>Create a Shoot cluster</h1><h2 id=create-a-project-namespace-for-shoots>Create a Project (namespace) for Shoots</h2><p>In this step we create a namespace in Gardener cluster to keep Shoot
resource definitions. A <code>project</code> in Gardener terminology is simply a
namespace that holds group of Shoots, during this example we&rsquo;ll deploy
a single Shoot. (Mind the extra labels defined in
<a href=https://raw.githubusercontent.com/gardener/gardener/master/docs/deployment/../../example/00-namespace-garden-dev.yaml>example/00-namespace-garden-dev.yaml</a>).</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>kubectl apply -f example/05-project-dev.yaml
</code></pre></div><p>You can check the projects via <code>gardenctl</code>:</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>$ gardenctl target garden dev
$ kubectl get project dev
NAME   NAMESPACE    STATUS   OWNER                  CREATOR   AGE
dev    garden-dev   Ready    john.doe@example.com   client    1m
$ kubectl get ns garden-dev
NAME          STATUS   AGE
garden-dev    Active   1m
$ gardenctl ls projects
projects:
- project: garden-dev
</code></pre></div><h2 id=create-a-secretbinding-and-related-secret>Create a SecretBinding and related Secret</h2><p>We&rsquo;ll use same Azure credentials with
<a href=https://github.com/gardener/gardener/blob/master/example/40-secret-seed.yaml><code>example/40-secret-seed.yaml</code></a>,
this is due to the fact that we use the same Azure Subscription for
the Shoot and Seed clusters. Differently from the Seed secret, in this
one we don&rsquo;t need to provide <code>kubeconfig</code> since the Shoot cluster will
be provisioned by Gardener, and we need to provide credentials for
Route53 DNS records management.</p><p>Update
<a href=https://github.com/gardener/gardener/blob/master/example/70-secret-provider.yaml><code>example/70-secret-provider.yaml</code></a>
and place the secrets for your environment:</p><ul><li><strong>data.subscriptionID</strong>: you can learn this one with <code>az account show</code></li><li><strong>data.tenantID</strong>: from <code>az ad sp create-for-rbac</code> output as you can see above</li><li><strong>data.clientID</strong>: from <code>az ad sp create-for-rbac</code> output as you can see above</li><li><strong>data.clientSecret</strong>: from <code>az ad sp create-for-rbac</code> output as you can see above</li><li><strong>data.accessKeyID</strong>: You need to add this field for Route53 records to be updated.</li><li><strong>data.secretAccessKey</strong>: You need to add this field for Route53 records to be updated.</li></ul><p><strong>Note</strong>: All of the above values must be base64 encoded. If you skip this it will hurt you later.</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>SUBSCRIPTION_ID=$(az account list -o json | jq -r &#39;.[] | select(.isDefault == true) | .id&#39;)
TENANT_ID=$(az account show -o tsv --query &#39;tenantId&#39;)
ACCESS_KEY_ID=$(aws configure get aws_access_key_id)
SECRET_ACCESS_KEY=$(aws configure get aws_secret_access_key)
sed -i \
  -e &#34;s@base64(uuid-of-subscription)@$(echo $SUBSCRIPTION_ID | tr -d &#39;\n&#39; | base64)@&#34; \
  -e &#34;s@base64(uuid-of-tenant)@$(echo &#34;$TENANT_ID&#34; | tr -d &#39;\n&#39; | base64)@&#34; \
  -e &#34;s@base64(uuid-of-client)@$(echo &#34;${CLIENT_ID:?&#34;CLIENT_ID is missing&#34;}&#34; | tr -d &#39;\n&#39; | base64)@&#34; \
  -e &#34;s@base64(client-secret)@$(echo &#34;${CLIENT_SECRET:?&#34;CLIENT_SECRET is missing&#34;}&#34; | tr -d &#39;\n&#39; | base64)@&#34; \
  -e &#34;\$a\ \ accessKeyID: $(echo $ACCESS_KEY_ID | tr -d &#39;\n&#39; | base64 )&#34; \
  -e &#34;\$a\ \ secretAccessKey: $(echo $SECRET_ACCESS_KEY | tr -d &#39;\n&#39; | base64 )&#34; \
  example/70-secret-provider.yaml
</code></pre></div><p>After updating the fields, create the cloud provider secret:</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>kubectl apply -f example/70-secret-provider.yaml
</code></pre></div><p>And create the SecretBinding resource to allow Gardener use that
secret
(<a href=https://github.com/gardener/gardener/blob/master/example/80-secretbinding.yaml><code>example/80-secretbinding.yaml</code></a>):</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>sed -i \
  -e &#39;s/# namespace: .*/  namespace: garden-dev/&#39; \
  example/80-secretbinding.yaml
kubectl apply -f example/80-secretbinding.yaml
</code></pre></div><p>Check the logs in gardener-controller-manager, there should not be any
problems reported.</p><h2 id=create-the-shoot-resource>Create the Shoot resource</h2><p>Update the fields in <a href=https://github.com/gardener/gardener/blob/master/example/90-shoot.yaml><code>example/90-shoot.yaml</code></a>:</p><ul><li><strong>spec.cloud.region</strong>: <code>eastus</code> (this must match the seed cluster&rsquo;s region)</li><li><strong>spec.dns.domain</strong>: This is used to specify the base domain for
your api (and other in the future) endpoint(s). For example when
<code>johndoe-azure.garden-dev.your.domain.here</code> is used as a value, then your
apiserver is available at <code>api.johndoe-azure.garden-dev.your.domain.here</code></li><li><strong>spec.dns.hostedZoneID</strong>: This field doesn&rsquo;t exist in the example
you need to add this field and place the Route53 Hosted Zone ID.</li></ul><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>HOSTED_ZONE_DOMAIN=$(aws route53 get-hosted-zone --id /hostedzone/${HOSTED_ZONE_ID:?&#34;HOSTED_ZONE_ID is missing&#34;} --query &#39;HostedZone.Name&#39; --output text)
SHOOT_DOMAIN=&#34;johndoe-azure.garden-dev.${HOSTED_ZONE_DOMAIN%%.}&#34;
KUBE_LEGO_EMAIL=$(git config user.email)
sed -i \
  -e &#34;s/region: westeurope/region: eastus/&#34; \
  -e &#34;s/domain: johndoe-azure.garden-dev.example.com/domain: $SHOOT_DOMAIN/&#34; \
  -e &#34;/domain:/a\ \ \ \ hostedZoneID: $HOSTED_ZONE_ID&#34; \
  -e &#34;s/email: john.doe@example.com/email: $KUBE_LEGO_EMAIL/&#34; \
  example/90-shoot.yaml
</code></pre></div><p>And let&rsquo;s create the Shoot resource:</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>kubectl apply -f example/90-shoot.yaml
</code></pre></div><p>After creating the Shoot resource, gardener-controller-manager will
pick it up and start provisioning the Shoot cluster.</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>$ kubectl get -f example/90-shoot.yaml
NAME            CLOUDPROFILE   VERSION   SEED    DOMAIN                                      OPERATION    PROGRESS   APISERVER   CONTROL     NODES       SYSTEM      AGE
johndoe-azure   azure          1.12.3    azure   johndoe-azure.garden-dev.your.domain.here   Processing   15         &lt;unknown&gt;   &lt;unknown&gt;   &lt;unknown&gt;   &lt;unknown&gt;   16s
</code></pre></div><p>Follow the logs in your console with gardener-controller-manager,
starting like below you&rsquo;ll see plenty of <code>Waiting</code> and <code>Executing</code>,
etc. logs and many tasks will keep repeating:</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>time=&#34;2018-06-09T07:35:45Z&#34; level=info msg=&#34;[SHOOT RECONCILE] garden-dev/johndoe-azure&#34;
time=&#34;2018-06-09T07:35:46Z&#34; level=info msg=&#34;Starting flow Shoot cluster creation&#34; opid=VIBBBGFx shoot=garden-dev/johndoe-azure
time=&#34;2018-06-09T07:35:46Z&#34; level=info msg=&#34;Executing (*Botanist).botanist.Shoot.Components.DNS.External{Provider/Entry}.Deploy&#34; opid=VIBBBGFx shoot=garden-dev/johndoe-azure
time=&#34;2018-06-09T07:35:46Z&#34; level=info msg=&#34;Executing (*Botanist).DeployNamespace&#34; opid=VIBBBGFx shoot=garden-dev/johndoe-azure
time=&#34;2018-06-09T07:35:46Z&#34; level=info msg=&#34;Executing (*Botanist).DeployKubeAPIServerService&#34; opid=VIBBBGFx shoot=garden-dev/johndoe-azure
time=&#34;2018-06-09T07:35:46Z&#34; level=info msg=&#34;Executing (*Botanist).DeployBackupNamespaceFromShoot&#34; opid=VIBBBGFx shoot=garden-dev/johndoe-azure
time=&#34;2018-06-09T07:35:46Z&#34; level=info msg=&#34;Waiting for Terraform validation Pod &#39;johndoe-azure.external-dns.tf-pod-d8f66&#39; to be completed...&#34; opid=VIBBBGFx shoot=garden-dev/johndoe-azure
time=&#34;2018-06-09T07:35:51Z&#34; level=info msg=&#34;Waiting for Terraform validation Pod &#39;johndoe-azure.external-dns.tf-pod-d8f66&#39; to be completed...&#34; opid=VIBBBGFx shoot=garden-dev/johndoe-azure
time=&#34;2018-06-09T07:35:51Z&#34; level=info msg=&#34;Executing (*Botanist).MoveBackupTerraformResources&#34; opid=VIBBBGFx shoot=garden-dev/johndoe-azure
time=&#34;2018-06-09T07:35:52Z&#34; level=info msg=&#34;Executing (*Botanist).WaitUntilKubeAPIServerServiceIsReady&#34; opid=VIBBBGFx shoot=garden-dev/johndoe-azure
time=&#34;2018-06-09T07:35:52Z&#34; level=info msg=&#34;Waiting until the kube-apiserver service is ready...&#34; opid=VIBBBGFx shoot=garden-dev/johndoe-azure
time=&#34;2018-06-09T07:35:52Z&#34; level=info msg=&#34;Waiting until the backup-infrastructure has been reconciled in the Garden cluster...&#34; opid=VIBBBGFx shoot=garden-dev/johndoe-azure
time=&#34;2018-06-09T07:35:56Z&#34; level=info msg=&#34;Waiting for Terraform validation Pod &#39;johndoe-azure.external-dns.tf-pod-d8f66&#39; to be completed...&#34; opid=VIBBBGFx shoot=garden-dev/johndoe-azure
time=&#34;2018-06-09T07:35:57Z&#34; level=info msg=&#34;Waiting until the kube-apiserver service is ready...&#34; opid=VIBBBGFx shoot=garden-dev/johndoe-azure
time=&#34;2018-06-09T07:35:57Z&#34; level=info msg=&#34;Waiting until the backup-infrastructure has been reconciled in the Garden cluster...&#34; opid=VIBBBGFx shoot=garden-dev/johndoe-azure
time=&#34;2018-06-09T07:36:01Z&#34; level=info msg=&#34;Waiting for Terraform validation Pod &#39;johndoe-azure.external-dns.tf-pod-d8f66&#39; to be completed...&#34; opid=VIBBBGFx shoot=garden-dev/johndoe-azure
time=&#34;2018-06-09T07:36:02Z&#34; level=info msg=&#34;Waiting until the kube-apiserver service is ready...&#34; opid=VIBBBGFx shoot=garden-dev/johndoe-azure
time=&#34;2018-06-09T07:36:02Z&#34; level=info msg=&#34;Waiting until the backup-infrastructure has been reconciled in the Garden cluster...&#34; opid=VIBBBGFx shoot=garden-dev/johndoe-azure
...
</code></pre></div><p>At this stage you should be waiting for a while until the Shoot
cluster is provisioned and initial resources are deployed.</p><p>During the provisioning you can also check output of these commands to
have a better understanding about what&rsquo;s going on in the seed cluster:</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>$ gardenctl ls shoots
projects:
- project: garden-dev
  shoots:
  - johndoe-azure
$ gardenctl ls issues
issues:
- project: garden-dev
  seed: azure
  shoot: johndoe-azure
  health: Unknown
  status:
    lastOperation:
      description: Executing DeployKubeAddonManager, ReconcileMachines.
      lastUpdateTime: 2018-06-09 08:40:20 +0100 IST
      progress: 74
      state: Processing
      type: Create
$ kubectl -n garden-dev get shoot johndoe-azure
NAMESPACE    NAME            SEED      DOMAIN                                       VERSION   CONTROL   NODES     SYSTEM    LATEST
garden-dev   johndoe-azure   azure     johndoe-azure.garden-dev.your.domain.here   1.10.1    True      True      True      Succeeded
$ kubectl -n garden-dev describe shoot johndoe-azure
...
Events:
  Type     Reason          Age   From                         Message
  ----     ------          ----  ----                         -------
  Normal   Reconciling     1h    gardener-controller-manager  [BrXWiztO] Reconciling Shoot cluster state
  Normal   Reconciling     59m   gardener-controller-manager  [rBFsfwU5] Reconciling Shoot cluster state
  Normal   Reconciling     59m   gardener-controller-manager  [2HAbm45D] Reconciling Shoot cluster state
  Normal   Reconciling     48m   gardener-controller-manager  [S1QA0ksz] Reconciling Shoot cluster state
  Normal   Reconciling     47m   gardener-controller-manager  [lvcSKy1Q] Reconciling Shoot cluster state
  Normal   Reconciling     47m   gardener-controller-manager  [MddMyk8W] Reconciling Shoot cluster state
  Normal   Reconciling     47m   gardener-controller-manager  [XDAAWABd] Reconciling Shoot cluster state
  Normal   Reconciling     46m   gardener-controller-manager  [6HYH9Psz] Reconciling Shoot cluster state
  Normal   Reconciling     46m   gardener-controller-manager  [rhL38ym4] Reconciling Shoot cluster state
  Normal   Reconciling     35m   gardener-controller-manager  [BOt4Nvso] Reconciling Shoot cluster state
  Normal   Reconciling     35m   gardener-controller-manager  [JPtmXmxD] Reconciling Shoot cluster state
  Normal   Reconciling     34m   gardener-controller-manager  [ldHsVA6G] Reconciling Shoot cluster state
  Normal   Reconciled      31m   gardener-controller-manager  [ldHsVA6G] Reconciled Shoot cluster state
  Normal   Reconciling     26m   gardener-controller-manager  [yBh2IBOF] Reconciling Shoot cluster state
  Normal   Reconciled      24m   gardener-controller-manager  [yBh2IBOF] Reconciled Shoot cluster state
  Normal   Reconciling     16m   gardener-controller-manager  [bqmFtHUA] Reconciling Shoot cluster state
  Normal   Reconciled      14m   gardener-controller-manager  [bqmFtHUA] Reconciled Shoot cluster state
  Normal   Reconciling     6m    gardener-controller-manager  [7QgHE5CH] Reconciling Shoot cluster state
  Normal   Reconciled      3m    gardener-controller-manager  [7QgHE5CH] Reconciled Shoot cluster state
</code></pre></div><p>Check Shoot cluster:</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>$ gardenctl target garden dev
KUBECONFIG=/Users/user/.kube/config
$ gardenctl target project garden-dev
$ gardenctl target shoot johndoe-azure
KUBECONFIG=/Users/user/.garden/cache/projects/garden-dev/johndoe-azure/kubeconfig.yaml
$ gardenctl kubectl cluster-info
Kubernetes master is running at https://api.johndoe-azure.garden-dev.your.domain.here
CoreDNS is running at https://api.johndoe-azure.garden-dev.your.domain.here/api/v1/namespaces/kube-system/services/kube-dns:dns/proxy
kubernetes-dashboard is running at https://api.johndoe-azure.garden-dev.your.domain.here/api/v1/namespaces/kube-system/services/https:kubernetes-dashboard:/proxy

To further debug and diagnose cluster problems, use &#39;kubectl cluster-info dump&#39;.
</code></pre></div><h3 id=cluster-resources-after-shoot-is-created>Cluster Resources After Shoot is Created</h3><p>After the Shoot has been created the summary of the resources in the
AKS cluster handled by Gardener will be something like this:</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>non-namespaced resources
  CloudProfile: azure
  Project: dev
  Namespace: garden-dev
  Seed: azure  # cloud.profile:azure, cloud.region:eastus, secretRef.name:seed-azure, secretRef.namespace: garden

Namespace: garden
  Secret: seed-azure  # aks credentials, kubeconfig
  # No other resources with any kind handled by Gardener
  # Gardener components as well lives in this namespace

Namespace: garden-dev  # maps to &#34;project:dev&#34; in Gardener
  Secret: core-azure         # credentials for aks + aws (for route53)
  SecretBinding: core-azure  # secretRef.name:core-azure
  Shoot: johndoe-azure       # seed:azure, secretBindingRef.name:core-azure

Namespace: shoot--dev--johndoe-azure
  # These are automatically created once Shoot resource is created
  AzureMachineClass: shoot--dev--johndoe-azure-cpu-worker-8506a
  MachineDeployment: shoot--dev--johndoe-azure-cpu-worker
  MachineSet: shoot--dev--johndoe-azure-cpu-worker-849bbbf75
  Machine: shoot--dev--johndoe-azure-cpu-worker-849bbbf75-b42vh
  BackupInfra: shoot--dev--johndoe-azure--c1b3b  # seed:azure, shootUID: shoot.status.UID.
  # Many other resources created as part of shoot cluster,
  #   but only above ones are handled by Gardener

Namespace: backup--shoot--dev--johndoe-azure--c1b3b
  # Secrets and configMap having info related to backup infrastructure
  #   are created by Gardener.
</code></pre></div><h3 id=troubleshooting-shoot-creation-issues>Troubleshooting Shoot Creation Issues</h3><p>For any issue happening during Shoot provisioning, you can consult the
gardener-controller-manager logs, or the state in the shoot resource,
<code>gardenctl</code> also provides a command to check Shoot cluster states:</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback># check gardener-controller-manager logs
kubectl -n garden logs -f deployment/gardener-controller-manager
# kubectl describe can provide you a human readable output of
# same information in below gardenctl command.
kubectl -n garden-dev describe shoot johndoe-azure
# also try cheking the machine-controller-manager logs of the shoot
kubectl logs -n shoot--dev--johndoe-azure deployment/machine-controller-manager
</code></pre></div><p>With <code>gardenctl</code>:</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>$ gardenctl ls issues
issues:
- project: garden-dev
  seed: azure
  shoot:
  health: Ready
  status: johndoe-azure
    lastError: &#34;Failed to reconcile Shoot cluster state: Errors occurred during flow
      execution: &#39;(*Botanist).Shoot.Components.DNS.External{Provider/Entry}.Destroy&#39; returned &#39;Terraform execution
	  ...
    lastOperation:
      description: &#34;Failed to reconcile Shoot cluster state: Errors occurred during
        flow execution: &#39;(*Botanist).Shoot.Components.DNS.External{Provider/Entry}.Destroy&#39; returned &#39;Terraform
		...
      lastUpdateTime: 2018-06-03 09:48:00 +0100 IST
      progress: 100
      state: Failed
      type: Reconcile
</code></pre></div><h1 id=access-shoot-cluster>Access Shoot cluster</h1><p>The <code>gardenctl</code> tool provides a convenient wrapper to operate on both
cluster and cloud providers, here are some commands you can run</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback># select target shoot cluster
gardenctl ls gardens
gardenctl target garden dev
gardenctl ls projects
gardenctl target shoot johndoe-azure

# issue Azure client (az) commands on target shoot
gardenctl az aks list

# issue kubectl commands on target shoot
gardenctl kubectl -- version --short  # &#39;--&#39; is required if you want to
                                      # pass any args starting with &#39;-&#39;

# open prometheus, alertmanager, grafana without having to find
# the user/pass for each
gardenctl show prometheus
gardenctl show grafana
gardenctl show alertmanager
</code></pre></div><p>Easiest way to obtain <code>kubeconfig</code> of the shoot cluster:</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>$ gardenctl target shoot johndoe-azure
KUBECONFIG=/Users/user/.garden/cache/projects/garden-dev/johndoe-azure/kubeconfig.yaml
$ export KUBECONFIG=/Users/user/.garden/cache/projects/garden-dev/johndoe-azure/kubeconfig.yaml
$                        # From now on your local kubectl will be operating on target shoot
$ kubectl cluster-info   # will show your shoot cluster info
$ unset KUBECONFIG       # reset to your default kubectl
</code></pre></div><p>The shoot cluster&rsquo;s kubeconfig is being kept in a secret in the
project namespace:</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>kubectl -n shoot--dev--johndoe-azure get secret kubecfg -o jsonpath=&#39;{.data.kubeconfig}&#39; | base64 -D &gt; /tmp/johndoe-azure-kubeconfig.yaml
export KUBECONFIG=/tmp/johndoe-azure-kubeconfig.yaml
</code></pre></div><h1 id=delete-shoot-cluster>Delete Shoot cluster</h1><p>Deleting a Shoot cluster is not straight forward, and this is to
protect users from undesired/accidental cluster deletion. One has to
place some special annotations to get a Shoot cluster removed. We use
the <a href=https://raw.githubusercontent.com/gardener/gardener/master/docs/deployment/../../hack/usage/delete>hack/usage/delete</a> script for this purpose.</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>hack/delete shoot johndoe-azure garden-dev
</code></pre></div></div><div class=td-content style=page-break-before:always><h1 id=pg-43e3406b9b1753792534a5c41b26e7c4>7 - Environment</h1><h1 id=preparing-the-setup>Preparing the Setup</h1><p>Conceptually, all Gardener components are designated to run inside as a Pod inside a Kubernetes cluster.
The API server extends the Kubernetes API via the user-aggregated API server concepts.
However, if you want to develop it, you may want to work locally with the Gardener without building a Docker image and deploying it to a cluster each and every time.
That means that the Gardener runs outside a Kubernetes cluster which requires providing a <a href=https://kubernetes.io/docs/tasks/access-application-cluster/authenticate-across-clusters-kubeconfig/>Kubeconfig</a> in your local filesystem and point the Gardener to it when starting it (see below).</p><p>Further details could be found in</p><ol><li><a href=https://kubernetes.io/docs/concepts/>Principles of Kubernetes</a>, and its <a href=https://kubernetes.io/docs/concepts/overview/components/>components</a></li><li><a href=https://github.com/kubernetes/community/tree/master/contributors/devel>Kubernetes Development Guide</a></li><li><a href=https://github.com/gardener/documentation/wiki/Architecture.md>Architecture of Gardener</a></li></ol><p>This setup is based on <a href=https://github.com/kubernetes/minikube>minikube</a>, a Kubernetes cluster running on a single node. Docker for Desktop and <a href=https://github.com/kubernetes-sigs/kind>kind</a> are also supported.</p><h2 id=installing-golang-environment>Installing Golang environment</h2><p>Install latest version of Golang. For MacOS you could use <a href=https://brew.sh/>Homebrew</a>:</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>brew install golang
</code></pre></div><p>For other OS, please check <a href=https://golang.org/doc/install>Go installation documentation</a>.</p><h2 id=installing-kubectl-and-helm>Installing kubectl and helm</h2><p>As already mentioned in the introduction, the communication with the Gardener happens via the Kubernetes (Garden) cluster it is targeting. To interact with that cluster, you need to install <code>kubectl</code>. Please make sure that the version of <code>kubectl</code> is at least <code>v1.11.x</code>.</p><p>On MacOS run</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>brew install kubernetes-cli
</code></pre></div><p>Please check the <a href=https://kubernetes.io/docs/tasks/tools/install-kubectl/>kubectl installation documentation</a> for other OS.</p><p>You may also need to develop Helm charts or interact with Tiller using the <a href=https://github.com/kubernetes/helm>Helm</a> CLI:</p><p>On MacOS run</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>brew install kubernetes-helm
</code></pre></div><p>On other OS please check the <a href=https://github.com/helm/helm/blob/main/README.md#install>Helm installation documentation</a>.</p><h2 id=installing-git>Installing git</h2><p>We use <code>git</code> as VCS which you need to install.</p><p>On MacOS run</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>brew install git
</code></pre></div><p>On other OS, please check the <a href=https://git-scm.com/book/en/v2/Getting-Started-Installing-Git>Git installation documentation</a>.</p><h2 id=installing-openvpn>Installing openvpn</h2><p>We use <code>OpenVPN</code> to establish network connectivity from the control plane running in the Seed cluster to the Shoot&rsquo;s worker nodes running in private networks.
To harden the security we need to generate another secret to encrypt the network traffic (<a href=https://openvpn.net/index.php/open-source/documentation/howto.html#security>details</a>).
Please install the <code>openvpn</code> binary. On MacOS run</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>brew install openvpn
<span class=nb>export</span> <span class=nv>PATH</span><span class=o>=</span><span class=k>$(</span>brew --prefix openvpn<span class=k>)</span>/sbin:<span class=nv>$PATH</span>
</code></pre></div><p>On other OS, please check the <a href=https://openvpn.net/index.php/open-source/downloads.html>OpenVPN downloads page</a>.</p><h2 id=installing-minikube>Installing Minikube</h2><p>You&rsquo;ll need to have <a href=https://github.com/kubernetes/minikube#installation>minikube</a> installed and running.</p><blockquote><p>Note: Gardener is working only with self-contained kubeconfig files because of <a href=https://banzaicloud.com/blog/kubeconfig-security/>security issue</a>. You can configure your minikube to create self-contained kubeconfig files via:</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>minikube config <span class=nb>set</span> embed-certs <span class=nb>true</span>
</code></pre></div></blockquote><p>Alternatively, you can also install Docker for Desktop and <a href=https://github.com/kubernetes-sigs/kind>kind</a>.</p><p>In case you want to use the &ldquo;Docker for Mac Kubernetes&rdquo; or if you want to build Docker images for the Gardener you have to install Docker itself. On MacOS, please use <a href=https://docs.docker.com/docker-for-mac/>Docker for MacOS</a> which can be downloaded <a href=https://download.docker.com/mac/stable/Docker.dmg>here</a>.</p><p>On other OS, please check the <a href=https://docs.docker.com/install/>Docker installation documentation</a>.</p><h2 id=installing-iproute2>Installing iproute2</h2><p><code>iproute2</code> provides a collection of utilities for network administration and configuration.</p><p>On MacOS run</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>brew install iproute2mac
</code></pre></div><h2 id=installing-yaml2json-and-jq>Installing yaml2json and jq</h2><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>go get -u github.com/bronze1man/yaml2json
brew install jq
</code></pre></div><h2 id=macos-only-install-gnu-core-utilities>[MacOS only] Install GNU core utilities</h2><p>When running on MacOS you have to install the GNU core utilities:</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>brew install coreutils gnu-sed
</code></pre></div><p>This will create symbolic links for the GNU utilities with <code>g</code> prefix in <code>/usr/local/bin</code>, e.g., <code>gsed</code> or <code>gbase64</code>. To allow using them without the <code>g</code> prefix please put <code>/usr/local/opt/coreutils/libexec/gnubin</code> at the beginning of your <code>PATH</code> environment variable, e.g., <code>export PATH=/usr/local/opt/coreutils/libexec/gnubin:$PATH</code>.</p><h2 id=windows-wsl2>[Windows] WSL2</h2><p>Apart from Linux distributions and MacOS, the local gardener setup can also run on the Windows Subsystem for Linux 2.</p><p>While WSL1, plain docker for windows and various Linux distributions and local Kubernetes environments may be supported, this setup was verified with:</p><ul><li><a href=https://docs.microsoft.com/en-us/windows/wsl/wsl2-index>WSL2</a></li><li><a href=https://docs.docker.com/docker-for-windows/wsl/>Docker Desktop WSL2 Engine</a></li><li><a href=https://ubuntu.com/blog/ubuntu-on-wsl-2-is-generally-available>Ubuntu 18.04 LTS on WSL2</a></li><li>Nodeless local garden (see below)</li></ul><p>The Gardener repository and all the above-mentioned tools (git, golang, kubectl, &mldr;) should be installed in your WSL2 distro, according to the distribution-specific Linux installation instructions.</p><h2 id=optional-installing-gcloud-sdk>[Optional] Installing gcloud SDK</h2><p>In case you have to create a new release or a new hotfix of the Gardener you have to push the resulting Docker image into a Docker registry. Currently, we are using the Google Container Registry (this could change in the future). Please follow the official <a href=https://cloud.google.com/sdk/downloads>installation instructions from Google</a>.</p><h2 id=local-gardener-setup>Local Gardener setup</h2><p>This setup is only meant to be used for developing purposes, which means that only the control plane of the Gardener cluster is running on your machine.</p><h3 id=get-the-sources>Get the sources</h3><p>Clone the repository from GitHub.</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>git clone git@github.com:gardener/gardener.git
<span class=nb>cd</span> gardener
</code></pre></div><h3 id=start-the-gardener>Start the Gardener</h3><p>:warning: Before you start developing, please ensure to comply with the following requirements:</p><ol><li>You have understood the <a href=https://kubernetes.io/docs/concepts/>principles of Kubernetes</a>, and its <a href=https://kubernetes.io/docs/concepts/overview/components/>components</a>, what their purpose is and how they interact with each other.</li><li>You have understood the <a href=https://github.com/gardener/documentation/wiki/Architecture.md>architecture of Gardener</a>, and what the various clusters are used for.</li></ol><h4 id=start-a-local-kubernetes-cluster>Start a local kubernetes cluster</h4><p>For the development of Gardener you need some kind of Kubernetes cluster, which can be used as a &ldquo;garden&rdquo; cluster.
I.e. you need a Kubernetes API server on which you can register a <code>APIService</code> Gardener&rsquo;s own Extension API Server.<br>For this you can use a standard tool from the community to setup a local cluster like minikube, kind or the Kubernetes Cluster feature in Docker for Desktop.</p><p>However, if you develop and run Gardener&rsquo;s components locally, you don&rsquo;t actually a fully fledged Kubernetes Cluster,
i.e. you don&rsquo;t actually need to run Pods on it. If you want to use a more lightweight approach for development purposes,
you can use the &ldquo;nodeless Garden cluster setup&rdquo; residing in <code>hack/local-garden</code>. This is the easiest way to get your
Gardener development setup up and running.</p><p><strong>Using the nodeless cluster setup</strong></p><p>Setting up a local nodeless Garden cluster is quite simple. The only prerequisite is a running docker daemon.
Just use the provided Makefile rules to start your local Garden:</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>make local-garden-up
<span class=o>[</span>...<span class=o>]</span>
Starting gardener-dev kube-etcd cluster..!
Starting gardener-dev kube-apiserver..!
Starting gardener-dev kube-controller-manager..!
Starting gardener-dev gardener-etcd cluster..!
namespace/garden created
clusterrole.rbac.authorization.k8s.io/gardener.cloud:admin created
clusterrolebinding.rbac.authorization.k8s.io/front-proxy-client created
<span class=o>[</span>...<span class=o>]</span>
</code></pre></div><p>This will start all minimally required components of a Kubernetes cluster (<code>etcd</code>, <code>kube-apiserver</code>, <code>kube-controller-manager</code>)
and an <code>etcd</code> Instance for the <code>gardener-apiserver</code> as Docker containers.</p><p>To tear down the local Garden cluster and remove the Docker containers, simply run:</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>make local-garden-down
</code></pre></div><p><strong>Using minikube</strong></p><p>Alternatively, spin up a cluster with minikube with this command:</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>minikube start --embed-certs <span class=c1>#  `--embed-certs` can be omitted if minikube has already been set to create self-contained kubeconfig files.</span>
😄  minikube v1.8.2 on Darwin 10.15.3
🔥  Creating virtualbox VM <span class=o>(</span><span class=nv>CPUs</span><span class=o>=</span>2, <span class=nv>Memory</span><span class=o>=</span>2048MB, <span class=nv>Disk</span><span class=o>=</span>20000MB<span class=o>)</span> ...
<span class=o>[</span>...<span class=o>]</span>
🏄  Done! Thank you <span class=k>for</span> using minikube!
</code></pre></div><h4 id=prepare-the-gardener>Prepare the Gardener</h4><p>Now, that you have started your local cluster, we can go ahead and register the Gardener API Server.
Just point your <code>KUBECONFIG</code> environment variable to the local cluster you created in the previous step and run:</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>make dev-setup
Found Minikube ...
namespace/garden created
namespace/garden-dev created
deployment.apps/etcd created
service/etcd created
service/gardener-apiserver created
service/gardener-controller-manager created
endpoints/gardener-apiserver created
endpoints/gardener-controller-manager created
apiservice.apiregistration.k8s.io/v1alpha1.core.gardener.cloud created
apiservice.apiregistration.k8s.io/v1beta1.core.gardener.cloud created
validatingwebhookconfiguration.admissionregistration.k8s.io/gardener-controller-manager created
</code></pre></div><p>Optionally, you can switch off the <code>Logging</code> feature gate of Gardenlet to save resources:</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>sed -i -e <span class=s1>&#39;s/Logging: true/Logging: false/g&#39;</span> dev/20-componentconfig-gardenlet.yaml
</code></pre></div><p>The Gardener exposes the API servers of Shoot clusters via Kubernetes services of type <code>LoadBalancer</code>.
In order to establish stable endpoints (robust against changes of the load balancer address), it creates DNS records pointing to these load balancer addresses. They are used internally and by all cluster components to communicate.
You need to have control over a domain (or subdomain) for which these records will be created.
Please provide an <em>internal domain secret</em> (see <a href=https://raw.githubusercontent.com/gardener/gardener/master/docs/development/../../example/10-secret-internal-domain.yaml>this</a> for an example) which contains credentials with the proper privileges. Further information can be found <a href=https://raw.githubusercontent.com/gardener/gardener/master/docs/development/../usage/configuration.md>here</a>.</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>kubectl apply -f example/10-secret-internal-domain-unmanaged.yaml
secret/internal-domain-unmanaged created
</code></pre></div><h4 id=run-the-gardener>Run the Gardener</h4><p>Next, run the Gardener API Server, the Gardener Controller Manager (optionally), the Gardener Scheduler (optionally), and the Gardenlet in different terminal windows/panes using rules in the <code>Makefile</code>.</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>make start-apiserver
Found Minikube ...
I0306 15:23:51.044421   <span class=m>74536</span> plugins.go:84<span class=o>]</span> Registered admission plugin <span class=s2>&#34;ResourceReferenceManager&#34;</span>
I0306 15:23:51.044523   <span class=m>74536</span> plugins.go:84<span class=o>]</span> Registered admission plugin <span class=s2>&#34;DeletionConfirmation&#34;</span>
<span class=o>[</span>...<span class=o>]</span>
I0306 15:23:51.626836   <span class=m>74536</span> secure_serving.go:116<span class=o>]</span> Serving securely on <span class=o>[</span>::<span class=o>]</span>:8443
<span class=o>[</span>...<span class=o>]</span>
</code></pre></div><p>(Optional) Now you are ready to launch the Gardener Controller Manager.</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>make start-controller-manager
<span class=nv>time</span><span class=o>=</span><span class=s2>&#34;2019-03-06T15:24:17+02:00&#34;</span> <span class=nv>level</span><span class=o>=</span>info <span class=nv>msg</span><span class=o>=</span><span class=s2>&#34;Starting Gardener controller manager...&#34;</span>
<span class=nv>time</span><span class=o>=</span><span class=s2>&#34;2019-03-06T15:24:17+02:00&#34;</span> <span class=nv>level</span><span class=o>=</span>info <span class=nv>msg</span><span class=o>=</span><span class=s2>&#34;Feature Gates: &#34;</span>
<span class=nv>time</span><span class=o>=</span><span class=s2>&#34;2019-03-06T15:24:17+02:00&#34;</span> <span class=nv>level</span><span class=o>=</span>info <span class=nv>msg</span><span class=o>=</span><span class=s2>&#34;Starting HTTP server on 0.0.0.0:2718&#34;</span>
<span class=nv>time</span><span class=o>=</span><span class=s2>&#34;2019-03-06T15:24:17+02:00&#34;</span> <span class=nv>level</span><span class=o>=</span>info <span class=nv>msg</span><span class=o>=</span><span class=s2>&#34;Acquired leadership, starting controllers.&#34;</span>
<span class=nv>time</span><span class=o>=</span><span class=s2>&#34;2019-03-06T15:24:18+02:00&#34;</span> <span class=nv>level</span><span class=o>=</span>info <span class=nv>msg</span><span class=o>=</span><span class=s2>&#34;Starting HTTPS server on 0.0.0.0:2719&#34;</span>
<span class=nv>time</span><span class=o>=</span><span class=s2>&#34;2019-03-06T15:24:18+02:00&#34;</span> <span class=nv>level</span><span class=o>=</span>info <span class=nv>msg</span><span class=o>=</span><span class=s2>&#34;Found internal domain secret internal-domain-unmanaged for domain nip.io.&#34;</span>
<span class=nv>time</span><span class=o>=</span><span class=s2>&#34;2019-03-06T15:24:18+02:00&#34;</span> <span class=nv>level</span><span class=o>=</span>info <span class=nv>msg</span><span class=o>=</span><span class=s2>&#34;Successfully bootstrapped the Garden cluster.&#34;</span>
<span class=nv>time</span><span class=o>=</span><span class=s2>&#34;2019-03-06T15:24:18+02:00&#34;</span> <span class=nv>level</span><span class=o>=</span>info <span class=nv>msg</span><span class=o>=</span><span class=s2>&#34;Gardener controller manager (version 1.0.0-dev) initialized.&#34;</span>
<span class=nv>time</span><span class=o>=</span><span class=s2>&#34;2019-03-06T15:24:18+02:00&#34;</span> <span class=nv>level</span><span class=o>=</span>info <span class=nv>msg</span><span class=o>=</span><span class=s2>&#34;ControllerRegistration controller initialized.&#34;</span>
<span class=nv>time</span><span class=o>=</span><span class=s2>&#34;2019-03-06T15:24:18+02:00&#34;</span> <span class=nv>level</span><span class=o>=</span>info <span class=nv>msg</span><span class=o>=</span><span class=s2>&#34;SecretBinding controller initialized.&#34;</span>
<span class=nv>time</span><span class=o>=</span><span class=s2>&#34;2019-03-06T15:24:18+02:00&#34;</span> <span class=nv>level</span><span class=o>=</span>info <span class=nv>msg</span><span class=o>=</span><span class=s2>&#34;Project controller initialized.&#34;</span>
<span class=nv>time</span><span class=o>=</span><span class=s2>&#34;2019-03-06T15:24:18+02:00&#34;</span> <span class=nv>level</span><span class=o>=</span>info <span class=nv>msg</span><span class=o>=</span><span class=s2>&#34;Quota controller initialized.&#34;</span>
<span class=nv>time</span><span class=o>=</span><span class=s2>&#34;2019-03-06T15:24:18+02:00&#34;</span> <span class=nv>level</span><span class=o>=</span>info <span class=nv>msg</span><span class=o>=</span><span class=s2>&#34;CloudProfile controller initialized.&#34;</span>
<span class=o>[</span>...<span class=o>]</span>
</code></pre></div><p>(Optional) Now you are ready to launch the Gardener Scheduler.</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>make start-scheduler
<span class=nv>time</span><span class=o>=</span><span class=s2>&#34;2019-05-02T16:31:50+02:00&#34;</span> <span class=nv>level</span><span class=o>=</span>info <span class=nv>msg</span><span class=o>=</span><span class=s2>&#34;Starting Gardener scheduler ...&#34;</span>
<span class=nv>time</span><span class=o>=</span><span class=s2>&#34;2019-05-02T16:31:50+02:00&#34;</span> <span class=nv>level</span><span class=o>=</span>info <span class=nv>msg</span><span class=o>=</span><span class=s2>&#34;Starting HTTP server on 0.0.0.0:10251&#34;</span>
<span class=nv>time</span><span class=o>=</span><span class=s2>&#34;2019-05-02T16:31:50+02:00&#34;</span> <span class=nv>level</span><span class=o>=</span>info <span class=nv>msg</span><span class=o>=</span><span class=s2>&#34;Acquired leadership, starting scheduler.&#34;</span>
<span class=nv>time</span><span class=o>=</span><span class=s2>&#34;2019-05-02T16:31:50+02:00&#34;</span> <span class=nv>level</span><span class=o>=</span>info <span class=nv>msg</span><span class=o>=</span><span class=s2>&#34;Gardener scheduler initialized (with Strategy: SameRegion)&#34;</span>
<span class=nv>time</span><span class=o>=</span><span class=s2>&#34;2019-05-02T16:31:50+02:00&#34;</span> <span class=nv>level</span><span class=o>=</span>info <span class=nv>msg</span><span class=o>=</span><span class=s2>&#34;Scheduler controller initialized.&#34;</span>
<span class=o>[</span>...<span class=o>]</span>
</code></pre></div><p>(Optional) Now you are ready to launch the Gardenlet.</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>make start-gardenlet
<span class=nv>time</span><span class=o>=</span><span class=s2>&#34;2019-11-06T15:24:17+02:00&#34;</span> <span class=nv>level</span><span class=o>=</span>info <span class=nv>msg</span><span class=o>=</span><span class=s2>&#34;Starting Gardenlet...&#34;</span>
<span class=nv>time</span><span class=o>=</span><span class=s2>&#34;2019-11-06T15:24:17+02:00&#34;</span> <span class=nv>level</span><span class=o>=</span>info <span class=nv>msg</span><span class=o>=</span><span class=s2>&#34;Feature Gates: HVPA=true, Logging=true&#34;</span>
<span class=nv>time</span><span class=o>=</span><span class=s2>&#34;2019-11-06T15:24:17+02:00&#34;</span> <span class=nv>level</span><span class=o>=</span>info <span class=nv>msg</span><span class=o>=</span><span class=s2>&#34;Acquired leadership, starting controllers.&#34;</span>
<span class=nv>time</span><span class=o>=</span><span class=s2>&#34;2019-11-06T15:24:18+02:00&#34;</span> <span class=nv>level</span><span class=o>=</span>info <span class=nv>msg</span><span class=o>=</span><span class=s2>&#34;Found internal domain secret internal-domain-unmanaged for domain nip.io.&#34;</span>
<span class=nv>time</span><span class=o>=</span><span class=s2>&#34;2019-11-06T15:24:18+02:00&#34;</span> <span class=nv>level</span><span class=o>=</span>info <span class=nv>msg</span><span class=o>=</span><span class=s2>&#34;Gardenlet (version 1.0.0-dev) initialized.&#34;</span>
<span class=nv>time</span><span class=o>=</span><span class=s2>&#34;2019-11-06T15:24:18+02:00&#34;</span> <span class=nv>level</span><span class=o>=</span>info <span class=nv>msg</span><span class=o>=</span><span class=s2>&#34;ControllerInstallation controller initialized.&#34;</span>
<span class=nv>time</span><span class=o>=</span><span class=s2>&#34;2019-11-06T15:24:18+02:00&#34;</span> <span class=nv>level</span><span class=o>=</span>info <span class=nv>msg</span><span class=o>=</span><span class=s2>&#34;Shoot controller initialized.&#34;</span>
<span class=nv>time</span><span class=o>=</span><span class=s2>&#34;2019-11-06T15:24:18+02:00&#34;</span> <span class=nv>level</span><span class=o>=</span>info <span class=nv>msg</span><span class=o>=</span><span class=s2>&#34;Seed controller initialized.&#34;</span>
<span class=o>[</span>...<span class=o>]</span>
</code></pre></div><p>:warning: The Gardenlet will handle all your seeds for this development scenario, although, for productive usage it is recommended to run it once per seed, see <a href=https://raw.githubusercontent.com/gardener/gardener/master/docs/development/../concepts/gardenlet.md>this document</a> for more information.
See the <a href=#appendix>Appendix</a> on how to configure the Seed clusters for the local development scenario.</p><p>Please checkout the <a href=https://github.com/gardener/gem>Gardener Extensions Manager</a> to install extension controllers - make sure that you install all of them required for your local development.
Also, please refer to <a href=https://raw.githubusercontent.com/gardener/gardener/master/docs/development/../extensions/controllerregistration.md>this document</a> for further information about how extensions are registered in case you want to use other versions than the latest releases.</p><p>The Gardener should now be ready to operate on Shoot resources. You can use</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>kubectl get shoots
No resources found.
</code></pre></div><p>to operate against your local running Gardener API Server.</p><blockquote><p>Note: It may take several seconds until the <code>minikube</code> cluster recognizes that the Gardener API server has been started and is available. <code>No resources found</code> is the expected result of our initial development setup.</p></blockquote><h4 id=limitations-of-local-development-setup>Limitations of local development setup</h4><p>You can run Gardener (API server, controller manager, scheduler, gardenlet) against any local Kubernetes cluster, however, your seed and shoot clusters must be deployed to a &ldquo;real&rdquo; provider.
Currently, it is not possible to run Gardener entirely isolated from any cloud provider.
We are planning to support a setup that can run completely locally (see <a href=https://github.com/gardener/gardener-extension-provider-mock>this for details</a>), however, it does not yet exist.
This means that - after you have setup Gardener - you need to register an external seed cluster (e.g., one created in AWS).
Only after that step you can start creating shoot clusters with your locally running Gardener.</p><p>Some time ago, we had a local setup based on VirtualBox/Vagrant.
However, as we have progressed with the <a href=https://github.com/gardener/gardener/issues/308>Extensibility epic</a> we noticed that this implementation/setup does no longer fit into how we envision external providers to be.
Moreover, it hid too many things and came with a bunch of limitations, making the development scenario too &ldquo;artificial&rdquo;:</p><ul><li>No integration with machine-controller-manager.</li><li>The Shoot API Server is exposed via a NodePort. In a cloud setup a LoadBalancer would be used.</li><li>It was not possible to create Shoot clusters consisting of more than one worker node. Cluster auto-scaling therefore is not supported.</li><li>It was not possible to create two or more Shoot clusters in parallel.</li><li>The communication between the Seed and the Shoot Clusters uses VPN tunnel. In this setup tunnels are not needed since all components run on localhost.</li></ul><h2 id=additional-information>Additional information</h2><p>To make sure that a specific Seed cluster will be chosen, specify the <code>.spec.seedName</code> field (see <a href=https://raw.githubusercontent.com/gardener/gardener/master/docs/development/../../example/90-shoot.yaml#L265-L266>here</a> for an example Shoot manifest).</p><p>Please take a look at the <a href=https://github.com/gardener/gardener/tree/master/example>example manifests folder</a> to see which resource objects you need to install into your Garden cluster.</p><h1 id=appendix>Appendix</h1><h2 id=configure-seed-clusters-for-local-development>Configure Seed clusters for local development</h2><p>When using the Gardenlet in a local development scenario with <code>make start-gardenlet</code> then the Gardenlet component configuration is setup with a <a href=https://raw.githubusercontent.com/gardener/gardener/master/docs/development/../concepts/gardenlet.md#seed-config-vs-seed-selector>seed selector</a> that targets all available Seed clusters.
However, a <code>Seed</code> resource needs to be configured to allow being reconciled by a Gardenlet which such a configuration.</p><p>When deploying the Gardenlet to reconcile only one Seed cluster (using component configuration <code>.seedConfig</code>),
the Gardenlet either needs to be supplied with a kubeconfig for the particular Seed cluster, or acquires one via bootstrapping.
Having said that, if the Gardenlet is configured to manage multiple Seed clusters based on a label selector, it needs to fetch the kubeconfig of each Seed cluster at runtime from somewhere.
That is why the <code>Seed</code> resource needs to be configured with an additional secret reference that contains the kubeconfig of the Seed cluster.</p><p>Create a secret containing the base64 encoded kubeconfig of the Seed cluster (the scope of the permissions should be identical to the kubeconfig that the Gardenlet creates during bootstrapping - for now, <code>cluster-admin</code> privileges are recommended).</p><p>Create the secret in the Garden cluster:</p><div class=highlight><pre class=chroma><code class=language-yaml data-lang=yaml><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>v1</span><span class=w>
</span><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Secret</span><span class=w>
</span><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>sweet-seed</span><span class=w>
</span><span class=w>  </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class=l>garden</span><span class=w>
</span><span class=w></span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>Opaque</span><span class=w>
</span><span class=w></span><span class=nt>data</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=nt>kubeconfig</span><span class=p>:</span><span class=w> </span><span class=l>&lt;base64-seed-kubeconfig&gt;.</span><span class=w>
</span></code></pre></div><p>Adjust the <code>Seed</code> resource to reference the secret in <code>spec.secretRef</code> like so:</p><div class=highlight><pre class=chroma><code class=language-yaml data-lang=yaml><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>core.gardener.cloud/v1beta1</span><span class=w>
</span><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Seed</span><span class=w>
</span><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>my-sweet-seed</span><span class=w>
</span><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=l>...</span><span class=w>
</span><span class=w>  </span><span class=nt>secretRef</span><span class=p>:</span><span class=w>
</span><span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>sweet-seed</span><span class=w>
</span><span class=w>    </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class=l>garden</span><span class=w>
</span></code></pre></div></div><div class=td-content style=page-break-before:always><h1 id=pg-fea3359b8970eaa265cbbbf03ff478d1>8 - Process</h1><h1 id=creating-a-new-feature>Creating a new Feature</h1><p>If you want to contribute to the Gardener, please do that always on a dedicated branch on your own fork named after the purpose of the code changes, for example <code>feature/helm-integration</code>.
Please do not forget to rebase your branch <strong>regularly</strong>.</p><p>If you have finished your work, please create a pull request <strong>based on <code>master</code></strong>. It will be reviewed and merged if no further changes are requested from you.</p><p>:warning: Please ensure that your modifications pass the lint checks, formatting checks, static code checks, and unit tests by executing</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>make verify
</code></pre></div><p>Please do not file your pull request unless you receive a successful response from here!</p><h2 id=creating-a-new-release>Creating a new Release</h2><p>Please refer to the <a href=/docs/contribute/10_code/10-contribution_guide>Gardener contributor guide</a>.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-ac343e053acb7edc1709491284185e87>9 - Repositories</h1></div><div class=td-content style=page-break-before:always><h1 id=pg-c9f86aaf1f411cffebc6ff8babbb89cb>10 - Security Release Process</h1><h1 id=gardener-security-release-process>Gardener Security Release Process</h1><p>Gardener is a growing community of volunteers and users. The Gardener community has adopted this security disclosure and response policy to ensure we responsibly handle critical issues.</p><h2 id=gardener-security-team>Gardener Security Team</h2><p>Security vulnerabilities should be handled quickly and sometimes privately. The primary goal of this process is to reduce the total time users are vulnerable to publicly known exploits.
The Gardener Security Team is responsible for organizing the entire response including internal communication and external disclosure but will need help from relevant developers and release managers to successfully run this process. The initial Gardener Security Team will consist of the following volunteers:</p><ul><li>Olaf Beier, (<strong><a href=https://github.com/olafbeier>@olafbeier</a></strong>)</li><li>Vasu Chandrasekhara, (<strong><a href=https://github.com/vasu1124>@vasu1124</a></strong>)</li><li>Alban Crequy, (<strong><a href=https://github.com/alban>@alban</a></strong>)</li><li>Norbert Hamann, (<strong><a href=https://github.com/norberthamann>@norberthamann</a></strong>)</li><li>Claudia Hölters, (<strong><a href=https://github.com/hoeltcl>@hoeltcl</a></strong>)</li><li>Oliver Kling, (<strong><a href=https://github.com/oliverkling>@oliverkling</a></strong>)</li><li>Vedran Lerenc, (<strong><a href=https://github.com/vlerenc>@vlerenc</a></strong>)</li><li>Dirk Marwinski, (<strong><a href=https://github.com/marwinski>@marwinski</a></strong>)</li><li>Michael Schubert, (<strong><a href=https://github.com/schu>@schu</a></strong>)</li><li>Matthias Sohn, (<strong><a href=https://github.com/msohn>@msohn</a></strong>)</li><li>Frederik Thormaehlen, (<strong><a href=https://github.com/ThormaehlenFred>@ThormaehlenFred</a></strong>)</li><li>Christian Cwienk (<strong><a href=https://github.com/ccwienk>@ccwienk</a></strong>)</li></ul><h2 id=disclosures>Disclosures</h2><h3 id=private-disclosure-processes>Private Disclosure Processes</h3><p>The Gardener community asks that all suspected vulnerabilities be privately and responsibly disclosed. If you&rsquo;ve found a vulnerability or a potential vulnerability in Gardener please let us know by writing an e-mail to <a href=mailto:secure@sap.com>secure@sap.com</a>. We&rsquo;ll send a confirmation e-mail to acknowledge your report, and we&rsquo;ll send an additional e-mail when we&rsquo;ve identified the issue positively or negatively.</p><h3 id=public-disclosure-processes>Public Disclosure Processes</h3><p>If you know of a publicly disclosed vulnerability please IMMEDIATELY e-mail to <a href=mailto:secure@sap.com>secure@sap.com</a> to inform the Gardener Security Team about the vulnerability so they may start the patch, release, and communication process.</p><p>If possible the Gardener Security Team will ask the person making the public report if the issue can be handled via a <a href=#private-disclosure-process>private disclosure process</a> (for example if the full exploit details have not yet been published). If the reporter denies the request for private disclosure, the Gardener Security Team will move swiftly with the fix and release process. In extreme cases GitHub can be asked to delete the issue but this generally isn&rsquo;t necessary and is unlikely to make a public disclosure less damaging.</p><h2 id=patch-release-and-public-communication>Patch, Release, and Public Communication</h2><p>For each vulnerability a member of the Gardener Security Team will volunteer to lead coordination with the &ldquo;Fix Team&rdquo; and is responsible for sending disclosure e-mails to the rest of the community. This lead will be referred to as the &ldquo;Fix Lead.&rdquo; The role of the Fix Lead should rotate round-robin across the Gardener Security Team. Note that given the current size of the Gardener community it is likely that the Gardener Security Team is the same as the &ldquo;Fix team.&rdquo; (I.e., all maintainers). The Gardener Security Team may decide to bring in additional contributors for added expertise depending on the area of the code that contains the vulnerability. All of the time lines below are suggestions and assume a private disclosure. The Fix Lead drives the schedule using his best judgment based on severity and development time. If the Fix Lead is dealing with a public disclosure all time lines become ASAP (assuming the vulnerability has a CVSS score >= 7; see below). If the fix relies on another upstream project&rsquo;s disclosure time line, that will adjust the process as well. We will work with the upstream project to fit their time line and best protect our users.</p><h3 id=fix-team-organization>Fix Team Organization</h3><p>The Fix Lead will work quickly to identify relevant engineers from the affected projects and packages and CC those engineers into the disclosure thread. These selected developers are the Fix Team.
The Fix Lead will give the Fix Team access to a private security repository to develop the fix.</p><h3 id=fix-development-process>Fix Development Process</h3><p>The Fix Lead and the Fix Team will create a <a href=https://www.first.org/cvss/specification-document>CVSS</a> using the <a href=https://www.first.org/cvss/calculator/3.0>CVSS Calculator</a>. The Fix Lead makes the final call on the calculated CVSS; it is better to move quickly than make the CVSS perfect.
The Fix Team will notify the Fix Lead that work on the fix branch is complete once there are LGTMs on all commits in the private repository from one or more maintainers.
If the CVSS score is under 7.0 (a <a href=https://www.first.org/cvss/specification-document#i5>medium severity score</a>) the Fix Team can decide to slow the release process down in the face of holidays, developer bandwidth, etc. These decisions must be discussed on the private <a href=#communication-channel>Gardener Security mailing list</a>.</p><h3 id=fix-disclosure-process>Fix Disclosure Process</h3><p>With the fix development underway, the Fix Lead needs to come up with an overall communication plan for the wider community. This Disclosure process should begin after the Fix Team has developed a Fix or mitigation so that a realistic time line can be communicated to users. The Fix Lead will inform the <a href=#communication-channel>Gardener mailing list</a> that a security vulnerability has been disclosed and that a fix will be made available in the future on a certain release date. The Fix Lead will include any mitigating steps users can take until a fix is available. The communication to Gardener users should be actionable. They should know when to block time to apply patches, understand exact mitigation steps, etc.</p><h3 id=fix-release-day>Fix Release Day</h3><p>The Release Managers will ensure all the binaries are built, publicly available, and functional before the Release Date.
The Release Managers will create a new patch release branch from the latest patch release tag + the fix from the security branch. As a practical example if v0.12.0 is the latest patch release in gardener.git a new branch will be created called v0.12.1 which includes only patches required to fix the issue.
The Fix Lead will cherry-pick the patches onto the master branch and all relevant release branches. The Fix Team will <a href=https://github.com/lgtmco/lgtm>LGTM</a> and merge.
The Release Managers will merge these PRs as quickly as possible. Changes shouldn&rsquo;t be made to the commits even for a typo in the CHANGELOG as this will change the git sha of the already built and commits leading to confusion and potentially conflicts as the fix is cherry-picked around branches.
The Fix Lead will request a CVE from the SAP Product Security Response Team via email to <a href=mailto:cna@sap.com>cna@sap.com</a> with all the relevant information (description, potential impact, affected version, fixed version, CVSS v3 base score and supporting documentation for the CVSS score) for every vulnerability. The Fix Lead will inform the <a href=#communication-channel>Gardener mailing list</a> and announce the new releases, the CVE number (if available), the location of the binaries, and the relevant merged PRs to get wide distribution and user action.</p><p>As much as possible this e-mail should be actionable and include links how to apply the fix to users environments; this can include links to external distributor documentation. The recommended target time is 4pm UTC on a non-Friday weekday. This means the announcement will be seen morning Pacific, early evening Europe, and late evening Asia.
The Fix Lead will remove the Fix Team from the private security repository.</p><h3 id=retrospective>Retrospective</h3><p>These steps should be completed after the Release Date. The retrospective process <a href=https://landing.google.com/sre/book/chapters/postmortem-culture.html>should be blameless</a>.</p><p>The Fix Lead will send a retrospective of the process to the <a href=#communication-channel>Gardener mailing list</a> including details on everyone involved, the time line of the process, links to relevant PRs that introduced the issue, if relevant, and any critiques of the response and release process.
The Release Managers and Fix Team are also encouraged to send their own feedback on the process to the <a href=#communication-channel>Gardener mailing list</a>. Honest critique is the only way we are going to get good at this as a community.</p><h3 id=communication-channel>Communication Channel</h3><p>The <a href=#private-disclosure-process>private</a> or <a href=#public-disclosure-process>public disclosure process</a> should be triggered exclusively by writing an e-mail to <a href=mailto:secure@sap.com>secure@sap.com</a>.</p><p>Gardener security announcements will be communicated by the Fix Lead sending an e-mail to the <a href=https://groups.google.com/forum/#!forum/gardener>Gardener mailing list</a> (reachable via <a href=mailto:gardener@googlegroups.com>gardener@googlegroups.com</a>) as well as posting a link in the <a href=https://kubernetes.slack.com/messages/CB57N0BFG/details/>Gardener Slack channel</a>. Public discussions about Gardener security announcements and retrospectives, will primarily happen in the Gardener mailing list. Thus Gardener community members who are interested in participating in discussions related to the Gardener Security Release Process are encouraged to join the Gardener mailing list (<a href="https://support.google.com/groups/answer/1067205?hl=en">how to find and join a group</a>)</p><p>The members of the <a href=#gardener-security-team>Gardener Security Team</a> are subscribed to the private <a href=https://groups.google.com/forum/#!forum/gardener-security>Gardener Security mailing list</a> (reachable via <a href=mailto:gardener-security@googlegroups.com>gardener-security@googlegroups.com</a>).</p></div></main></div></div><footer class="footer row d-print-none"><div class="container-fluid footer-wrapper"><ul class=nav><li><a href=/blog/>Blogs</a></li><li><a href=/community/>Community</a></li><li><a href=/adopter/>Adopters</a></li><li><a href=/docs/>Documentation</a></li></ul><img src=/images/lp/gardener-logo.svg alt="Logo Gardener" class=logo><ul class=media-wr><li><a target=_blank href=https://kubernetes.slack.com/archives/CB57N0BFG><img src=/images/branding/slack-logo-white.svg class=media-icon><div class=media-text>Slack</div></a></li><li><a target=_blank href=https://github.com/gardener><img src=/images/branding/github-mark-logo.png class=media-icon><div class=media-text>GitHub</div></a></li><li><a target=_blank href=https://www.youtube.com/channel/UCwUhwKFREV8Su0gwAJQX7tw><img src=/images/branding/youtube-logo-dark.svg class=media-icon><div class=media-text>YouTube</div></a></li><li><a target=_blank href=https://twitter.com/GardenerProject><img src=/images/branding/twitter-logo-white.svg class=media-icon><div class=media-text>Twitter</div></a></li></ul><span class=copyright>Copyright 2019-2021 Gardener project authors. <a href=https://www.sap.com/corporate/en/legal/privacy.html>Privacy policy
<i class="fa fa-external-link" aria-hidden=true></i></a></span></div></footer></div><script src=https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js integrity=sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js integrity=sha384-+YQ4JLhjyBLPDQt//I+STsc9iw4uQqACwlvpslubQzn4u2UU2UFM80nGisd026JF crossorigin=anonymous></script><script src=/js/main.min.3b172c13b62c2bea8b1c9d2599cddc8cf89718a92d792c680871c81ba43d8c85.js integrity="sha256-OxcsE7YsK+qLHJ0lmc3cjPiXGKkteSxoCHHIG6Q9jIU=" crossorigin=anonymous></script></body></html>