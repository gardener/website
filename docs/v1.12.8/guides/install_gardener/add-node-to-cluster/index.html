<!doctype html><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Project Gardener Website - A Managed Kubernetes Service Done Right"><meta name=copyright content="Copyright 2019 Gardener project authors."><meta name=google-site-verification content="9EoGiMwk2aq0E_tVh16iJgJbp7fbyqkfWH9b5sGybl0"><title>Manually adding a node to an existing cluster :: Gardener</title><link rel=icon type=image/x-icon href=https://gardener.cloud/images/favicon.ico><link rel=icon type=image/png href=https://gardener.cloud/images/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=https://gardener.cloud/images/favicon-16x16.png sizes=16x16><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-W2FGNSX');</script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','UA-165447164-1');</script><link href=/css/nucleus.css?1612258026 rel=stylesheet><link href=/css/font-awesome.min.css?1612258026 rel=stylesheet><link href=/css/hybrid.css?1612258026 rel=stylesheet><link href=/css/featherlight.min.css?1612258026 rel=stylesheet><link href=/css/perfect-scrollbar.min.css?1612258026 rel=stylesheet><link href=/css/auto-complete.css?1612258026 rel=stylesheet><link href=/css/skeleton.css?1612258026 rel=stylesheet><link href=/css/sheetslider.css?1612258026 rel=stylesheet><link rel=stylesheet href=/css/gardener.e2ca9959244349715932e2bbb82ec914af6743c4148bb41946b0aea714f04a0d.css><script src=/js/moment.js?1612258026></script><script src=/js/vivus.js?1612258026></script><script src=/js/scrollreveal.js?1612258026></script><script src=/js/inlineSVG.js?1612258026></script><script src=/js/jquery.min.js?1612258026></script><script src=/js/fixed.js?1612258026></script><script src=/js/clipboard.min.js?1612258026></script><script src=https://platform.linkedin.com/in.js type=text/javascript>lang:en_US</script></head><body data-url=/v1.12.8/guides/install_gardener/add-node-to-cluster/ class=has-sticky-navigation><script>$(document).ready(function(){function initStickyNav(){var stickyPoint;var tln=document.querySelector(".tln");if(!tln){return;}
var stickyPointEl=document.querySelector(".sticky-nav-point");if(stickyPointEl==null){stickyPointEl=document.querySelector("body");stickyPoint=0;}else{stickyPoint=stickyPointEl.clientHeight+stickyPointEl.offsetTop;}
var bodySelector=document.getElementsByTagName("body")[0];var tlnHeight=tln.clientHeight;var stickyNavigation=function(){if(window.pageYOffset+tlnHeight>=stickyPoint){bodySelector.classList.add("has-sticky-navigation");tln.classList.add("sticky-top");}else{bodySelector.classList.remove("has-sticky-navigation");tln.classList.remove("sticky-top");}}
window.onscroll=function(){stickyNavigation();};}
initStickyNav();function closeAllSelect(){document.getElementById("docOptions").classList.remove("show");}
function show(e){e.stopPropagation();document.getElementById("docOptions").classList.add("show");}
document.addEventListener("click",closeAllSelect);document.getElementById("docSelector").addEventListener("click",show);});</script><div class="tln fixedsticky sticky-top"><header class=navigation><div class=container><div class=navigation-wrapper><a href=/ class=logo><img src=/images/logo.svg>
<span class=title>Gardener</span></a>
<a class="nav-button navbar-toggler" href=#><i class="fa fa-bars"></i></a><div class=navbar-collapse><ul class=links><li class=link><a href=/blog/>Blogs</a></li><li class=link><a href=/community/>Community</a></li><li class=link><a href=/adopter/>Adopters</a></li><li class="link has-child active"><a id=docSelector>Documentation v1.12.8</a><div id=docOptions class=doc-options><ul><li><a href=/documentation/guides/install_gardener/add-node-to-cluster/>Documentation
v1.14.0</a></li><li><a href=/v1.13.2/guides/install_gardener/add-node-to-cluster/>Documentation
v1.13.2</a></li><li><a href=/v1.12.8/home class=activeVersion>Documentation
v1.12.8</a></li></ul></div></li></ul></div></div></div></header></div><script>$(".navigation .navbar-toggler").click(function(evt){$(".navigation .navbar-collapse").toggle();$(".navigation").toggleClass("collapsed");$(".navigation .search-box").toggle();})</script><style>#docSelector{cursor:pointer}.doc-options{position:fixed;background-color:#0b8062;text-align:left;display:none}.doc-options ul li{margin-bottom:0}.doc-options ul li a:hover{background-color:#0c694f}.doc-options ul{list-style:none;padding:0;margin:0;text-align:left}.doc-options ul li a{padding:10px;margin:0}.doc-options .activeVersion{background-color:#ec682a}.show{display:block}</style><div class=sln><div class=overlay-band><ul class="nav-list container"><li title=Home><a class=navbar-link href=/v1.12.8/home/>Home</a></li><li title=Concepts><a class=navbar-link href=/v1.12.8/concepts/>Concepts</a></li><li title="How-To Guides"><a class="navbar-link is-active" href=/v1.12.8/guides/>How-To Guides</a></li><li title=Tutorials><a class=navbar-link href=/v1.12.8/tutorials/>Tutorials</a></li><li title="API Reference"><a class=navbar-link href=/v1.12.8/references/>API Reference</a></li><li title=Contribute><a class=navbar-link href=/v1.12.8/contribute/>Contribute</a></li></ul></div></div><div class="main container"><nav id=sidebar class="collapsed container menu"><div class=highlightable><ul class=topics><li data-nav-id=/v1.12.8/guides/ title="How-To Guides" class="dd-item parent root collapsible" data-depth=0><a href=/v1.12.8/guides/><span class=menu-item-text>How-To Guides</span></a><ul><li data-nav-id=/v1.12.8/guides/client_tools/ title="Set Up Client Tools" class="dd-item top-level collapsible collapsed" data-depth=1><a href=/v1.12.8/guides/client_tools/><span class="toggle fa fa-angle-right"></span><span class=menu-item-text>Set Up Client Tools</span></a><ul><li data-nav-id=/v1.12.8/guides/client_tools/oidc-login/ title="Authenticating with an Identity Provider" class=dd-item data-depth=2><a href=/v1.12.8/guides/client_tools/oidc-login/><span class=toggle></span><span class=menu-item-text>Authenticating with an Identity Provider</span></a></li><li data-nav-id=/v1.12.8/guides/client_tools/kubectl-apiserver/ title="Automated deployment" class=dd-item data-depth=2><a href=/v1.12.8/guides/client_tools/kubectl-apiserver/><span class=toggle></span><span class=menu-item-text>Automated deployment</span></a></li><li data-nav-id=/v1.12.8/guides/client_tools/bash_kubeconfig/ title="Kubeconfig context as bash prompt" class=dd-item data-depth=2><a href=/v1.12.8/guides/client_tools/bash_kubeconfig/><span class=toggle></span><span class=menu-item-text>Kubeconfig context as bash prompt</span></a></li><li data-nav-id=/v1.12.8/guides/client_tools/working-with-kubeconfig/ title="Organizing Access Using kubeconfig Files" class=dd-item data-depth=2><a href=/v1.12.8/guides/client_tools/working-with-kubeconfig/><span class=toggle></span><span class=menu-item-text>Organizing Access Using kubeconfig Files</span></a></li><li data-nav-id=/v1.12.8/guides/client_tools/helm/ title="Use a Helm chart to deploy some application or service" class=dd-item data-depth=2><a href=/v1.12.8/guides/client_tools/helm/><span class=toggle></span><span class=menu-item-text>Use a Helm chart to deploy some application or service</span></a></li></ul></li><li data-nav-id=/v1.12.8/guides/install_gardener/ title="Install Gardener" class="dd-item parent top-level collapsible" data-depth=1><a href=/v1.12.8/guides/install_gardener/><span class="toggle fa fa-angle-down"></span><span class=menu-item-text>Install Gardener</span></a><ul><li data-nav-id=/v1.12.8/guides/install_gardener/setup/ title="Gardener DNS Management for Shoots" class=dd-item data-depth=2><a href=/v1.12.8/guides/install_gardener/setup/><span class=toggle></span><span class=menu-item-text></span>Gardener DNS Management for Shoots</span></a></a></li><li data-nav-id=/v1.12.8/guides/install_gardener/secure-setup/ title="Hardening the Gardener Community Setup" class=dd-item data-depth=2><a href=/v1.12.8/guides/install_gardener/secure-setup/><span class=toggle></span><span class=menu-item-text>Hardening the Gardener Community Setup</span></a></li><li data-nav-id=/v1.12.8/guides/install_gardener/landscape-setup/ title="Landscape Setup" class=dd-item data-depth=2><a href=/v1.12.8/guides/install_gardener/landscape-setup/><span class=toggle></span><span class=menu-item-text>Landscape Setup</span></a></li><li data-nav-id=/v1.12.8/guides/install_gardener/add-node-to-cluster/ title="Manually adding a node to an existing cluster" class="dd-item parent active" data-depth=2><a href=/v1.12.8/guides/install_gardener/add-node-to-cluster/><span class=toggle></span><span class=menu-item-text>Manually adding a node to an existing cluster</span></a></li><li data-nav-id=/v1.12.8/guides/install_gardener/setup-seed/ title="Setting up a Seed Cluster" class=dd-item data-depth=2><a href=/v1.12.8/guides/install_gardener/setup-seed/><span class=toggle></span><span class=menu-item-text>Setting up a Seed Cluster</span></a></li></ul></li><li data-nav-id=/v1.12.8/guides/administer_shoots/ title="Administer Client (Shoot) Clusters" class="dd-item top-level collapsible collapsed" data-depth=1><a href=/v1.12.8/guides/administer_shoots/><span class="toggle fa fa-angle-right"></span><span class=menu-item-text>Administer Client (Shoot) Clusters</span></a><ul><li data-nav-id=/v1.12.8/guides/administer_shoots/hibernate-cluster/ title="Hibernate a Cluster" class=dd-item data-depth=2><a href=/v1.12.8/guides/administer_shoots/hibernate-cluster/><span class=toggle></span><span class=menu-item-text>Hibernate a Cluster</span></a></li><li data-nav-id=/v1.12.8/guides/administer_shoots/create-delete-shoot/ title="Create / Delete a Shoot cluster" class=dd-item data-depth=2><a href=/v1.12.8/guides/administer_shoots/create-delete-shoot/><span class=toggle></span><span class=menu-item-text>Create / Delete a Shoot cluster</span></a></li><li data-nav-id=/v1.12.8/guides/administer_shoots/gardener_aws/ title="Create a kubernetes cluster in AWS with Gardener" class=dd-item data-depth=2><a href=/v1.12.8/guides/administer_shoots/gardener_aws/><span class=toggle></span><span class=menu-item-text>Create a kubernetes cluster in AWS with Gardener</span></a></li><li data-nav-id=/v1.12.8/guides/administer_shoots/gardener_gcp/ title="Create a kubernetes cluster on GCP with Gardener" class=dd-item data-depth=2><a href=/v1.12.8/guides/administer_shoots/gardener_gcp/><span class=toggle></span><span class=menu-item-text>Create a kubernetes cluster on GCP with Gardener</span></a></li><li data-nav-id=/v1.12.8/guides/administer_shoots/create-shoot-into-existing-aws-vpc/ title="Create a Shoot cluster into existing AWS VPC" class=dd-item data-depth=2><a href=/v1.12.8/guides/administer_shoots/create-shoot-into-existing-aws-vpc/><span class=toggle></span><span class=menu-item-text>Create a Shoot cluster into existing AWS VPC</span></a></li><li data-nav-id=/v1.12.8/guides/administer_shoots/gardener-alibaba/ title="Create Shoot Clusters in Alibaba Cloud" class=dd-item data-depth=2><a href=/v1.12.8/guides/administer_shoots/gardener-alibaba/><span class=toggle></span><span class=menu-item-text>Create Shoot Clusters in Alibaba Cloud</span></a></li><li data-nav-id=/v1.12.8/guides/administer_shoots/dns_providers/ title="Manage DNS Providers" class=dd-item data-depth=2><a href=/v1.12.8/guides/administer_shoots/dns_providers/><span class=toggle></span><span class=menu-item-text></span>Manage DNS Providers</span></a></a></li><li data-nav-id=/v1.12.8/guides/administer_shoots/dns_names/ title="Request DNS Names" class=dd-item data-depth=2><a href=/v1.12.8/guides/administer_shoots/dns_names/><span class=toggle></span><span class=menu-item-text></span>Request DNS Names</span></a></a></li><li data-nav-id=/v1.12.8/guides/administer_shoots/request_cert/ title="Request X.509 Certificates" class=dd-item data-depth=2><a href=/v1.12.8/guides/administer_shoots/request_cert/><span class=toggle></span><span class=menu-item-text></span>Request X.509 Certificates</span></a></a></li><li data-nav-id=/v1.12.8/guides/administer_shoots/maintain-shoot/ title="Shoot Cluster Maintenance" class=dd-item data-depth=2><a href=/v1.12.8/guides/administer_shoots/maintain-shoot/><span class=toggle></span><span class=menu-item-text>Shoot Cluster Maintenance</span></a></li><li data-nav-id=/v1.12.8/guides/administer_shoots/trigger-shoot-operations/ title="Trigger Shoot operations" class=dd-item data-depth=2><a href=/v1.12.8/guides/administer_shoots/trigger-shoot-operations/><span class=toggle></span><span class=menu-item-text></span>Trigger Shoot operations</span></a></a></li><li data-nav-id=/v1.12.8/guides/administer_shoots/trigger-shoot-operations/ title="Trigger Shoot operations" class=dd-item data-depth=2><a href=/v1.12.8/guides/administer_shoots/trigger-shoot-operations/><span class=toggle></span><span class=menu-item-text>Trigger Shoot operations</span></a></li></ul></li><li data-nav-id=/v1.12.8/guides/monitoring_and_troubleshooting/ title="Monitor and Troubleshoot" class="dd-item top-level collapsible collapsed" data-depth=1><a href=/v1.12.8/guides/monitoring_and_troubleshooting/><span class="toggle fa fa-angle-right"></span><span class=menu-item-text>Monitor and Troubleshoot</span></a><ul><li data-nav-id=/v1.12.8/guides/monitoring_and_troubleshooting/shell-to-node/ title="Get a Shell to a Gardener Shoot Worker Node" class=dd-item data-depth=2><a href=/v1.12.8/guides/monitoring_and_troubleshooting/shell-to-node/><span class=toggle></span><span class=menu-item-text>Get a Shell to a Gardener Shoot Worker Node</span></a></li><li data-nav-id=/v1.12.8/guides/monitoring_and_troubleshooting/debug-a-pod/ title="How to debug a pod" class=dd-item data-depth=2><a href=/v1.12.8/guides/monitoring_and_troubleshooting/debug-a-pod/><span class=toggle></span><span class=menu-item-text>How to debug a pod</span></a></li><li data-nav-id=/v1.12.8/guides/monitoring_and_troubleshooting/tail-logfile/ title="tail -f /var/log/my-application.log" class=dd-item data-depth=2><a href=/v1.12.8/guides/monitoring_and_troubleshooting/tail-logfile/><span class=toggle></span><span class=menu-item-text>tail -f /var/log/my-application.log</span></a></li></ul></li><li data-nav-id=/v1.12.8/guides/applications/ title=Applications class="dd-item top-level collapsible collapsed" data-depth=1><a href=/v1.12.8/guides/applications/><span class="toggle fa fa-angle-right"></span><span class=menu-item-text>Applications</span></a><ul><li data-nav-id=/v1.12.8/guides/applications/access_pod_from_local/ title="Access a port of a pod locally" class=dd-item data-depth=2><a href=/v1.12.8/guides/applications/access_pod_from_local/><span class=toggle></span><span class=menu-item-text>Access a port of a pod locally</span></a></li><li data-nav-id=/v1.12.8/guides/applications/service-access/ title="Access service from outside Kubernetes cluster" class=dd-item data-depth=2><a href=/v1.12.8/guides/applications/service-access/><span class=toggle></span><span class=menu-item-text>Access service from outside Kubernetes cluster</span></a></li><li data-nav-id=/v1.12.8/guides/applications/insecure-configuration/ title="Auditing Kubernetes for Secure Setup" class=dd-item data-depth=2><a href=/v1.12.8/guides/applications/insecure-configuration/><span class=toggle></span><span class=menu-item-text>Auditing Kubernetes for Secure Setup</span></a></li><li data-nav-id=/v1.12.8/guides/applications/missing-registry-permission/ title="Container image not pulled" class=dd-item data-depth=2><a href=/v1.12.8/guides/applications/missing-registry-permission/><span class=toggle></span><span class=menu-item-text>Container image not pulled</span></a></li><li data-nav-id=/v1.12.8/guides/applications/image-pull-policy/ title="Container image not updating" class=dd-item data-depth=2><a href=/v1.12.8/guides/applications/image-pull-policy/><span class=toggle></span><span class=menu-item-text>Container image not updating</span></a></li><li data-nav-id=/v1.12.8/guides/applications/secure-seccomp/ title="Custom Seccomp profile" class=dd-item data-depth=2><a href=/v1.12.8/guides/applications/secure-seccomp/><span class=toggle></span><span class=menu-item-text>Custom Seccomp profile</span></a></li><li data-nav-id=/v1.12.8/guides/applications/dockerfile_pitfall/ title="Dockerfile pitfalls" class=dd-item data-depth=2><a href=/v1.12.8/guides/applications/dockerfile_pitfall/><span class=toggle></span><span class=menu-item-text>Dockerfile pitfalls</span></a></li><li data-nav-id=/v1.12.8/guides/applications/https/ title="HTTPS with self Signed Certificate" class=dd-item data-depth=2><a href=/v1.12.8/guides/applications/https/><span class=toggle></span><span class=menu-item-text></span>HTTPS with self Signed Certificate</span></a></a></li><li data-nav-id=/v1.12.8/guides/applications/https/ title="HTTPS with self Signed Certificate" class=dd-item data-depth=2><a href=/v1.12.8/guides/applications/https/><span class=toggle></span><span class=menu-item-text>HTTPS with self Signed Certificate</span></a></li><li data-nav-id=/v1.12.8/guides/applications/content_trust/ title="Integrity and Immutability" class=dd-item data-depth=2><a href=/v1.12.8/guides/applications/content_trust/><span class=toggle></span><span class=menu-item-text>Integrity and Immutability</span></a></li><li data-nav-id=/v1.12.8/guides/applications/antipattern/ title="Kubernetes Antipatterns" class=dd-item data-depth=2><a href=/v1.12.8/guides/applications/antipattern/><span class=toggle></span><span class=menu-item-text>Kubernetes Antipatterns</span></a></li><li data-nav-id=/v1.12.8/guides/applications/network-isolation/ title="Namespace Isolation" class=dd-item data-depth=2><a href=/v1.12.8/guides/applications/network-isolation/><span class=toggle></span><span class=menu-item-text>Namespace Isolation</span></a></li><li data-nav-id=/v1.12.8/guides/applications/container-startup/ title="Orchestration of container startup" class=dd-item data-depth=2><a href=/v1.12.8/guides/applications/container-startup/><span class=toggle></span><span class=menu-item-text>Orchestration of container startup</span></a></li><li data-nav-id=/v1.12.8/guides/applications/service-cache-control/ title="Out-Dated HTML and JS files delivered" class=dd-item data-depth=2><a href=/v1.12.8/guides/applications/service-cache-control/><span class=toggle></span><span class=menu-item-text>Out-Dated HTML and JS files delivered</span></a></li><li data-nav-id=/v1.12.8/guides/applications/commit_secret_fail/ title="Storing secrets in git ðŸ’€" class=dd-item data-depth=2><a href=/v1.12.8/guides/applications/commit_secret_fail/><span class=toggle></span><span class=menu-item-text>Storing secrets in git ðŸ’€</span></a></li><li data-nav-id=/v1.12.8/guides/applications/prometheus/ title="Using Prometheus and Grafana to monitor K8s" class=dd-item data-depth=2><a href=/v1.12.8/guides/applications/prometheus/><span class=toggle></span><span class=menu-item-text>Using Prometheus and Grafana to monitor K8s</span></a></li></ul></li><li data-nav-id=/v1.12.8/guides/gardener-cookies/ title="Gardener Cookies" class="dd-item top-level" data-depth=1><a href=/v1.12.8/guides/gardener-cookies/><span class=toggle></span><span class=menu-item-text>Gardener Cookies</span></a></li><li data-nav-id=/v1.12.8/guides/landscape-setup/ title="Landscape Setup" class="dd-item top-level" data-depth=1><a href=/v1.12.8/guides/landscape-setup/><span class=toggle></span><span class=menu-item-text></span>Landscape Setup</span></a></a></li></ul></li></ul></div></nav><a href=# class=menu-toggler><i class="fa fa-angle-double-left"></i></a><script>$(document).ready(function(){$("#sidebar .dd-item:not(.top-level):not(.parent)").hide();$("#sidebar .dd-item.parent").siblings(".dd-item").show();$('.dd-item',"#sidebar .dd-item.parent").show();$(".menu-toggler").click(function(evt){$("#sidebar").toggleClass("collapsed");$(".menu-toggler span").toggleClass("fa-angle-double-left");$(".menu-toggler span").toggleClass("fa-angle-double-right");});})</script><section><div class="highlightable body-inner-wrapper"><div id=body-inner><div class="docs page"><div class=git-wr><div class=page-contributors>Contributors to this page<div class=contributors-list></div></div><div class=page-edit><span class=last-update>Last update:
<span data-publishdate="2020-06-17 19:34:37"></span></span><div id=top-github-link><a class=github-link title="Edit this page" href=https://github.com/gardener/documentation/edit/master/website/v1.12.8/guides/install_gardener/add-node-to-cluster/_index.md target=blank><i class="fa fa-edit"></i><span id=top-github-link-text title="Edit this page"></span></a></div></div></div><h1>Manually adding a node to an existing cluster</h1><div class=properties><div class=expertise-level><span class=label title="Expertse level">Expertise</span><svg class="icon level" aria-hidden="true" focusable="false" title="advanced"><use xlink:href="/images/icons/icons.svg#level-3"/></svg></div></div><h1 id=manually-adding-a-node-to-an-existing-cluster>Manually adding a node to an existing cluster</h1><p>Gardener has an excellent ability to <a href=https://github.com/components/mcm/>automatically scale machines</a> for the cluster. From the point of view
of scalability, there is no need for manual intervention.</p><p>This tutorial is useful for those end-users who need specifically configured nodes, which are not yet supported
by Gardener. For example: an end-user who wants some workload that requires <code>runnc</code> instead of <code>runc</code> as container
runtime.</p><p><img src=../../../../../__resources/e9eb9acf-fbb4-4fdf-9f13-72b599bc4b30.svg alt=teaser></p><h2 id=disclaimer>Disclaimer</h2><blockquote><p>Here we will look at the steps on how to add a node to an existing cluster without the support of Gardener.
Such a node will not be managed by Gardener, and if it goes down for any reason, Gardener will not be
responsible to replace it.</p></blockquote><h2 id=how>How</h2><ol><li><p>Create a new instance in the same VPC/network as other machines in the cluster. You should be able to ssh into the machine. So save its private key, and assign a public IP to it. If adding a public IP is not preferred, then ssh into any other machine in the cluster, and then ssh from there into the new machine using its private key.</p><p>To ssh into a machine which is already in the cluster, use the steps defined <a href=../../../monitoring_and_troubleshooting/shell-to-node title=ssh-into-node>here</a>.</p><p>Attach the same IAM role to the new machine which is attached to the existing machines in the cluster. This is required by kubelet in the new machine so that it can contact the cloud provider to query the node&rsquo;s name.</p></li><li><p>On the new machine, create file <code>/var/lib/kubelet/kubeconfig-bootstrap</code> with the following content:</p></li></ol><div class=highlight><pre class=chroma><code class=language-yaml data-lang=yaml><span class=k>apiVersion</span><span class=p>:</span><span class=w> </span>v1<span class=w>
</span><span class=w></span><span class=k>kind</span><span class=p>:</span><span class=w> </span>Config<span class=w>
</span><span class=w></span><span class=k>current-context</span><span class=p>:</span><span class=w> </span>kubelet-bootstrap@default<span class=w>
</span><span class=w></span><span class=k>clusters</span><span class=p>:</span><span class=w>
</span><span class=w></span>- <span class=k>cluster</span><span class=p>:</span><span class=w>
</span><span class=w>    </span><span class=k>certificate-authority-data</span><span class=p>:</span><span class=w> </span>&lt;CA<span class=w> </span>Certificate<span class=sd>&gt;
</span><span class=sd>    server: &lt;Server&gt;</span><span class=w>
</span><span class=w>  </span><span class=k>name</span><span class=p>:</span><span class=w> </span>default<span class=w>
</span><span class=w></span><span class=k>contexts</span><span class=p>:</span><span class=w>
</span><span class=w></span>- <span class=k>context</span><span class=p>:</span><span class=w>
</span><span class=w>    </span><span class=k>cluster</span><span class=p>:</span><span class=w> </span>default<span class=w>
</span><span class=w>    </span><span class=k>user</span><span class=p>:</span><span class=w> </span>kubelet-bootstrap<span class=w>
</span><span class=w>  </span><span class=k>name</span><span class=p>:</span><span class=w> </span>kubelet-bootstrap@default<span class=w>
</span><span class=w></span><span class=k>users</span><span class=p>:</span><span class=w>
</span><span class=w></span>- <span class=k>name</span><span class=p>:</span><span class=w> </span>kubelet-bootstrap<span class=w>
</span><span class=w>  </span><span class=k>user</span><span class=p>:</span><span class=w>
</span><span class=w>    </span><span class=k>as-user-extra</span><span class=p>:</span><span class=w> </span>{}<span class=w>
</span><span class=w>    </span><span class=k>token</span><span class=p>:</span><span class=w> </span>&lt;Token&gt;<span class=w>
</span></code></pre></div><ol start=3><li>ssh into an existing node, and run these commands to get the values of <ca certificate>and <server>to be replaced in above file:</li></ol><ul><li>&lt;Servr></li></ul><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash> /opt/bin/hyperkube kubectl <span class=se>\
</span><span class=se></span>   --kubeconfig /var/lib/kubelet/kubeconfig-real <span class=se>\
</span><span class=se></span>   config view <span class=se>\
</span><span class=se></span>   -o go-template<span class=o>=</span><span class=s1>&#39;{{index .clusters 0 &#34;cluster&#34; &#34;server&#34;}}&#39;</span> <span class=se>\
</span><span class=se></span>   --raw
</code></pre></div><ul><li>&lt;CA Certificate></li></ul><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>/opt/bin/hyperkube kubectl <span class=se>\
</span><span class=se></span>   --kubeconfig /var/lib/kubelet/kubeconfig-real <span class=se>\
</span><span class=se></span>   config view <span class=se>\
</span><span class=se></span>   -o go-template<span class=o>=</span><span class=s1>&#39;{{index .clusters 0 &#34;cluster&#34; &#34;certificate-authority-data&#34;}}&#39;</span> <span class=se>\
</span><span class=se></span>   --raw
</code></pre></div><ol start=4><li><p>&lt;Token><br>The kubelet on the new machine needs a bootstrap token to authenticate with the kube-apiserver when adding itself to the cluster. Kube-apiserver uses a secret in the <code>kube-system</code> namespace to authenticate this token. This token is valid for 90 minutes from the time of creation, and the corresponding secret captures this detail in its <code>.data.expiration</code> field. The name of this secret is of the format <code>bootstrap-token-*</code>. Gardener takes care of creating new bootstrap tokens, and the corresponding secrets.
To get an unexpired token, find the secrets with the name format <code>bootstrap-token-*</code> in the <code>kube-system</code> namespace in the cluster, and pick the one with minimum age. Eg. <code>bootstrap-token-abcdef</code>.<br>Run these commands to get the token:</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash> <span class=nv>tokenid</span><span class=o>=</span><span class=k>$(</span>kubectl get secret bootstrap-token-abcdef -n kube-system -o go-template<span class=o>=</span><span class=s1>&#39;{{index .data &#34;token-id&#34;}}&#39;</span> <span class=p>|</span> base64 --decode<span class=k>)</span>

 <span class=nv>tokensecret</span><span class=o>=</span><span class=k>$(</span>kubectl get secret bootstrap-token-abcdef -n kube-system -o go-template<span class=o>=</span><span class=s1>&#39;{{index .data &#34;token-secret&#34;}}&#39;</span> <span class=p>|</span> base64 --decode<span class=k>)</span>

 <span class=nb>echo</span> <span class=nv>$tokenid</span>.<span class=nv>$tokensecret</span>
</code></pre></div><p>The value of $TOKEN will be <code>tokenid.tokensecret</code>. Replace $TOKEN in above file with this value</p></li><li><p>Copy contents of the files - <code>/var/lib/kubelet/config/kubelet</code>, <code>/var/lib/kubelet/ca.crt</code> and <code>/etc/systemd/system/kubelet.service</code> - from an existing node to the new node</p></li><li><p>Run the following command in the new node to start the kubelet:</p></li></ol><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>systemctl <span class=nb>enable</span> kubelet <span class=o>&amp;&amp;</span> systemctl start kubelet
</code></pre></div><p>The new node should be added to the existing cluster within a couple of minutes.</p></div></div></div><div class=howto_tickets><a href=https://github.com/gardener/documentation/issues/new/choose target=_blank><span>Let us know how can we improve.</span>
<span>Open <img src=https://gardener.cloud/images/branding/github-mark-logo-green.svg> GitHub Issue <i class="fa fa-external-link" aria-hidden=true></i></span></a></div></section></div><style></style><footer class=footer><div class="container footer-wrapper"><ul class=nav><li><a href=/blog/>Blogs</a></li><li><a href=/community/>Community</a></li><li><a href=/adopter/>Adopters</a></li><li><a href=/documentation/home>Documentation</a></li></ul><img src=/images/lp/gardener-logo.svg alt="Logo Gardener" class=logo><ul class=media-wr><li><a target=_blank href=https://kubernetes.slack.com/archives/CB57N0BFG><img src=/images/branding/slack-logo-white.svg class=media-icon><div class=media-text>Slack</div></a></li><li><a target=_blank href=https://github.com/gardener><img src=/images/branding/github-mark-logo.png class=media-icon><div class=media-text>GitHub</div></a></li><li><a target=_blank href=https://www.youtube.com/channel/UCwUhwKFREV8Su0gwAJQX7tw><img src=/images/branding/youtube-logo-dark.svg class=media-icon><div class=media-text>YouTube</div></a></li><li><a target=_blank href=https://twitter.com/GardenerProject><img src=/images/branding/twitter-logo-white.svg class=media-icon><div class=media-text>Twitter</div></a></li></ul><span class=copyright>Copyright 2020 Gardener project authors. Privacy Statement</span></div></footer><script src=/js/perfect-scrollbar.min.js?1612258026></script><script src=/js/perfect-scrollbar.jquery.min.js?1612258026></script><script src=/js/jquery.sticky.js?1612258026></script><script src=/js/featherlight.min.js?1612258026></script><script src=/js/html5shiv-printshiv.min.js?1612258026></script><script src=/js/modernizr.custom.71422.js?1612258026></script><link href=/mermaid/mermaid.css?1612258026 type=text/css rel=stylesheet><script src=/mermaid/mermaid.js?1612258026></script><script src=/js/code-snippets.js?1612258026></script><script>mermaid.initialize({startOnLoad:true,htmlLables:true});function createIssue(issueUrl,page,url){var uri=issueUrl+"?title=Documentation issue on page \""+page+"\"";uri=uri+"&body=\n\n<- DESCRIBE MISSING OR FAULTY DOCUMENTATION HERE->\n\n---\nPage: ["+page+"]("+
url+")\ndon't remove the link to the page. It's required for the processor"
var res=encodeURI(uri);res+="&labels=area/documentation"
window.open(res,"issue")
return false;}
$(document).ready(function(){inlineSVG.init();$("[data-publishdate]").each(function(){$(this).text(moment($(this,"YYYY-MM-DD","YYYY-MM-DD hh:mm:ss").attr("data-publishdate")).fromNow());});new ClipboardJS('.clipboard-copy');$("body").codeSnippets();});</script><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-W2FGNSX" height=0 width=0 style=display:none;visibility:hidden></iframe></noscript></body></html>