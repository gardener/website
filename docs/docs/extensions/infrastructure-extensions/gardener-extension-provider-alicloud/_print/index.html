<!doctype html><html lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.83.1"><link rel=canonical type=text/html href=https://gardener.cloud/docs/extensions/infrastructure-extensions/gardener-extension-provider-alicloud/><link rel=alternate type=application/rss+xml href=https://gardener.cloud/docs/extensions/infrastructure-extensions/gardener-extension-provider-alicloud/index.xml><meta name=ROBOTS content="NOINDEX, NOFOLLOW"><link rel=icon type=image/x-icon href=https://gardener.cloud/images/favicon.ico><link rel=icon type=image/png href=https://gardener.cloud/images/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=https://gardener.cloud/images/favicon-16x16.png sizes=16x16><title>Provider Alicloud | Gardener</title><meta name=description content="Project Gardener Website - A Managed Kubernetes Service Done Right"><meta property="og:title" content="Provider Alicloud"><meta property="og:description" content="Gardener extension controller for the Alibaba cloud provider"><meta property="og:type" content="website"><meta property="og:url" content="https://gardener.cloud/docs/extensions/infrastructure-extensions/gardener-extension-provider-alicloud/"><meta itemprop=name content="Provider Alicloud"><meta itemprop=description content="Gardener extension controller for the Alibaba cloud provider"><meta name=twitter:card content="summary"><meta name=twitter:title content="Provider Alicloud"><meta name=twitter:description content="Gardener extension controller for the Alibaba cloud provider"><link rel=preload href=/scss/main.min.122f9effc36493edf1f25030c2ce7965b16b3b0eaeb02528b9a50e0fa9110c15.css as=style><link href=/scss/main.min.122f9effc36493edf1f25030c2ce7965b16b3b0eaeb02528b9a50e0fa9110c15.css rel=stylesheet integrity><script src=https://code.jquery.com/jquery-3.5.1.min.js integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin=anonymous></script><script src=https://unpkg.com/lunr@2.3.8/lunr.min.js integrity=sha384-vRQ9bDyE0Wnu+lMfm57BlYLO0/XauFuKpVsZPs7KEDwYKktWi5+Kz3MP8++DFlRY crossorigin=anonymous></script></head><body class=td-section><header><nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar"><a class=navbar-brand href=/><span class=navbar-logo><svg width="90" height="90" viewBox="0 0 90 90" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>logo</title><desc>Created with Sketch.</desc><defs><path d="M41.8864954.994901575c.996545099999999-.479910833 2.6164002-.477918931 3.6088091.0L76.8159138 16.0781121C77.8124589 16.5580229 78.8208647 17.8257185 79.0659694 18.8995926l7.7355517 33.8916663C87.0476474 53.8696088 86.6852538 55.4484075 85.9984855 56.3095876L64.3239514 83.4885938C63.6343208 84.3533632 62.1740175 85.0543973 61.0725268 85.0543973H26.3092731c-1.1060816.0-2.5646564-.704623400000003-3.2514246-1.5658035L1.38331434 56.3095876C.693683723 55.4448182.335174016 53.865133.580278769 52.7912589L8.31583044 18.8995926C8.56195675 17.8212428 9.57347722 16.556031 10.5658861 16.0781121L41.8864954.994901575z" id="path-1"/><linearGradient x1="12.7542673%" y1="-18.6617048%" x2="88.2666158%" y2="84.6075483%" id="linearGradient-3"><stop stop-color="#fff" offset="0"/><stop stop-color="#439246" offset="100%"/></linearGradient><linearGradient x1="50%" y1="4.93673768%" x2="148.756007%" y2="175.514523%" id="linearGradient-4"><stop stop-color="#fff" offset="0"/><stop stop-color="#439246" offset="100%"/></linearGradient><linearGradient x1="19.1574381%" y1="-9.04800713%" x2="82.2203149%" y2="77.9084293%" id="linearGradient-5"><stop stop-color="#fff" offset="0"/><stop stop-color="#439246" offset="100%"/></linearGradient><linearGradient x1="57.4403751%" y1="26.3148481%" x2="137.966711%" y2="158.080556%" id="linearGradient-6"><stop stop-color="#fff" offset="0"/><stop stop-color="#439246" offset="100%"/></linearGradient></defs><g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="logo"><g id="Rectangle-2" transform="translate(1.000000, 0.000000)"><mask id="mask-2" fill="#fff"><use xlink:href="#path-1"/></mask><use id="Mask" fill="#009f76" xlink:href="#path-1"/><polygon fill="#000" opacity=".289628623" mask="url(#mask-2)" points="-17.6484375 54.5224609 30.8242188 25.0791016 63.4726562 58.5 24.7324219 92.6689453"/></g><path d="M56.8508631 39.260019C56.4193519 40.443987 55.6088085 41.581593 54.6736295 42.1938694l-8.0738997 5.2861089c-1.3854671.907087099999998-3.6247515.9116711-5.0172201.0L33.50861 42.1938694C32.123143 41.2867823 31 39.206345 31 37.545932V26.4150304c0-.725313.2131118-1.5301454.569268099999999-2.2825772L56.8508631 39.260019z" id="Combined-Shape" fill="url(#linearGradient-3)" transform="translate(43.925432, 36.147233) scale(-1, 1) translate(-43.925432, -36.147233)"/><path d="M56.0774672 25.1412464C56.4306829 25.8903325 56.6425556 26.6907345 56.6425556 27.4119019V38.5428034c0 1.6598979-1.1161415 3.73626640000001-2.50861 4.6479374l-8.0738997 5.286109c-1.3854671.907087000000004-3.6247516.911671000000005-5.0172201.0L32.9689261 43.1907408C32.2918101 42.7474223 31.6773514 42.0238435 31.2260376 41.206007L56.0774672 25.1412464z" id="Combined-Shape" fill="url(#linearGradient-4)" transform="translate(43.821278, 37.246598) scale(-1, 1) translate(-43.821278, -37.246598)"/><path d="M65.0702134 57.1846889C64.5985426 58.2007851 63.8367404 59.1236871 62.9788591 59.6189851L47.37497 68.6278947c-1.4306165.825966800000003-3.75236779999999.8246599-5.1807206.0L26.5903603 59.6189851C25.1597438 58.7930183 24 56.7816693 24 55.1323495V37.1145303C24 36.3487436 24.249712 35.5060005 24.6599102 34.7400631L65.0702134 57.1846889z" id="Combined-Shape" fill="url(#linearGradient-5)"/><path d="M65.0189476 34.954538C65.3636909 35.6617313 65.5692194 36.42021 65.5692194 37.1145303V55.1323495C65.5692194 56.7842831 64.4072119 58.7943252 62.9788591 59.6189851L47.37497 68.6278947c-1.4306165.825966800000003-3.75236779999999.8246599-5.1807206.0L26.5903603 59.6189851C25.9237304 59.2341061 25.3159155 58.5918431 24.8568495 57.8487596L65.0189476 34.954538z" id="Combined-Shape" fill="url(#linearGradient-6)"/></g></g></svg></span><span class=text-capitalize>Gardener</span></a><div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar><ul class="navbar-nav mt-2 mt-lg-0"><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/adopter><span>Adopters</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/blog><span>Blogs</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/community><span>Community</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/docs><span>Documentation</span></a></li></ul></div><div class="navbar-nav d-none d-lg-block"><input type=search class="form-control td-search-input" placeholder="&#xf002; Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=/offline-search-index.7f48cd625ca1be294f7b700cb4f0ff4a.json data-offline-search-base-href=/ data-offline-search-max-results=10></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><div class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"></div><div class="d-none d-xl-block col-xl-2 td-toc d-print-none"></div><main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main><div class=td-content><div class="pageinfo pageinfo-primary d-print-none"><p>This the multi-page printable view of this section.
<a href=# onclick="return print(),!1">Click here to print</a>.</p><p><a href=/docs/extensions/infrastructure-extensions/gardener-extension-provider-alicloud/>Return to the regular view of this page</a>.</p></div><h1 class=title>Provider Alicloud</h1><div class=lead>Gardener extension controller for the Alibaba cloud provider</div><div class=content><h1 id=gardener-extension-for-alicloud-providerhttpsgardenercloud><a href=https://gardener.cloud>Gardener Extension for Alicloud provider</a></h1><p><a href=https://concourse.ci.gardener.cloud/teams/gardener/pipelines/gardener-extension-provider-alicloud-master/jobs/master-head-update-job><img src=https://concourse.ci.gardener.cloud/api/v1/teams/gardener/pipelines/gardener-extension-provider-alicloud-master/jobs/master-head-update-job/badge alt="CI Build status"></a>
<a href=https://goreportcard.com/report/github.com/gardener/gardener-extension-provider-alicloud><img src=https://goreportcard.com/badge/github.com/gardener/gardener-extension-provider-alicloud alt="Go Report Card"></a></p><p>Project Gardener implements the automated management and operation of <a href=https://kubernetes.io/>Kubernetes</a> clusters as a service.
Its main principle is to leverage Kubernetes concepts for all of its tasks.</p><p>Recently, most of the vendor specific logic has been developed <a href=https://github.com/gardener/gardener>in-tree</a>.
However, the project has grown to a size where it is very hard to extend, maintain, and test.
With <a href=/docs/gardener/proposals/01-extensibility>GEP-1</a> we have proposed how the architecture can be changed in a way to support external controllers that contain their very own vendor specifics.
This way, we can keep Gardener core clean and independent.</p><p>This controller implements Gardener&rsquo;s extension contract for the Alicloud provider.</p><p>An example for a <code>ControllerRegistration</code> resource that can be used to register this controller to Gardener can be found <a href=https://github.com/gardener/gardener-extension-provider-alicloud/blob/master/example/controller-registration.yaml>here</a>.</p><p>Please find more information regarding the extensibility concepts and a detailed proposal <a href=/docs/gardener/proposals/01-extensibility>here</a>.</p><h2 id=supported-kubernetes-versions>Supported Kubernetes versions</h2><p>This extension controller supports the following Kubernetes versions:</p><table><thead><tr><th>Version</th><th>Support</th><th>Conformance test results</th></tr></thead><tbody><tr><td>Kubernetes 1.22</td><td>1.22.0+</td><td><a href=https://testgrid.k8s.io/conformance-gardener#Gardener,%20v1.22%20Alibaba%20Cloud><img src="https://testgrid.k8s.io/q/summary/conformance-gardener/Gardener,%20v1.22%20Alibaba%20Cloud/tests_status?style=svg" alt="Gardener v1.22 Conformance Tests"></a></td></tr><tr><td>Kubernetes 1.21</td><td>1.21.0+</td><td><a href=https://testgrid.k8s.io/conformance-gardener#Gardener,%20v1.21%20Alibaba%20Cloud><img src="https://testgrid.k8s.io/q/summary/conformance-gardener/Gardener,%20v1.21%20Alibaba%20Cloud/tests_status?style=svg" alt="Gardener v1.21 Conformance Tests"></a></td></tr><tr><td>Kubernetes 1.20</td><td>1.20.0+</td><td><a href=https://testgrid.k8s.io/conformance-gardener#Gardener,%20v1.20%20Alibaba%20Cloud><img src="https://testgrid.k8s.io/q/summary/conformance-gardener/Gardener,%20v1.20%20Alibaba%20Cloud/tests_status?style=svg" alt="Gardener v1.20 Conformance Tests"></a></td></tr><tr><td>Kubernetes 1.19</td><td>1.19.0+</td><td><a href=https://testgrid.k8s.io/conformance-gardener#Gardener,%20v1.19%20Alibaba%20Cloud><img src="https://testgrid.k8s.io/q/summary/conformance-gardener/Gardener,%20v1.19%20Alibaba%20Cloud/tests_status?style=svg" alt="Gardener v1.19 Conformance Tests"></a></td></tr><tr><td>Kubernetes 1.18</td><td>1.18.0+</td><td><a href=https://testgrid.k8s.io/conformance-gardener#Gardener,%20v1.18%20Alibaba%20Cloud><img src="https://testgrid.k8s.io/q/summary/conformance-gardener/Gardener,%20v1.18%20Alibaba%20Cloud/tests_status?style=svg" alt="Gardener v1.18 Conformance Tests"></a></td></tr><tr><td>Kubernetes 1.17</td><td>1.17.0+</td><td><a href=https://testgrid.k8s.io/conformance-gardener#Gardener,%20v1.17%20Alibaba%20Cloud><img src="https://testgrid.k8s.io/q/summary/conformance-gardener/Gardener,%20v1.17%20Alibaba%20Cloud/tests_status?style=svg" alt="Gardener v1.17 Conformance Tests"></a></td></tr><tr><td>Kubernetes 1.16</td><td>1.16.0+</td><td><a href=https://testgrid.k8s.io/conformance-gardener#Gardener,%20v1.16%20Alibaba%20Cloud><img src="https://testgrid.k8s.io/q/summary/conformance-gardener/Gardener,%20v1.16%20Alibaba%20Cloud/tests_status?style=svg" alt="Gardener v1.16 Conformance Tests"></a></td></tr><tr><td>Kubernetes 1.15</td><td>1.15.0+</td><td>[1]</td></tr></tbody></table><p>[1] Conformance tests are still executed and validated, unfortunately <a href=https://github.com/kubernetes/test-infra/pull/18509#issuecomment-668204180>no longer shown in TestGrid</a>.</p><p>Please take a look <a href=/docs/gardener/usage/supported_k8s_versions>here</a> to see which versions are supported by Gardener in general.</p><hr><h2 id=how-to-start-using-or-developing-this-extension-controller-locally>How to start using or developing this extension controller locally</h2><p>You can run the controller locally on your machine by executing <code>make start</code>.</p><p>Static code checks and tests can be executed by running <code>make verify</code>. We are using Go modules for Golang package dependency management and <a href=https://github.com/onsi/ginkgo>Ginkgo</a>/<a href=https://github.com/onsi/gomega>Gomega</a> for testing.</p><h2 id=feedback-and-support>Feedback and Support</h2><p>Feedback and contributions are always welcome. Please report bugs or suggestions as <a href=https://github.com/gardener/gardener-extension-provider-alicloud/issues>GitHub issues</a> or join our <a href=https://kubernetes.slack.com/messages/gardener>Slack channel #gardener</a> (please invite yourself to the Kubernetes workspace <a href=http://slack.k8s.io>here</a>).</p><h2 id=learn-more>Learn more!</h2><p>Please find further resources about out project here:</p><ul><li><a href=https://gardener.cloud/>Our landing page gardener.cloud</a></li><li><a href=https://kubernetes.io/blog/2018/05/17/gardener/>&ldquo;Gardener, the Kubernetes Botanist&rdquo; blog on kubernetes.io</a></li><li><a href=https://kubernetes.io/blog/2019/12/02/gardener-project-update/>&ldquo;Gardener Project Update&rdquo; blog on kubernetes.io</a></li><li><a href=/docs/gardener/proposals/01-extensibility>GEP-1 (Gardener Enhancement Proposal) on extensibility</a></li><li><a href=/docs/gardener/proposals/04-new-core-gardener-cloud-apis>GEP-4 (New <code>core.gardener.cloud/v1alpha1</code> API)</a></li><li><a href=https://github.com/gardener/gardener/tree/master/docs/extensions>Extensibility API documentation</a></li><li><a href=https://godoc.org/github.com/gardener/gardener/extensions/pkg>Gardener Extensions Golang library</a></li><li><a href=https://gardener.cloud/api-reference/>Gardener API Reference</a></li></ul></div></div><div class=td-content style=page-break-before:always><h1 id=pg-07e59d41316d9bf3e092041d57e8dcfc>1 - Local Setup</h1><h3 id=admission-alicloud>admission-alicloud</h3><p><code>admission-alicloud</code> is an admission webhook server which is responsible for the validation of the cloud provider (Alicloud in this case) specific fields and resources. The Gardener API server is cloud provider agnostic and it wouldn&rsquo;t be able to perform similar validation.</p><p>Follow the steps below to run the admission webhook server locally.</p><ol><li><p>Start the Gardener API server.</p><p>For details, check the Gardener <a href=/docs/gardener/development/local_setup>local setup</a>.</p></li><li><p>Start the webhook server</p><p>Make sure that the <code>KUBECONFIG</code> environment variable is pointing to the local garden cluster.</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>make start-admission
</code></pre></div></li><li><p>Setup the <code>ValidatingWebhookConfiguration</code>.</p><p><code>hack/dev-setup-admission-alicloud.sh</code> will configure the webhook Service which will allow the kube-apiserver of your local cluster to reach the webhook server. It will also apply the <code>ValidatingWebhookConfiguration</code> manifest.</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>./hack/dev-setup-admission-alicloud.sh
</code></pre></div></li></ol><p>You are now ready to experiment with the <code>admission-alicloud</code> webhook server locally.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-bb31b8fd625e8e321607849b37068ed6>2 - Usage As End User</h1><h1 id=using-the-alicloud-provider-extension-with-gardener-as-end-user>Using the Alicloud provider extension with Gardener as end-user</h1><p>The <a href=https://github.com/gardener/gardener/blob/master/example/90-shoot.yaml><code>core.gardener.cloud/v1beta1.Shoot</code> resource</a> declares a few fields that are meant to contain provider-specific configuration.</p><p>This document describes the configurable options for Alicloud and provides an example <code>Shoot</code> manifest with minimal configuration that can be used to create an Alicloud cluster (modulo the landscape-specific information like cloud profile names, secret binding names, etc.).</p><h2 id=alicloud-provider-credentials>Alicloud Provider Credentials</h2><p>In order for Gardener to create a Kubernetes cluster using Alicloud infrastructure components, a Shoot has to provide credentials with sufficient permissions to the desired Alicloud project.
Every shoot cluster references a <code>SecretBinding</code> which itself references a <code>Secret</code>, and this <code>Secret</code> contains the provider credentials of the Alicloud project.</p><p>This <code>Secret</code> must look as follows:</p><div class=highlight><pre class=chroma><code class=language-yaml data-lang=yaml><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>v1</span><span class=w>
</span><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Secret</span><span class=w>
</span><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>core-alicloud</span><span class=w>
</span><span class=w>  </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class=l>garden-dev</span><span class=w>
</span><span class=w></span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>Opaque</span><span class=w>
</span><span class=w></span><span class=nt>data</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=nt>accessKeyID</span><span class=p>:</span><span class=w> </span><span class=l>base64(access-key-id)</span><span class=w>
</span><span class=w>  </span><span class=nt>accessKeySecret</span><span class=p>:</span><span class=w> </span><span class=l>base64(access-key-secret)</span><span class=w>
</span></code></pre></div><p>The <code>SecretBinding</code> is configurable in the <a href=https://github.com/gardener/gardener/blob/master/example/90-shoot.yaml>Shoot cluster</a> with the field <code>secretBindingName</code>.</p><p>The required credentials for the Alicloud project are an <a href=https://www.alibabacloud.com/help/doc-detail/29009.htm>AccessKey Pair</a> associated with a <a href=https://www.alibabacloud.com/help/doc-detail/28627.htm>Resource Access Management (RAM) User</a>.
A RAM user is a special account that can be used by services and applications to interact with Alicloud Cloud Platform APIs.
Applications can use AccessKey pair to authorize themselves to a set of APIs and perform actions within the permissions granted to the RAM user.</p><p>Make sure to <a href=https://www.alibabacloud.com/help/doc-detail/93720.htm>create a Resource Access Management User</a>, and <a href=https://partners-intl.aliyun.com/help/doc-detail/116401.htm>create an AccessKey Pair</a> that shall be used for the Shoot cluster.</p><h3 id=permissions>Permissions</h3><p>Please make sure the provided credentials have the correct privileges. You can use the following Alicloud RAM policy document and attach it to the RAM user backed by the credentials you provided.</p><details><summary>Click to expand the Alicloud RAM policy document!</summary><div class=highlight><pre class=chroma><code class=language-json data-lang=json><span class=p>{</span>
    <span class=nt>&#34;Statement&#34;</span><span class=p>:</span> <span class=p>[</span>
        <span class=p>{</span>
            <span class=nt>&#34;Action&#34;</span><span class=p>:</span> <span class=p>[</span>
                <span class=s2>&#34;vpc:*&#34;</span>
            <span class=p>],</span>
            <span class=nt>&#34;Effect&#34;</span><span class=p>:</span> <span class=s2>&#34;Allow&#34;</span><span class=p>,</span>
            <span class=nt>&#34;Resource&#34;</span><span class=p>:</span> <span class=p>[</span>
                <span class=s2>&#34;*&#34;</span>
            <span class=p>]</span>
        <span class=p>},</span>
        <span class=p>{</span>
            <span class=nt>&#34;Action&#34;</span><span class=p>:</span> <span class=p>[</span>
                <span class=s2>&#34;ecs:*&#34;</span>
            <span class=p>],</span>
            <span class=nt>&#34;Effect&#34;</span><span class=p>:</span> <span class=s2>&#34;Allow&#34;</span><span class=p>,</span>
            <span class=nt>&#34;Resource&#34;</span><span class=p>:</span> <span class=p>[</span>
                <span class=s2>&#34;*&#34;</span>
            <span class=p>]</span>
        <span class=p>},</span>
        <span class=p>{</span>
            <span class=nt>&#34;Action&#34;</span><span class=p>:</span> <span class=p>[</span>
                <span class=s2>&#34;slb:*&#34;</span>
            <span class=p>],</span>
            <span class=nt>&#34;Effect&#34;</span><span class=p>:</span> <span class=s2>&#34;Allow&#34;</span><span class=p>,</span>
            <span class=nt>&#34;Resource&#34;</span><span class=p>:</span> <span class=p>[</span>
                <span class=s2>&#34;*&#34;</span>
            <span class=p>]</span>
        <span class=p>},</span>
        <span class=p>{</span>
            <span class=nt>&#34;Action&#34;</span><span class=p>:</span> <span class=p>[</span>
                <span class=s2>&#34;ram:GetRole&#34;</span><span class=p>,</span>
                <span class=s2>&#34;ram:CreateRole&#34;</span><span class=p>,</span>
                <span class=s2>&#34;ram:CreateServiceLinkedRole&#34;</span>
            <span class=p>],</span>
            <span class=nt>&#34;Effect&#34;</span><span class=p>:</span> <span class=s2>&#34;Allow&#34;</span><span class=p>,</span>
            <span class=nt>&#34;Resource&#34;</span><span class=p>:</span> <span class=p>[</span>
                <span class=s2>&#34;*&#34;</span>
            <span class=p>]</span>
        <span class=p>},</span>
        <span class=p>{</span>
            <span class=nt>&#34;Action&#34;</span><span class=p>:</span> <span class=p>[</span>
                <span class=s2>&#34;ros:*&#34;</span>
            <span class=p>],</span>
            <span class=nt>&#34;Effect&#34;</span><span class=p>:</span> <span class=s2>&#34;Allow&#34;</span><span class=p>,</span>
            <span class=nt>&#34;Resource&#34;</span><span class=p>:</span> <span class=p>[</span>
                <span class=s2>&#34;*&#34;</span>
            <span class=p>]</span>
        <span class=p>}</span>
    <span class=p>],</span>
    <span class=nt>&#34;Version&#34;</span><span class=p>:</span> <span class=s2>&#34;1&#34;</span>
<span class=p>}</span>
</code></pre></div></details><h2 id=infrastructureconfig><code>InfrastructureConfig</code></h2><p>The infrastructure configuration mainly describes how the network layout looks like in order to create the shoot worker nodes in a later step, thus, prepares everything relevant to create VMs, load balancers, volumes, etc.</p><p>An example <code>InfrastructureConfig</code> for the Alicloud extension looks as follows:</p><div class=highlight><pre class=chroma><code class=language-yaml data-lang=yaml><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>alicloud.provider.extensions.gardener.cloud/v1alpha1</span><span class=w>
</span><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>InfrastructureConfig</span><span class=w>
</span><span class=w></span><span class=nt>networks</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=nt>vpc</span><span class=p>:</span><span class=w> </span><span class=c># specify either &#39;id&#39; or &#39;cidr&#39;</span><span class=w>
</span><span class=w>  </span><span class=c># id: my-vpc</span><span class=w>
</span><span class=w>    </span><span class=nt>cidr</span><span class=p>:</span><span class=w> </span><span class=m>10.250.0.0</span><span class=l>/16</span><span class=w>
</span><span class=w>  </span><span class=nt>zones</span><span class=p>:</span><span class=w>
</span><span class=w>  </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>eu-central-1a</span><span class=w>
</span><span class=w>    </span><span class=nt>workers</span><span class=p>:</span><span class=w> </span><span class=m>10.250.1.0</span><span class=l>/24</span><span class=w>
</span><span class=w>  </span><span class=c># natGateway:</span><span class=w>
</span><span class=w>    </span><span class=c># eipAllocationID: eip-ufxsdg122elmszcg</span><span class=w>
</span></code></pre></div><p>The <code>networks.vpc</code> section describes whether you want to create the shoot cluster in an already existing VPC or whether to create a new one:</p><ul><li>If <code>networks.vpc.id</code> is given then you have to specify the VPC ID of the existing VPC that was created by other means (manually, other tooling, &mldr;).</li><li>If <code>networks.vpc.cidr</code> is given then you have to specify the VPC CIDR of a new VPC that will be created during shoot creation.
You can freely choose a private CIDR range.</li><li>Either <code>networks.vpc.id</code> or <code>networks.vpc.cidr</code> must be present, but not both at the same time.</li></ul><p>The <code>networks.zones</code> section describes which subnets you want to create in availability zones.
For every zone, the Alicloud extension creates one subnet:</p><ul><li>The <code>workers</code> subnet is used for all shoot worker nodes, i.e., VMs which later run your applications.</li></ul><p>For every subnet, you have to specify a CIDR range contained in the VPC CIDR specified above, or the VPC CIDR of your already existing VPC.
You can freely choose these CIDR and it is your responsibility to properly design the network layout to suit your needs.</p><p>If you want to use multiple availability zones then add a second, third, &mldr; entry to the <code>networks.zones[]</code> list and properly specify the AZ name in <code>networks.zones[].name</code>.</p><p>Apart from the VPC and the subnets the Alicloud extension will also create a NAT gateway (only if a new VPC is created), a key pair, elastic IPs, VSwitches, a SNAT table entry, and security groups.</p><p>By default, the Alicloud extension will create a corresponding Elastic IP that it attaches to this NAT gateway and which is used for egress traffic.
The <code>networks.zones[].natGateway.eipAllocationID</code> field allows you to specify the Elastic IP Allocation ID of an existing Elastic IP allocation in case you want to bring your own.
If provided, no new Elastic IP will be created and, instead, the Elastic IP specified by you will be used.</p><p>⚠️ If you change this field for an already existing infrastructure then it will disrupt egress traffic while Alicloud applies this change, because the NAT gateway must be recreated with the new Elastic IP association.
Also, please note that the existing Elastic IP will be permanently deleted if it was earlier created by the Alicloud extension.</p><h2 id=controlplaneconfig><code>ControlPlaneConfig</code></h2><p>The control plane configuration mainly contains values for the Alicloud-specific control plane components.
Today, the Alicloud extension deploys the <code>cloud-controller-manager</code> and the CSI controllers.</p><p>An example <code>ControlPlaneConfig</code> for the Alicloud extension looks as follows:</p><div class=highlight><pre class=chroma><code class=language-yaml data-lang=yaml><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>alicloud.provider.extensions.gardener.cloud/v1alpha1</span><span class=w>
</span><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>ControlPlaneConfig</span><span class=w>
</span><span class=w></span><span class=nt>cloudControllerManager</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=nt>featureGates</span><span class=p>:</span><span class=w>
</span><span class=w>    </span><span class=nt>CustomResourceValidation</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></code></pre></div><p>The <code>cloudControllerManager.featureGates</code> contains a map of explicitly enabled or disabled feature gates.
For production usage it&rsquo;s not recommend to use this field at all as you can enable alpha features or disable beta/stable features, potentially impacting the cluster stability.
If you don&rsquo;t want to configure anything for the <code>cloudControllerManager</code> simply omit the key in the YAML specification.</p><h2 id=workerconfig><code>WorkerConfig</code></h2><p>The Alicloud extension does not support a specific <code>WorkerConfig</code>. However, it supports additional data volumes (plus encryption) per machine.
By default (if not stated otherwise), all the disks are unencrypted.
For each data volume, you have to specify a name.
It also supports encrypted system disk.
However, only <a href="https://www.alibabacloud.com/help/doc-detail/172789.htm?spm=a2c63.l28256.b99.244.5da67453bNBrCt">Customized image</a> is currently supported to be used as a basic image for encrypted system disk.
Please be noted that the change of system disk encryption flag will cause reconciliation of a shoot, and it will result in nodes rolling update within the worker group.</p><p>The following YAML is a snippet of a <code>Shoot</code> resource:</p><div class=highlight><pre class=chroma><code class=language-yaml data-lang=yaml><span class=nt>spec</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=nt>provider</span><span class=p>:</span><span class=w>
</span><span class=w>    </span><span class=nt>workers</span><span class=p>:</span><span class=w>
</span><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>cpu-worker</span><span class=w>
</span><span class=w>      </span><span class=l>...</span><span class=w>
</span><span class=w>      </span><span class=nt>volume</span><span class=p>:</span><span class=w>
</span><span class=w>        </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>cloud_efficiency</span><span class=w>
</span><span class=w>        </span><span class=nt>size</span><span class=p>:</span><span class=w> </span><span class=l>20Gi</span><span class=w>
</span><span class=w>        </span><span class=nt>encrypted</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span><span class=w>      </span><span class=nt>dataVolumes</span><span class=p>:</span><span class=w>
</span><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>kubelet-dir</span><span class=w>
</span><span class=w>        </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>cloud_efficiency</span><span class=w>
</span><span class=w>        </span><span class=nt>size</span><span class=p>:</span><span class=w> </span><span class=l>25Gi</span><span class=w>
</span><span class=w>        </span><span class=nt>encrypted</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></code></pre></div><h2 id=example-shoot-manifest-one-availability-zone>Example <code>Shoot</code> manifest (one availability zone)</h2><p>Please find below an example <code>Shoot</code> manifest for one availability zone:</p><div class=highlight><pre class=chroma><code class=language-yaml data-lang=yaml><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>core.gardener.cloud/v1alpha1</span><span class=w>
</span><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Shoot</span><span class=w>
</span><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>johndoe-alicloud</span><span class=w>
</span><span class=w>  </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class=l>garden-dev</span><span class=w>
</span><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=nt>cloudProfileName</span><span class=p>:</span><span class=w> </span><span class=l>alicloud</span><span class=w>
</span><span class=w>  </span><span class=nt>region</span><span class=p>:</span><span class=w> </span><span class=l>eu-central-1</span><span class=w>
</span><span class=w>  </span><span class=nt>secretBindingName</span><span class=p>:</span><span class=w> </span><span class=l>core-alicloud</span><span class=w>
</span><span class=w>  </span><span class=nt>provider</span><span class=p>:</span><span class=w>
</span><span class=w>    </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>alicloud</span><span class=w>
</span><span class=w>    </span><span class=nt>infrastructureConfig</span><span class=p>:</span><span class=w>
</span><span class=w>      </span><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>alicloud.provider.extensions.gardener.cloud/v1alpha1</span><span class=w>
</span><span class=w>      </span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>InfrastructureConfig</span><span class=w>
</span><span class=w>      </span><span class=nt>networks</span><span class=p>:</span><span class=w>
</span><span class=w>        </span><span class=nt>vpc</span><span class=p>:</span><span class=w>
</span><span class=w>          </span><span class=nt>cidr</span><span class=p>:</span><span class=w> </span><span class=m>10.250.0.0</span><span class=l>/16</span><span class=w>
</span><span class=w>        </span><span class=nt>zones</span><span class=p>:</span><span class=w>
</span><span class=w>        </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>eu-central-1a</span><span class=w>
</span><span class=w>          </span><span class=nt>workers</span><span class=p>:</span><span class=w> </span><span class=m>10.250.0.0</span><span class=l>/19</span><span class=w>
</span><span class=w>    </span><span class=nt>controlPlaneConfig</span><span class=p>:</span><span class=w>
</span><span class=w>      </span><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>alicloud.provider.extensions.gardener.cloud/v1alpha1</span><span class=w>
</span><span class=w>      </span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>ControlPlaneConfig</span><span class=w>
</span><span class=w>    </span><span class=nt>workers</span><span class=p>:</span><span class=w>
</span><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>worker-xoluy</span><span class=w>
</span><span class=w>      </span><span class=nt>machine</span><span class=p>:</span><span class=w>
</span><span class=w>        </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>ecs.sn2ne.large</span><span class=w>
</span><span class=w>      </span><span class=nt>minimum</span><span class=p>:</span><span class=w> </span><span class=m>2</span><span class=w>
</span><span class=w>      </span><span class=nt>maximum</span><span class=p>:</span><span class=w> </span><span class=m>2</span><span class=w>
</span><span class=w>      </span><span class=nt>volume</span><span class=p>:</span><span class=w>
</span><span class=w>        </span><span class=nt>size</span><span class=p>:</span><span class=w> </span><span class=l>50Gi</span><span class=w>
</span><span class=w>        </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>cloud_efficiency</span><span class=w>
</span><span class=w>      </span><span class=nt>zones</span><span class=p>:</span><span class=w>
</span><span class=w>      </span>- <span class=l>eu-central-1a</span><span class=w>
</span><span class=w>  </span><span class=nt>networking</span><span class=p>:</span><span class=w>
</span><span class=w>    </span><span class=nt>nodes</span><span class=p>:</span><span class=w> </span><span class=m>10.250.0.0</span><span class=l>/16</span><span class=w>
</span><span class=w>    </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>calico</span><span class=w>
</span><span class=w>  </span><span class=nt>kubernetes</span><span class=p>:</span><span class=w>
</span><span class=w>    </span><span class=nt>version</span><span class=p>:</span><span class=w> </span><span class=m>1.16.1</span><span class=w>
</span><span class=w>  </span><span class=nt>maintenance</span><span class=p>:</span><span class=w>
</span><span class=w>    </span><span class=nt>autoUpdate</span><span class=p>:</span><span class=w>
</span><span class=w>      </span><span class=nt>kubernetesVersion</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span><span class=w>      </span><span class=nt>machineImageVersion</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span><span class=w>  </span><span class=nt>addons</span><span class=p>:</span><span class=w>
</span><span class=w>    </span><span class=nt>kubernetes-dashboard</span><span class=p>:</span><span class=w>
</span><span class=w>      </span><span class=nt>enabled</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span><span class=w>    </span><span class=nt>nginx-ingress</span><span class=p>:</span><span class=w>
</span><span class=w>      </span><span class=nt>enabled</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></code></pre></div><h2 id=example-shoot-manifest-two-availability-zones>Example <code>Shoot</code> manifest (two availability zones)</h2><p>Please find below an example <code>Shoot</code> manifest for two availability zones:</p><div class=highlight><pre class=chroma><code class=language-yaml data-lang=yaml><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>core.gardener.cloud/v1alpha1</span><span class=w>
</span><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Shoot</span><span class=w>
</span><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>johndoe-alicloud</span><span class=w>
</span><span class=w>  </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class=l>garden-dev</span><span class=w>
</span><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=nt>cloudProfileName</span><span class=p>:</span><span class=w> </span><span class=l>alicloud</span><span class=w>
</span><span class=w>  </span><span class=nt>region</span><span class=p>:</span><span class=w> </span><span class=l>eu-central-1</span><span class=w>
</span><span class=w>  </span><span class=nt>secretBindingName</span><span class=p>:</span><span class=w> </span><span class=l>core-alicloud</span><span class=w>
</span><span class=w>  </span><span class=nt>provider</span><span class=p>:</span><span class=w>
</span><span class=w>    </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>alicloud</span><span class=w>
</span><span class=w>    </span><span class=nt>infrastructureConfig</span><span class=p>:</span><span class=w>
</span><span class=w>      </span><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>alicloud.provider.extensions.gardener.cloud/v1alpha1</span><span class=w>
</span><span class=w>      </span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>InfrastructureConfig</span><span class=w>
</span><span class=w>      </span><span class=nt>networks</span><span class=p>:</span><span class=w>
</span><span class=w>        </span><span class=nt>vpc</span><span class=p>:</span><span class=w>
</span><span class=w>          </span><span class=nt>cidr</span><span class=p>:</span><span class=w> </span><span class=m>10.250.0.0</span><span class=l>/16</span><span class=w>
</span><span class=w>        </span><span class=nt>zones</span><span class=p>:</span><span class=w>
</span><span class=w>        </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>eu-central-1a</span><span class=w>
</span><span class=w>          </span><span class=nt>workers</span><span class=p>:</span><span class=w> </span><span class=m>10.250.0.0</span><span class=l>/26</span><span class=w>
</span><span class=w>        </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>eu-central-1b</span><span class=w>
</span><span class=w>          </span><span class=nt>workers</span><span class=p>:</span><span class=w> </span><span class=m>10.250.0.64</span><span class=l>/26</span><span class=w>
</span><span class=w>    </span><span class=nt>controlPlaneConfig</span><span class=p>:</span><span class=w>
</span><span class=w>      </span><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>alicloud.provider.extensions.gardener.cloud/v1alpha1</span><span class=w>
</span><span class=w>      </span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>ControlPlaneConfig</span><span class=w>
</span><span class=w>    </span><span class=nt>workers</span><span class=p>:</span><span class=w>
</span><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>worker-xoluy</span><span class=w>
</span><span class=w>      </span><span class=nt>machine</span><span class=p>:</span><span class=w>
</span><span class=w>        </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>ecs.sn2ne.large</span><span class=w>
</span><span class=w>      </span><span class=nt>minimum</span><span class=p>:</span><span class=w> </span><span class=m>2</span><span class=w>
</span><span class=w>      </span><span class=nt>maximum</span><span class=p>:</span><span class=w> </span><span class=m>4</span><span class=w>
</span><span class=w>      </span><span class=nt>volume</span><span class=p>:</span><span class=w>
</span><span class=w>        </span><span class=nt>size</span><span class=p>:</span><span class=w> </span><span class=l>50Gi</span><span class=w>
</span><span class=w>        </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>cloud_efficiency</span><span class=w>
</span><span class=w>        </span><span class=c># NOTE: Below comment is for the case when encrypted field of an existing shoot is updated from false to true. </span><span class=w>
</span><span class=w>        </span><span class=c># It will cause affected nodes to be rolling updated. Users must trigger a MAINTAIN operation of the shoot. </span><span class=w>
</span><span class=w>        </span><span class=c># Otherwise, the shoot will fail to reconcile.</span><span class=w>
</span><span class=w>        </span><span class=c># You could do it either via Dashboard or annotating the shoot with gardener.cloud/operation=maintain</span><span class=w>
</span><span class=w>        </span><span class=nt>encrypted</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span><span class=w>      </span><span class=nt>zones</span><span class=p>:</span><span class=w>
</span><span class=w>      </span>- <span class=l>eu-central-1a</span><span class=w>
</span><span class=w>      </span>- <span class=l>eu-central-1b</span><span class=w>
</span><span class=w>  </span><span class=nt>networking</span><span class=p>:</span><span class=w>
</span><span class=w>    </span><span class=nt>nodes</span><span class=p>:</span><span class=w> </span><span class=m>10.250.0.0</span><span class=l>/16</span><span class=w>
</span><span class=w>    </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>calico</span><span class=w>
</span><span class=w>  </span><span class=nt>kubernetes</span><span class=p>:</span><span class=w>
</span><span class=w>    </span><span class=nt>version</span><span class=p>:</span><span class=w> </span><span class=m>1.16.1</span><span class=w>
</span><span class=w>  </span><span class=nt>maintenance</span><span class=p>:</span><span class=w>
</span><span class=w>    </span><span class=nt>autoUpdate</span><span class=p>:</span><span class=w>
</span><span class=w>      </span><span class=nt>kubernetesVersion</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span><span class=w>      </span><span class=nt>machineImageVersion</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span><span class=w>  </span><span class=nt>addons</span><span class=p>:</span><span class=w>
</span><span class=w>    </span><span class=nt>kubernetes-dashboard</span><span class=p>:</span><span class=w>
</span><span class=w>      </span><span class=nt>enabled</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span><span class=w>    </span><span class=nt>nginx-ingress</span><span class=p>:</span><span class=w>
</span><span class=w>      </span><span class=nt>enabled</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></code></pre></div></div><div class=td-content style=page-break-before:always><h1 id=pg-eb56b2718d72c1dc655334ee1654389a>3 - Usage As Operator</h1><h1 id=using-the-alicloud-provider-extension-with-gardener-as-operator>Using the Alicloud provider extension with Gardener as operator</h1><p>The <a href=https://github.com/gardener/gardener/blob/master/example/30-cloudprofile.yaml><code>core.gardener.cloud/v1beta1.CloudProfile</code> resource</a> declares a <code>providerConfig</code> field that is meant to contain provider-specific configuration.
The <a href=https://github.com/gardener/gardener/blob/master/example/50-seed.yaml><code>core.gardener.cloud/v1beta1.Seed</code> resource</a> is structured similarly.
Additionally, it allows configuring settings for the backups of the main etcds' data of shoot clusters control planes running in this seed cluster.</p><p>This document explains the necessary configuration for this provider extension. In addition, this document also describes how to enable the use of customized machine images for Alicloud.</p><h2 id=cloudprofile-resource><code>CloudProfile</code> resource</h2><p>This section describes, how the configuration for <code>CloudProfile</code> looks like for Alicloud by providing an example <code>CloudProfile</code> manifest with minimal configuration that can be used to allow the creation of Alicloud shoot clusters.</p><h3 id=cloudprofileconfig><code>CloudProfileConfig</code></h3><p>The cloud profile configuration contains information about the real machine image IDs in the Alicloud environment (AMIs).
You have to map every version that you specify in <code>.spec.machineImages[].versions</code> here such that the Alicloud extension knows the AMI for every version you want to offer.</p><p>An example <code>CloudProfileConfig</code> for the Alicloud extension looks as follows:</p><div class=highlight><pre class=chroma><code class=language-yaml data-lang=yaml><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>alicloud.provider.extensions.gardener.cloud/v1alpha1</span><span class=w>
</span><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>CloudProfileConfig</span><span class=w>
</span><span class=w></span><span class=nt>machineImages</span><span class=p>:</span><span class=w>
</span><span class=w></span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>coreos</span><span class=w>
</span><span class=w>  </span><span class=nt>versions</span><span class=p>:</span><span class=w>
</span><span class=w>  </span>- <span class=nt>version</span><span class=p>:</span><span class=w> </span><span class=m>2023.4.0</span><span class=w>
</span><span class=w>    </span><span class=nt>regions</span><span class=p>:</span><span class=w>
</span><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>eu-central-1</span><span class=w>
</span><span class=w>      </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class=l>coreos_2023_4_0_64_30G_alibase_20190319.vhd</span><span class=w>
</span></code></pre></div><h3 id=example-cloudprofile-manifest>Example <code>CloudProfile</code> manifest</h3><p>Please find below an example <code>CloudProfile</code> manifest:</p><div class=highlight><pre class=chroma><code class=language-yaml data-lang=yaml><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>core.gardener.cloud/v1beta1</span><span class=w>
</span><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>CloudProfile</span><span class=w>
</span><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>alicloud</span><span class=w>
</span><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>alicloud</span><span class=w>
</span><span class=w>  </span><span class=nt>kubernetes</span><span class=p>:</span><span class=w>
</span><span class=w>    </span><span class=nt>versions</span><span class=p>:</span><span class=w>
</span><span class=w>    </span>- <span class=nt>version</span><span class=p>:</span><span class=w> </span><span class=m>1.16.1</span><span class=w>
</span><span class=w>    </span>- <span class=nt>version</span><span class=p>:</span><span class=w> </span><span class=m>1.16.0</span><span class=w>
</span><span class=w>      </span><span class=nt>expirationDate</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;2020-04-05T01:02:03Z&#34;</span><span class=w>
</span><span class=w>  </span><span class=nt>machineImages</span><span class=p>:</span><span class=w>
</span><span class=w>  </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>coreos</span><span class=w>
</span><span class=w>    </span><span class=nt>versions</span><span class=p>:</span><span class=w>
</span><span class=w>    </span>- <span class=nt>version</span><span class=p>:</span><span class=w> </span><span class=m>2023.4.0</span><span class=w>
</span><span class=w>  </span><span class=nt>machineTypes</span><span class=p>:</span><span class=w>
</span><span class=w>  </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>ecs.sn2ne.large</span><span class=w>
</span><span class=w>    </span><span class=nt>cpu</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;2&#34;</span><span class=w>
</span><span class=w>    </span><span class=nt>gpu</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;0&#34;</span><span class=w>
</span><span class=w>    </span><span class=nt>memory</span><span class=p>:</span><span class=w> </span><span class=l>8Gi</span><span class=w>
</span><span class=w>  </span><span class=nt>volumeTypes</span><span class=p>:</span><span class=w>
</span><span class=w>  </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>cloud_efficiency</span><span class=w>
</span><span class=w>    </span><span class=nt>class</span><span class=p>:</span><span class=w> </span><span class=l>standard</span><span class=w>
</span><span class=w>  </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>cloud_ssd</span><span class=w>
</span><span class=w>    </span><span class=nt>class</span><span class=p>:</span><span class=w> </span><span class=l>premium</span><span class=w>
</span><span class=w>  </span><span class=nt>regions</span><span class=p>:</span><span class=w>
</span><span class=w>  </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>eu-central-1</span><span class=w>
</span><span class=w>    </span><span class=nt>zones</span><span class=p>:</span><span class=w>
</span><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>eu-central-1a</span><span class=w>
</span><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>eu-central-1b</span><span class=w>
</span><span class=w>  </span><span class=nt>providerConfig</span><span class=p>:</span><span class=w>
</span><span class=w>    </span><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>alicloud.provider.extensions.gardener.cloud/v1alpha1</span><span class=w>
</span><span class=w>    </span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>CloudProfileConfig</span><span class=w>
</span><span class=w>    </span><span class=nt>machineImages</span><span class=p>:</span><span class=w>
</span><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>coreos</span><span class=w>
</span><span class=w>      </span><span class=nt>versions</span><span class=p>:</span><span class=w>
</span><span class=w>      </span>- <span class=nt>version</span><span class=p>:</span><span class=w> </span><span class=m>2023.4.0</span><span class=w>
</span><span class=w>        </span><span class=nt>regions</span><span class=p>:</span><span class=w>
</span><span class=w>        </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>eu-central-1</span><span class=w>
</span><span class=w>          </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class=l>coreos_2023_4_0_64_30G_alibase_20190319.vhd</span><span class=w>
</span></code></pre></div><h2 id=enable-customized-machine-images-for-the-alicloud-extension>Enable customized machine images for the Alicloud extension</h2><p>Customized machine images can be created for an Alicloud account and shared with other Alicloud accounts.
The same customized machine image has different image ID in different regions on Alicloud.
If you need to enable <code>encrypted system disk</code>, you must provide customized machine images.
Administrators/Operators need to explicitly declare them per imageID per region as below:</p><div class=highlight><pre class=chroma><code class=language-yaml data-lang=yaml><span class=nt>machineImages</span><span class=p>:</span><span class=w>
</span><span class=w></span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>customized_coreos</span><span class=w>
</span><span class=w>  </span><span class=nt>regions</span><span class=p>:</span><span class=w>
</span><span class=w>  </span>- <span class=nt>imageID</span><span class=p>:</span><span class=w> </span><span class=l>&lt;image_id_in_eu_central_1&gt;</span><span class=w>
</span><span class=w>    </span><span class=nt>region</span><span class=p>:</span><span class=w> </span><span class=l>eu-central-1</span><span class=w>
</span><span class=w>  </span>- <span class=nt>imageID</span><span class=p>:</span><span class=w> </span><span class=l>&lt;image_id_in_cn_shanghai&gt;</span><span class=w>
</span><span class=w>    </span><span class=nt>region</span><span class=p>:</span><span class=w> </span><span class=l>cn-shanghai</span><span class=w>
</span><span class=w>  </span><span class=l>...</span><span class=w>
</span><span class=w>  </span><span class=nt>version</span><span class=p>:</span><span class=w> </span><span class=m>2191.4.1</span><span class=w>
</span><span class=w></span><span class=nn>...</span><span class=w>
</span></code></pre></div><p>End-users have to have the permission to use the customized image from its creator Alicloud account. To enable end-users to use customized images, the images are shared from Alicloud account of Seed operator with end-users' Alicloud accounts. Administrators/Operators need to explicitly provide Seed operator&rsquo;s Alicloud account access credentials (base64 encoded) as below:</p><div class=highlight><pre class=chroma><code class=language-yaml data-lang=yaml><span class=nt>machineImageOwnerSecret</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>machine-image-owner</span><span class=w>
</span><span class=w>  </span><span class=nt>accessKeyID</span><span class=p>:</span><span class=w> </span><span class=l>&lt;base64_encoded_access_key_id&gt;</span><span class=w>
</span><span class=w>  </span><span class=nt>accessKeySecret</span><span class=p>:</span><span class=w> </span><span class=l>&lt;base64_encoded_access_key_secret&gt;</span><span class=w>
</span></code></pre></div><p>As a result, a Secret named <code>machine-image-owner</code> by default will be created in namespace of Alicloud provider extension.</p><p>Operators should also maintain custom image IDs which are to be shared with end-users as below:</p><div class=highlight><pre class=chroma><code class=language-yaml data-lang=yaml><span class=nt>toBeSharedImageIDs</span><span class=p>:</span><span class=w>
</span><span class=w></span>- <span class=l>&lt;image_id_1&gt;</span><span class=w>
</span><span class=w></span>- <span class=l>&lt;image_id_2&gt;</span><span class=w>
</span><span class=w></span>- <span class=l>&lt;image_id_3&gt;</span><span class=w>
</span></code></pre></div><h3 id=example-controllerdeployment-manifest-for-enabling-customized-machine-images>Example <code>ControllerDeployment</code> manifest for enabling customized machine images</h3><div class=highlight><pre class=chroma><code class=language-yaml data-lang=yaml><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>core.gardener.cloud/v1beta1</span><span class=w>
</span><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>ControllerDeployment</span><span class=w>
</span><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>extension-provider-alicloud</span><span class=w>
</span><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>helm</span><span class=w>
</span><span class=w>   </span><span class=nt>providerConfig</span><span class=p>:</span><span class=w>
</span><span class=w>    </span><span class=nt>chart</span><span class=p>:</span><span class=w> </span><span class=p>|</span><span class=sd>
</span><span class=sd>      </span><span class=w>      </span><span class=l>H4sIFAAAAAAA/yk...</span><span class=w>
</span><span class=w>    </span><span class=nt>values</span><span class=p>:</span><span class=w>
</span><span class=w>      </span><span class=nt>config</span><span class=p>:</span><span class=w>
</span><span class=w>        </span><span class=nt>machineImageOwnerSecret</span><span class=p>:</span><span class=w>
</span><span class=w>          </span><span class=nt>accessKeyID</span><span class=p>:</span><span class=w> </span><span class=l>&lt;base64_encoded_access_key_id&gt;</span><span class=w>
</span><span class=w>          </span><span class=nt>accessKeySecret</span><span class=p>:</span><span class=w> </span><span class=l>&lt;base64_encoded_access_key_secret&gt;</span><span class=w>
</span><span class=w>        </span><span class=nt>toBeSharedImageIDs</span><span class=p>:</span><span class=w>
</span><span class=w>        </span>- <span class=l>&lt;image_id_1&gt;</span><span class=w>
</span><span class=w>        </span>- <span class=l>&lt;image_id_2&gt;</span><span class=w>
</span><span class=w>        </span><span class=l>...</span><span class=w>
</span><span class=w>        </span><span class=nt>machineImages</span><span class=p>:</span><span class=w>
</span><span class=w>        </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>customized_coreos</span><span class=w>
</span><span class=w>          </span><span class=nt>regions</span><span class=p>:</span><span class=w>
</span><span class=w>          </span>- <span class=nt>imageID</span><span class=p>:</span><span class=w> </span><span class=l>&lt;image_id_in_eu_central_1&gt;</span><span class=w>
</span><span class=w>            </span><span class=nt>region</span><span class=p>:</span><span class=w> </span><span class=l>eu-central-1</span><span class=w>
</span><span class=w>          </span>- <span class=nt>imageID</span><span class=p>:</span><span class=w> </span><span class=l>&lt;image_id_in_cn_shanghai&gt;</span><span class=w>
</span><span class=w>            </span><span class=nt>region</span><span class=p>:</span><span class=w> </span><span class=l>cn-shanghai</span><span class=w>
</span><span class=w>          </span><span class=l>...</span><span class=w>
</span><span class=w>          </span><span class=nt>version</span><span class=p>:</span><span class=w> </span><span class=m>2191.4.1</span><span class=w>
</span><span class=w>        </span><span class=l>...</span><span class=w>
</span><span class=w>        </span><span class=nt>csi</span><span class=p>:</span><span class=w>
</span><span class=w>          </span><span class=nt>enableADController</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span><span class=w>      </span><span class=nt>resources</span><span class=p>:</span><span class=w>
</span><span class=w>        </span><span class=nt>limits</span><span class=p>:</span><span class=w>
</span><span class=w>          </span><span class=nt>cpu</span><span class=p>:</span><span class=w> </span><span class=l>500m</span><span class=w>
</span><span class=w>          </span><span class=nt>memory</span><span class=p>:</span><span class=w> </span><span class=l>1Gi</span><span class=w>
</span><span class=w>        </span><span class=nt>requests</span><span class=p>:</span><span class=w>
</span><span class=w>          </span><span class=nt>memory</span><span class=p>:</span><span class=w> </span><span class=l>128Mi</span><span class=w>
</span></code></pre></div><h2 id=seed-resource><code>Seed</code> resource</h2><p>This provider extension does not support any provider configuration for the <code>Seed</code>&rsquo;s <code>.spec.provider.providerConfig</code> field.
However, it supports to managing of backup infrastructure, i.e., you can specify a configuration for the <code>.spec.backup</code> field.</p><h3 id=backup-configuration>Backup configuration</h3><p>A Seed of type <code>alicloud</code> can be configured to perform backups for the main etcds' of the shoot clusters control planes using Alicloud <a href=https://www.alibabacloud.com/help/doc-detail/31817.htm>Object Storage Service</a>.</p><p>The location/region where the backups will be stored defaults to the region of the Seed (<code>spec.provider.region</code>).</p><p>Please find below an example <code>Seed</code> manifest (partly) that configures backups using Alicloud Object Storage Service.</p><div class=highlight><pre class=chroma><code class=language-yaml data-lang=yaml><span class=nn>---</span><span class=w>
</span><span class=w></span><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>core.gardener.cloud/v1beta1</span><span class=w>
</span><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Seed</span><span class=w>
</span><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>my-seed</span><span class=w>
</span><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=nt>provider</span><span class=p>:</span><span class=w>
</span><span class=w>    </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>alicloud</span><span class=w>
</span><span class=w>    </span><span class=nt>region</span><span class=p>:</span><span class=w> </span><span class=l>cn-shanghai</span><span class=w>
</span><span class=w>  </span><span class=nt>backup</span><span class=p>:</span><span class=w>
</span><span class=w>    </span><span class=nt>provider</span><span class=p>:</span><span class=w> </span><span class=l>alicloud</span><span class=w>
</span><span class=w>    </span><span class=nt>secretRef</span><span class=p>:</span><span class=w>
</span><span class=w>      </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>backup-credentials</span><span class=w>
</span><span class=w>      </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class=l>garden</span><span class=w>
</span><span class=w>  </span><span class=l>...</span><span class=w>
</span></code></pre></div><p>An example of the referenced secret containing the credentials for the Alicloud Object Storage Service can be found in the <a href=https://github.com/gardener/gardener-extension-provider-alicloud/blob/master/example/30-etcd-backup-secret.yaml>example folder</a>.</p><h4 id=permissions-for-alicloud-object-storage-service>Permissions for Alicloud Object Storage Service</h4><p>Please make sure the RAM user associated with the provided AccessKey pair has the following permission.</p><ul><li>AliyunOSSFullAccess</li></ul></div></main></div></div><footer class="footer row d-print-none"><div class="container-fluid footer-wrapper"><ul class=nav><li><a href=/blog/>Blogs</a></li><li><a href=/community/>Community</a></li><li><a href=/adopter/>Adopters</a></li><li><a href=/docs/>Documentation</a></li></ul><img src=/images/lp/gardener-logo.svg alt="Logo Gardener" class=logo><ul class=media-wr><li><a target=_blank href=https://kubernetes.slack.com/archives/CB57N0BFG><img src=/images/branding/slack-logo-white.svg class=media-icon><div class=media-text>Slack</div></a></li><li><a target=_blank href=https://github.com/gardener><img src=/images/branding/github-mark-logo.png class=media-icon><div class=media-text>GitHub</div></a></li><li><a target=_blank href=https://www.youtube.com/channel/UCwUhwKFREV8Su0gwAJQX7tw><img src=/images/branding/youtube-logo-dark.svg class=media-icon><div class=media-text>YouTube</div></a></li><li><a target=_blank href=https://twitter.com/GardenerProject><img src=/images/branding/twitter-logo-white.svg class=media-icon><div class=media-text>Twitter</div></a></li></ul><span class=copyright>Copyright 2019-2021 Gardener project authors. <a href=https://www.sap.com/corporate/en/legal/privacy.html>Privacy policy
<i class="fa fa-external-link" aria-hidden=true></i></a></span></div></footer></div><script src=https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js integrity=sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js integrity=sha384-+YQ4JLhjyBLPDQt//I+STsc9iw4uQqACwlvpslubQzn4u2UU2UFM80nGisd026JF crossorigin=anonymous></script><script src=/js/main.min.3b172c13b62c2bea8b1c9d2599cddc8cf89718a92d792c680871c81ba43d8c85.js integrity="sha256-OxcsE7YsK+qLHJ0lmc3cjPiXGKkteSxoCHHIG6Q9jIU=" crossorigin=anonymous></script></body></html>