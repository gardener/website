<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=canonical type=text/html href=https://gardener.cloud/docs/other-components/dependency-watchdog/deployment/><link rel=alternate type=application/rss+xml href=https://gardener.cloud/docs/other-components/dependency-watchdog/deployment/index.xml><meta name=robots content="noindex, nofollow"><link rel="shortcut icon" href=/favicons/favicon.ico><link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/favicons/android-192x192.png sizes=192x192><title>Deployment | Gardener</title>
<meta name=description content="Project Gardener Website - A Managed Kubernetes Service Done Right"><meta property="og:url" content="https://gardener.cloud/docs/other-components/dependency-watchdog/deployment/"><meta property="og:site_name" content="Gardener"><meta property="og:title" content="Deployment"><meta property="og:description" content="Project Gardener Website - A Managed Kubernetes Service Done Right"><meta property="og:locale" content="en_US"><meta property="og:type" content="website"><meta property="og:image" content="https://gardener.cloud/images/lp/gardener-logo.svg"><meta itemprop=name content="Deployment"><meta itemprop=description content="Project Gardener Website - A Managed Kubernetes Service Done Right"><meta itemprop=image content="https://gardener.cloud/images/lp/gardener-logo.svg"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://gardener.cloud/images/lp/gardener-logo.svg"><meta name=twitter:title content="Deployment"><meta name=twitter:description content="Project Gardener Website - A Managed Kubernetes Service Done Right"><link rel=preload href=/scss/main.min.3b9ac919481029e416df474ad35607ec3f5f04f6de0c49ea2f1af3ab95c8363e.css as=style integrity="sha256-O5rJGUgQKeQW30dK01YH7D9fBPbeDEnqLxrzq5XINj4=" crossorigin=anonymous><link href=/scss/main.min.3b9ac919481029e416df474ad35607ec3f5f04f6de0c49ea2f1af3ab95c8363e.css rel=stylesheet integrity="sha256-O5rJGUgQKeQW30dK01YH7D9fBPbeDEnqLxrzq5XINj4=" crossorigin=anonymous><script src=https://code.jquery.com/jquery-3.7.1.min.js integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin=anonymous></script><script defer src=https://unpkg.com/lunr@2.3.9/lunr.min.js integrity=sha384-203J0SNzyqHby3iU6hzvzltrWi/M41wOP5Gu+BiJMz5nwKykbkUx8Kp7iti0Lpli crossorigin=anonymous></script></head><body class=td-section><header><nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar"><a class=navbar-brand href=/><span class=navbar-logo><svg width="90" height="90" viewBox="0 0 90 90" xmlns:xlink="http://www.w3.org/1999/xlink"><title>logo</title><desc>Created with Sketch.</desc><defs><path d="M41.8864954.994901575c.996545099999999-.479910833 2.6164002-.477918931 3.6088091.0L76.8159138 16.0781121C77.8124589 16.5580229 78.8208647 17.8257185 79.0659694 18.8995926l7.7355517 33.8916663C87.0476474 53.8696088 86.6852538 55.4484075 85.9984855 56.3095876L64.3239514 83.4885938C63.6343208 84.3533632 62.1740175 85.0543973 61.0725268 85.0543973H26.3092731c-1.1060816.0-2.5646564-.704623400000003-3.2514246-1.5658035L1.38331434 56.3095876C.693683723 55.4448182.335174016 53.865133.580278769 52.7912589L8.31583044 18.8995926C8.56195675 17.8212428 9.57347722 16.556031 10.5658861 16.0781121L41.8864954.994901575z" id="path-1"/><linearGradient x1="12.7542673%" y1="-18.6617048%" x2="88.2666158%" y2="84.6075483%" id="linearGradient-3"><stop stop-color="#fff" offset="0"/><stop stop-color="#439246" offset="100%"/></linearGradient><linearGradient x1="50%" y1="4.93673768%" x2="148.756007%" y2="175.514523%" id="linearGradient-4"><stop stop-color="#fff" offset="0"/><stop stop-color="#439246" offset="100%"/></linearGradient><linearGradient x1="19.1574381%" y1="-9.04800713%" x2="82.2203149%" y2="77.9084293%" id="linearGradient-5"><stop stop-color="#fff" offset="0"/><stop stop-color="#439246" offset="100%"/></linearGradient><linearGradient x1="57.4403751%" y1="26.3148481%" x2="137.966711%" y2="158.080556%" id="linearGradient-6"><stop stop-color="#fff" offset="0"/><stop stop-color="#439246" offset="100%"/></linearGradient></defs><g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="logo"><g id="Rectangle-2" transform="translate(1.000000, 0.000000)"><mask id="mask-2" fill="#fff"><use xlink:href="#path-1"/></mask><use id="Mask" fill="#009f76" xlink:href="#path-1"/><polygon fill="#000" opacity=".289628623" mask="url(#mask-2)" points="-17.6484375 54.5224609 30.8242188 25.0791016 63.4726562 58.5 24.7324219 92.6689453"/></g><path d="M56.8508631 39.260019C56.4193519 40.443987 55.6088085 41.581593 54.6736295 42.1938694l-8.0738997 5.2861089c-1.3854671.907087099999998-3.6247515.9116711-5.0172201.0L33.50861 42.1938694C32.123143 41.2867823 31 39.206345 31 37.545932V26.4150304c0-.725313.2131118-1.5301454.569268099999999-2.2825772L56.8508631 39.260019z" id="Combined-Shape" fill="url(#linearGradient-3)" transform="translate(43.925432, 36.147233) scale(-1, 1) translate(-43.925432, -36.147233)"/><path d="M56.0774672 25.1412464C56.4306829 25.8903325 56.6425556 26.6907345 56.6425556 27.4119019V38.5428034c0 1.6598979-1.1161415 3.73626640000001-2.50861 4.6479374l-8.0738997 5.286109c-1.3854671.907087000000004-3.6247516.911671000000005-5.0172201.0L32.9689261 43.1907408C32.2918101 42.7474223 31.6773514 42.0238435 31.2260376 41.206007L56.0774672 25.1412464z" id="Combined-Shape" fill="url(#linearGradient-4)" transform="translate(43.821278, 37.246598) scale(-1, 1) translate(-43.821278, -37.246598)"/><path d="M65.0702134 57.1846889C64.5985426 58.2007851 63.8367404 59.1236871 62.9788591 59.6189851L47.37497 68.6278947c-1.4306165.825966800000003-3.75236779999999.8246599-5.1807206.0L26.5903603 59.6189851C25.1597438 58.7930183 24 56.7816693 24 55.1323495V37.1145303C24 36.3487436 24.249712 35.5060005 24.6599102 34.7400631L65.0702134 57.1846889z" id="Combined-Shape" fill="url(#linearGradient-5)"/><path d="M65.0189476 34.954538C65.3636909 35.6617313 65.5692194 36.42021 65.5692194 37.1145303V55.1323495C65.5692194 56.7842831 64.4072119 58.7943252 62.9788591 59.6189851L47.37497 68.6278947c-1.4306165.825966800000003-3.75236779999999.8246599-5.1807206.0L26.5903603 59.6189851C25.9237304 59.2341061 25.3159155 58.5918431 24.8568495 57.8487596L65.0189476 34.954538z" id="Combined-Shape" fill="url(#linearGradient-6)"/></g></g></svg></span><span class=text-capitalize>Gardener</span></a><div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar><ul class="navbar-nav mt-2 mt-lg-0"><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=https://demo.gardener.cloud target=_blank><span>Demo</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/adopter><span>Adopters</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><div class=dropdown><a href=/docs class=nav-link>Documentation</a><div class=dropdown-content><a class=taxonomy-term href=/docs>Users</a>
<a class=taxonomy-term href=/docs>Operators</a>
<a class=taxonomy-term href=/docs>Developers</a>
<a class=taxonomy-term href=/docs>All</a></div></div></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/blog><span>Blogs</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/community><span>Community</span></a></li></ul></div><div class="navbar-nav d-none d-lg-block"><div class="td-search td-search--offline"><div class=td-search__icon></div><input type=search class="td-search__input form-control" placeholder="Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=/offline-search-index.32625d36b3e67c454eda82c286c37096.json data-offline-search-base-href=/ data-offline-search-max-results=10></div></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><main class="col-12 col-md-9 col-xl-8 ps-md-5" role=main><div class=td-content><div class="pageinfo pageinfo-primary d-print-none"><p>This is the multi-page printable view of this section.
<a href=# onclick="return print(),!1">Click here to print</a>.</p><p><a href=/docs/other-components/dependency-watchdog/deployment/>Return to the regular view of this page</a>.</p></div><h1 class=title>Deployment</h1><div class=content></div></div><div class=td-content><h1 id=pg-922ffeaf5b813bbead3438c478d3ffa4>1 - Configure</h1><h1 id=configure-dependency-watchdog-components>Configure Dependency Watchdog Components<a class=td-heading-self-link href=#configure-dependency-watchdog-components aria-label="Heading self-link"></a></h1><h2 id=prober>Prober<a class=td-heading-self-link href=#prober aria-label="Heading self-link"></a></h2><p>Dependency watchdog prober command takes command-line-flags which are meant to fine-tune the prober. In addition a <code>ConfigMap</code> is also mounted to the container which provides tuning knobs for the all probes that the prober starts.</p><h3 id=command-line-arguments>Command line arguments<a class=td-heading-self-link href=#command-line-arguments aria-label="Heading self-link"></a></h3><p>Prober can be configured via the following flags:</p><table><thead><tr><th>Flag Name</th><th>Type</th><th>Required</th><th>Default Value</th><th>Description</th></tr></thead><tbody><tr><td>kube-api-burst</td><td>int</td><td>No</td><td>10</td><td>Burst to use while talking with kubernetes API server. The number must be >= 0. If it is 0 then a default value of 10 will be used</td></tr><tr><td>kube-api-qps</td><td>float</td><td>No</td><td>5.0</td><td>Maximum QPS (queries per second) allowed when talking with kubernetes API server. The number must be >= 0. If it is 0 then a default value of 5.0 will be used</td></tr><tr><td>concurrent-reconciles</td><td>int</td><td>No</td><td>1</td><td>Maximum number of concurrent reconciles</td></tr><tr><td>config-file</td><td>string</td><td>Yes</td><td>NA</td><td>Path of the config file containing the configuration to be used for all probes</td></tr><tr><td>metrics-bind-addr</td><td>string</td><td>No</td><td>&ldquo;:9643&rdquo;</td><td>The TCP address that the controller should bind to for serving prometheus metrics</td></tr><tr><td>health-bind-addr</td><td>string</td><td>No</td><td>&ldquo;:9644&rdquo;</td><td>The TCP address that the controller should bind to for serving health probes</td></tr><tr><td>enable-leader-election</td><td>bool</td><td>No</td><td>false</td><td>In case prober deployment has more than 1 replica for high availability, then it will be setup in a active-passive mode. Out of many replicas one will become the leader and the rest will be passive followers waiting to acquire leadership in case the leader dies.</td></tr><tr><td>leader-election-namespace</td><td>string</td><td>No</td><td>&ldquo;garden&rdquo;</td><td>Namespace in which leader election resource will be created. It should be the same namespace where DWD pods are deployed</td></tr><tr><td>leader-elect-lease-duration</td><td>time.Duration</td><td>No</td><td>15s</td><td>The duration that non-leader candidates will wait after observing a leadership renewal until attempting to acquire leadership of a led but unrenewed leader slot. This is effectively the maximum duration that a leader can be stopped before it is replaced by another candidate. This is only applicable if leader election is enabled.</td></tr><tr><td>leader-elect-renew-deadline</td><td>time.Duration</td><td>No</td><td>10s</td><td>The interval between attempts by the acting master to renew a leadership slot before it stops leading. This must be less than or equal to the lease duration. This is only applicable if leader election is enabled.</td></tr><tr><td>leader-elect-retry-period</td><td>time.Duration</td><td>No</td><td>2s</td><td>The duration the clients should wait between attempting acquisition and renewal of a leadership. This is only applicable if leader election is enabled.</td></tr></tbody></table><p>You can view an example kubernetes prober <a href=https://github.com/gardener/dependency-watchdog/blob/master/example/03-dwd-prober-deployment.yaml>deployment</a> YAML to see how these command line args are configured.</p><h3 id=prober-configuration>Prober Configuration<a class=td-heading-self-link href=#prober-configuration aria-label="Heading self-link"></a></h3><p>A probe configuration is mounted as <code>ConfigMap</code> to the container. The path to the config file is configured via <code>config-file</code> command line argument as mentioned above. Prober will start one probe per Shoot control plane hosted within the Seed cluster. Each such probe will run asynchronously and will periodically connect to the Kube ApiServer of the Shoot. Configuration below will influence each such probe.</p><p>You can view an example YAML configuration provided as <code>data</code> in a <code>ConfigMap</code> <a href=https://github.com/gardener/dependency-watchdog/blob/master/example/01-dwd-prober-configmap.yaml>here</a>.</p><table><thead><tr><th>Name</th><th>Type</th><th>Required</th><th>Default Value</th><th>Description</th></tr></thead><tbody><tr><td>kubeConfigSecretName</td><td>string</td><td>Yes</td><td>NA</td><td>Name of the kubernetes Secret which has the encoded KubeConfig required to connect to the Shoot control plane Kube ApiServer via an internal domain. This typically uses the local cluster DNS.</td></tr><tr><td>probeInterval</td><td>metav1.Duration</td><td>No</td><td>10s</td><td>Interval with which each probe will run.</td></tr><tr><td>initialDelay</td><td>metav1.Duration</td><td>No</td><td>30s</td><td>Initial delay for the probe to become active. Only applicable when the probe is created for the first time.</td></tr><tr><td>probeTimeout</td><td>metav1.Duration</td><td>No</td><td>30s</td><td>In each run of the probe it will attempt to connect to the Shoot Kube ApiServer. probeTimeout defines the timeout after which a single run of the probe will fail.</td></tr><tr><td>backoffJitterFactor</td><td>float64</td><td>No</td><td>0.2</td><td>Jitter with which a probe is run.</td></tr><tr><td>dependentResourceInfos</td><td>[]prober.DependentResourceInfo</td><td>Yes</td><td>NA</td><td>Detailed below.</td></tr><tr><td>kcmNodeMonitorGraceDuration</td><td>metav1.Duration</td><td>Yes</td><td>NA</td><td>It is the node-monitor-grace-period set in the kcm flags. Used to determine whether a node lease can be considered expired.</td></tr><tr><td>nodeLeaseFailureFraction</td><td>float64</td><td>No</td><td>0.6</td><td>is used to determine the maximum number of leases that can be expired for a lease probe to succeed.</td></tr></tbody></table><h3 id=dependentresourceinfo>DependentResourceInfo<a class=td-heading-self-link href=#dependentresourceinfo aria-label="Heading self-link"></a></h3><p>If a lease probe fails, then it scales down the dependent resources defined by this property. Similarly, if the lease probe is now successful, then it scales up the dependent resources defined by this property.</p><p>Each dependent resource info has the following properties:</p><table><thead><tr><th>Name</th><th>Type</th><th>Required</th><th>Default Value</th><th>Description</th></tr></thead><tbody><tr><td>ref</td><td>autoscalingv1.CrossVersionObjectReference</td><td>Yes</td><td>NA</td><td>It is a collection of ApiVersion, Kind and Name for a kubernetes resource thus serving as an identifier.</td></tr><tr><td>optional</td><td>bool</td><td>Yes</td><td>NA</td><td>It is possible that a dependent resource is optional for a Shoot control plane. This property enables a probe to determine the correct behavior in case it is unable to find the resource identified via <code>ref</code>.</td></tr><tr><td>scaleUp</td><td>prober.ScaleInfo</td><td>No</td><td></td><td>Captures the configuration to scale up this resource. Detailed below.</td></tr><tr><td>scaleDown</td><td>prober.ScaleInfo</td><td>No</td><td></td><td>Captures the configuration to scale down this resource. Detailed below.</td></tr></tbody></table><blockquote><p>NOTE: Since each dependent resource is a target for scale up/down, therefore it is mandatory that the resource reference points a kubernetes resource which has a <code>scale</code> subresource.</p></blockquote><h3 id=scaleinfo>ScaleInfo<a class=td-heading-self-link href=#scaleinfo aria-label="Heading self-link"></a></h3><p>How to scale a <code>DependentResourceInfo</code> is captured in <code>ScaleInfo</code>. It has the following properties:</p><table><thead><tr><th>Name</th><th>Type</th><th>Required</th><th>Default Value</th><th>Description</th></tr></thead><tbody><tr><td>level</td><td>int</td><td>Yes</td><td>NA</td><td>Detailed below.</td></tr><tr><td>initialDelay</td><td>metav1.Duration</td><td>No</td><td>0s (No initial delay)</td><td>Once a decision is taken to scale a resource then via this property a delay can be induced before triggering the scale of the dependent resource.</td></tr><tr><td>timeout</td><td>metav1.Duration</td><td>No</td><td>30s</td><td>Defines the timeout for the scale operation to finish for a dependent resource.</td></tr></tbody></table><p><strong>Determining target replicas</strong></p><p>Prober cannot assume any target replicas during a scale-up operation for the following reasons:</p><ol><li>Kubernetes resources could be set to provide highly availability and the number of replicas could wary from one shoot control plane to the other. In gardener the number of replicas of pods in shoot namespace are controlled by the <a href=/docs/guides/high-availability/control-plane/>shoot control plane configuration</a>.</li><li>If Horizontal Pod Autoscaler has been configured for a kubernetes dependent resource then it could potentially change the <code>spec.replicas</code> for a deployment/statefulset.</li></ol><p>Given the above constraint lets look at how prober determines the target replicas during scale-down or scale-up operations.</p><ol><li><p><code>Scale-Up</code>: Primary responsibility of a probe while performing a scale-up is to restore the replicas of a kubernetes dependent resource prior to scale-down. In order to do that it updates the following for each dependent resource that requires a scale-up:</p><ol><li><code>spec.replicas</code>: Checks if <code>dependency-watchdog.gardener.cloud/replicas</code> is set. If it is, then it will take the value stored against this key as the target replicas. To be a valid value it should always be greater than 0.</li><li>If <code>dependency-watchdog.gardener.cloud/replicas</code> annotation is not present then it falls back to the hard coded default value for scale-up which is set to 1.</li><li>Removes the annotation <code>dependency-watchdog.gardener.cloud/replicas</code> if it exists.</li></ol></li><li><p><code>Scale-Down</code>: To scale down a dependent kubernetes resource it does the following:</p><ol><li>Adds an annotation <code>dependency-watchdog.gardener.cloud/replicas</code> and sets its value to the current value of <code>spec.replicas</code>.</li><li>Updates <code>spec.replicas</code> to 0.</li></ol></li></ol><p><strong>Level</strong></p><p>Each dependent resource that should be scaled up or down is associated to a level. Levels are ordered and processed in ascending order (starting with 0 assigning it the highest priority). Consider the following configuration:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>dependentResourceInfos:
</span></span><span style=display:flex><span>  - ref: 
</span></span><span style=display:flex><span>      kind: <span style=color:#a31515>&#34;Deployment&#34;</span>
</span></span><span style=display:flex><span>      name: <span style=color:#a31515>&#34;kube-controller-manager&#34;</span>
</span></span><span style=display:flex><span>      apiVersion: <span style=color:#a31515>&#34;apps/v1&#34;</span>
</span></span><span style=display:flex><span>    scaleUp: 
</span></span><span style=display:flex><span>      level: 1 
</span></span><span style=display:flex><span>    scaleDown: 
</span></span><span style=display:flex><span>      level: 0 
</span></span><span style=display:flex><span>  - ref:
</span></span><span style=display:flex><span>      kind: <span style=color:#a31515>&#34;Deployment&#34;</span>
</span></span><span style=display:flex><span>      name: <span style=color:#a31515>&#34;machine-controller-manager&#34;</span>
</span></span><span style=display:flex><span>      apiVersion: <span style=color:#a31515>&#34;apps/v1&#34;</span>
</span></span><span style=display:flex><span>    scaleUp:
</span></span><span style=display:flex><span>      level: 1
</span></span><span style=display:flex><span>    scaleDown:
</span></span><span style=display:flex><span>      level: 1
</span></span><span style=display:flex><span>  - ref:
</span></span><span style=display:flex><span>      kind: <span style=color:#a31515>&#34;Deployment&#34;</span>
</span></span><span style=display:flex><span>      name: <span style=color:#a31515>&#34;cluster-autoscaler&#34;</span>
</span></span><span style=display:flex><span>      apiVersion: <span style=color:#a31515>&#34;apps/v1&#34;</span>
</span></span><span style=display:flex><span>    scaleUp:
</span></span><span style=display:flex><span>      level: 0
</span></span><span style=display:flex><span>    scaleDown:
</span></span><span style=display:flex><span>      level: 2
</span></span></code></pre></div><p>Let us order the dependent resources by their respective levels for both scale-up and scale-down. We get the following order:</p><p><em>Scale Up Operation</em></p><p>Order of scale up will be:</p><ol><li>cluster-autoscaler</li><li>kube-controller-manager and machine-controller-manager will be scaled up concurrently after cluster-autoscaler has been scaled up.</li></ol><p><em>Scale Down Operation</em></p><p>Order of scale down will be:</p><ol><li>kube-controller-manager</li><li>machine-controller-manager after (1) has been scaled down.</li><li>cluster-autoscaler after (2) has been scaled down.</li></ol><h3 id=disableignore-scaling>Disable/Ignore Scaling<a class=td-heading-self-link href=#disableignore-scaling aria-label="Heading self-link"></a></h3><p>A probe can be configured to ignore scaling of configured dependent kubernetes resources.
To do that one must set <code>dependency-watchdog.gardener.cloud/ignore-scaling</code> annotation to <code>true</code> on the scalable resource for which scaling should be ignored.</p><h2 id=weeder>Weeder<a class=td-heading-self-link href=#weeder aria-label="Heading self-link"></a></h2><p>Dependency watchdog weeder command also (just like the prober command) takes command-line-flags which are meant to fine-tune the weeder. In addition a <code>ConfigMap</code> is also mounted to the container which helps in defining the dependency of pods on endpoints.</p><h3 id=command-line-arguments-1>Command Line Arguments<a class=td-heading-self-link href=#command-line-arguments-1 aria-label="Heading self-link"></a></h3><p>Weeder can be configured with the same flags as that for prober described under <a href=/docs/other-components/dependency-watchdog/deployment/configure/#command-line-arguments>command-line-arguments</a> section
You can find an example weeder <a href=https://github.com/gardener/dependency-watchdog/blob/master/example/04-dwd-weeder-deployment.yaml>deployment</a> YAML to see how these command line args are configured.</p><h3 id=weeder-configuration>Weeder Configuration<a class=td-heading-self-link href=#weeder-configuration aria-label="Heading self-link"></a></h3><p>Weeder configuration is mounted as <code>ConfigMap</code> to the container. The path to the config file is configured via <code>config-file</code> command line argument as mentioned above. Weeder will start one go routine per podSelector per endpoint on an endpoint event as described in <a href=/docs/other-components/dependency-watchdog/concepts/weeder/#internals>weeder internal concepts</a>.</p><p>You can view the example YAML configuration provided as <code>data</code> in a <code>ConfigMap</code> <a href=https://github.com/gardener/dependency-watchdog/blob/master/example/02-dwd-weeder-configmap.yaml>here</a>.</p><table><thead><tr><th>Name</th><th>Type</th><th>Required</th><th>Default Value</th><th>Description</th></tr></thead><tbody><tr><td>watchDuration</td><td>*metav1.Duration</td><td>No</td><td>5m0s</td><td>The time duration for which watch is kept on dependent pods to see if anyone turns to <code>CrashLoopBackoff</code></td></tr><tr><td>servicesAndDependantSelectors</td><td>map[string]DependantSelectors</td><td>Yes</td><td>NA</td><td>Endpoint name and its corresponding dependent pods. More info below.</td></tr></tbody></table><h3 id=dependantselectors>DependantSelectors<a class=td-heading-self-link href=#dependantselectors aria-label="Heading self-link"></a></h3><p>If the service recovers from downtime, then weeder starts to watch for CrashLoopBackOff pods. These pods are identified by info stored in this property.</p><table><thead><tr><th>Name</th><th>Type</th><th>Required</th><th>Default Value</th><th>Description</th></tr></thead><tbody><tr><td>podSelectors</td><td>[]*metav1.LabelSelector</td><td>Yes</td><td>NA</td><td>This is a list of <a href=https://pkg.go.dev/k8s.io/apimachinery/pkg/apis/meta/v1@v0.24.3#LabelSelector>Label selector</a></td></tr></tbody></table></div><div class=td-content style=page-break-before:always><h1 id=pg-f28b0a628f77e282807d7fe76d71d2a7>2 - Monitor</h1><h1 id=monitoring>Monitoring<a class=td-heading-self-link href=#monitoring aria-label="Heading self-link"></a></h1><h2 id=work-in-progress><em>Work In Progress</em><a class=td-heading-self-link href=#work-in-progress aria-label="Heading self-link"></a></h2><p>We will be introducing metrics for <code>Dependency-Watchdog-Prober</code> and <code>Dependency-Watchdog-Weeder</code>. These metrics will be pushed to prometheus. Once that is completed we will provide details on all the metrics that will be supported here.</p></div></main></div></div><footer class="footer row d-print-none"><div class="container-fluid footer-wrapper"><ul class=nav><li><a href=https://gardener.cloud/blog/>Blogs</a></li><li><a href=https://gardener.cloud/community/>Community</a></li><li><a href=https://gardener.cloud/adopter/>Adopters</a></li><li><a href=/docs/>Documentation</a></li></ul><img src=/images/lp/gardener-logo.svg alt="Logo Gardener" class=logo><ul class=media-wr><li><a target=_blank href=https://kubernetes.slack.com/archives/CB57N0BFG><img src=/images/branding/slack-logo-white.svg class=media-icon><div class=media-text>Slack</div></a></li><li><a target=_blank href=https://github.com/gardener><img src=/images/branding/github-mark-logo.png class=media-icon><div class=media-text>GitHub</div></a></li><li><a target=_blank href=https://www.youtube.com/channel/UCwUhwKFREV8Su0gwAJQX7tw><img src=/images/branding/youtube-logo-dark.svg class=media-icon><div class=media-text>YouTube</div></a></li><li><a target=_blank href=https://x.com/GardenerProject><img src=/images/branding/x-logo-white.svg class=media-icon><div class=media-text>X</div></a></li></ul><span class=copyright>Copyright 2019-2025 Gardener project authors.
<a href=https://www.sap.com/about/legal/terms-of-use.html>Terms of Use
<i class="fa fa-external-link" aria-hidden=true></i>
</a>|
<a href=https://www.sap.com/about/legal/terms-of-use.html>Privacy Statement
<i class="fa fa-external-link" aria-hidden=true></i>
</a>|
<a href=https://www.sap.com/about/legal/terms-of-use.html>Legal Disclosure
<i class="fa fa-external-link" aria-hidden=true></i></a></span></div></footer></div><script src=/js/main.min.69e2c1ae9320465ab10236d9ef752c6a4442c54b48b883b17c497b7c7d96a796.js integrity="sha256-aeLBrpMgRlqxAjbZ73UsakRCxUtIuIOxfEl7fH2Wp5Y=" crossorigin=anonymous></script><script defer src=/js/click-to-copy.min.73478a7d4807698aed7e355eb23f9890ca18fea3158604c8471746d046702bad.js integrity="sha256-c0eKfUgHaYrtfjVesj+YkMoY/qMVhgTIRxdG0EZwK60=" crossorigin=anonymous></script><script src=/js/tabpane-persist.js></script></body></html>