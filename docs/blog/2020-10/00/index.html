<!doctype html><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Project Gardener Website - A Managed Kubernetes Service Done Right"><meta name=copyright content="Copyright 2019-2021 Gardener project authors."><meta name=google-site-verification content="9EoGiMwk2aq0E_tVh16iJgJbp7fbyqkfWH9b5sGybl0"><title>Gardener Integrates with KubeVirt :: Gardener</title><link rel=icon type=image/x-icon href=https://gardener.cloud/images/favicon.ico><link rel=icon type=image/png href=https://gardener.cloud/images/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=https://gardener.cloud/images/favicon-16x16.png sizes=16x16><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-W2FGNSX');</script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','UA-165447164-1');</script><link href=/css/font-awesome.min.css?1617038134 rel=stylesheet><link href=/css/skeleton.css?1617038134 rel=stylesheet><link rel=preload href=/fonts/sap-icofonts/sap-icofonts.woff as=font type=font/woff crossorigin=anonymous><link rel=preload href=/fonts/sapcom-icons/sapcom-icons.woff as=font type=font/woff crossorigin=anonymous><link rel=stylesheet href=/css/sapcom-icons.css><link rel=stylesheet href=/css/normalize.css><link rel=stylesheet href=/css/gardener.b459b7f22c26be8e2f608a181d5372c6e44f06cf007c350346ccf5fadbe04a74.css><script src=/js/moment.js?1617038134></script><script src=/js/inlineSVG.js?1617038134></script><script src=/js/jquery.min.js?1617038134></script><script src=/jquery-ui-1.12.1/jquery-ui.min.js?1617038134></script><script src=/js/fixed.js?1617038134></script><script src=/js/clipboard.min.js?1617038134></script><script src=https://platform.linkedin.com/in.js type=text/javascript>lang:en_US</script></head><body data-url=/blog/2020-10/00/ class=has-sticky-navigation><script>$(document).ready(function(){function initStickyNav(){var stickyPoint;var tln=document.querySelector(".tln");if(!tln){return;}
var stickyPointEl=document.querySelector(".sticky-nav-point");if(stickyPointEl==null){stickyPointEl=document.querySelector("body");stickyPoint=0;}else{stickyPoint=stickyPointEl.clientHeight+stickyPointEl.offsetTop;}
var bodySelector=document.getElementsByTagName("body")[0];var tlnHeight=tln.clientHeight;var stickyNavigation=function(){if(window.pageYOffset+tlnHeight>=stickyPoint){bodySelector.classList.add("has-sticky-navigation");tln.classList.add("sticky-top");}else{bodySelector.classList.remove("has-sticky-navigation");tln.classList.remove("sticky-top");}}
window.onscroll=function(){stickyNavigation();};}
initStickyNav();function closeAllSelect(){document.getElementById("docOptions").classList.remove("show");}
function show(e){e.stopPropagation();document.getElementById("docOptions").classList.add("show");}
document.addEventListener("click",closeAllSelect);document.getElementById("docSelector").addEventListener("click",show);});</script><div class="tln fixedsticky sticky-top"><header class=navigation><div class=container><div class=navigation-wrapper><a href=/ class=logo><img src=/images/gardener-logo.svg>
<span class=title>Gardener</span></a>
<a class="nav-button navbar-toggler" href=#><i class="fa fa-bars"></i></a><div class=navbar-collapse><ul class=links><li class="link active"><a href=/blog/>Blogs</a></li><li class=link><a href=/community/>Community</a></li><li class=link><a href=/adopter/>Adopters</a></li><li class="link has-child"><a href=/documentation/home>Documentation</a></li></ul></div></div></div></header></div><script>$(".navigation .navbar-toggler").click(function(evt){$(".navigation .navbar-collapse").toggle();$(".navigation").toggleClass("collapsed");$(".navigation .search-box").toggle();})</script><style>#docSelector{cursor:pointer}.doc-options{position:fixed;background-color:#0b8062;text-align:left;display:none}.doc-options ul li{margin-bottom:0}.doc-options ul li a:hover{background-color:#0c694f}.doc-options ul{list-style:none;padding:0;margin:0;text-align:left}.doc-options ul li a{padding:10px;margin:0}.doc-options .activeVersion{background-color:#ec682a}.show{display:block}</style><div style=height:var(--sln-height)></div><div class="main container"><section><div class="highlightable body-inner-wrapper"><div id=body-inner><script src=/js/moment.js></script><div class="blogs page"><a href=/blog class="nav-link back">Back to Blogs</a><article class="post row" data-path><div class=wrapper><div class="two columns"><ul class=authors><li class=author><a href=mailto:s.rachev@sap.com><img src="https://avatars3.githubusercontent.com/u/1867702?v=4" class="user-icon icons" alt="blog author avatar">
<span class=name>Stoyan Rachev</span></a></li><li class=author><a href=mailto:donka.dimitrova@sap.com><img src="https://avatars1.githubusercontent.com/u/42462598?v=4" class="user-icon icons" alt="blog author avatar">
<span class=name>Donka Dimitrova</span></a></li><li class=author><a href=mailto:marcin0franczyk@gmail.com><img src="https://avatars1.githubusercontent.com/u/27352691?v=4" class="user-icon icons" alt="blog author avatar">
<span class=name>Marcin Franczyk</span></a></li><li class=author><a href=mailto:moad.qassem@gmail.com><img src="https://avatars0.githubusercontent.com/u/4427629?v=4" class="user-icon icons" alt="blog author avatar">
<span class=name>Moath Qasim</span></a></li></ul><span class=publishdate data-publishdate=2020-10-19>2020-10-19</span></div><div class="ten columns"><h2>Gardener Integrates with KubeVirt<a href=/blog/2020-10/00/ class="title-link clipboard-copy"><i class="fa fa-link"></i></a></h2><div class=share-ribbon><a href="https://twitter.com/share?ref_src=twsrc%5Etfw" class=twitter-share-button data-text="Gardener Integrates with KubeVirt" data-url=https://gardener.cloud/blog/2020-10/00/ data-hashtags=GardenerProject data-dnt=true data-show-count=false>Tweet</a><script async src=https://platform.twitter.com/widgets.js></script>
<script type=in/share data-url=https://gardener.cloud/blog/2020-10/00/></script></div><p><p>The Gardener team is happy to announce that <a href=https://gardener.cloud>Gardener</a> now offers support for an additional, often requested, infrastructure/virtualization technology, namely <a href=https://kubevirt.io/>KubeVirt</a>! Gardener can now provide <a href=https://github.com/cncf/k8s-conformance>Kubernetes-conformant</a> clusters using KubeVirt managed Virtual Machines in the environment of your choice. This integration has been tested and works with any qualified Kubernetes (provider) cluster that is compatibly configured to host the required KubeVirt components, in particular for example <a href=https://www.openshift.com/blog/openshift-virtualization-containers-kvm-and-your-vms>Red Hat OpenShift Virtualization</a>.</p><p>Gardener enables Kubernetes consumers to centralize and operate efficiently homogenous Kubernetes clusters across different IaaS providers and even private environments. This way the same cloud-based application version can be hosted and operated by its vendor or consumer on a variety of infrastructures. When a new customer or your development team demands for a new infrastructure provider, Gardener helps you to quickly and easily on-board your workload. Furthermore, on this new infrastructure, Gardener keeps the seamless Kubernetes management experience for your Kubernetes operators, while upholding the consistency of the CI/CD pipeline of your software development team.</p><h2 id=architecture-and-workflow>Architecture and Workflow</h2><p>Gardener is based on the idea of three types of clusters – <em>Garden cluster</em>, <em>Seed cluster</em> and <em>Shoot cluster</em> (see <strong>Figure 1</strong>). The Garden cluster is used to control the entire Kubernetes environment centrally in a highly scalable design. The highly available seed clusters are used to host the end users (shoot) clusters’ control planes. Finally, the shoot clusters consist only of worker nodes to host the cloud native applications.</p><img title="Gardener Architecture" src=../../../__resources/0bbaeea9-44e8-4220-b1a8-4f3156300dfc.png style=width:90%;height:auto><figcaption style=text-align:center;margin-top:-25px;margin-bottom:30px;font-size:90%>Figure 1: Gardener Architecture</figcaption><p>An integration of the Gardener open source project with a new cloud provider follows a standard <a href=../../../documentation/concepts/extensions/overview>Gardener extensibility</a> approach. The integration requires two new components: a <a href=../../../documentation/concepts/extensions/overview>provider extension</a> and a <a href=https://github.com/gardener/machine-controller-manager/blob/master/docs/development/cp_support_new.md>Machine Controller Manager (MCM) extension</a>. Both components together enable Gardener to instruct the new cloud provider. They run in the Gardener seed clusters that host the control planes of the shoots based on that cloud provider. The role of the provider extension is to manage the provider-specific aspects of the shoot clusters’ lifecycle, including infrastructure, control plane, worker nodes, and others. It works in cooperation with the MCM extension, which in particular is responsible to handle machines that are provisioned as worker nodes for the shoot clusters. To get this job done, the MCM extension leverages the VM management/API capabilities available with the respective cloud provider.</p><p>Setting up a Kubernetes cluster always involves a flow of interdependent steps (see <strong>Figure 2</strong>), beginning with the generation of certificates and preparation of the infrastructure, continuing with the provisioning of the control plane and the worker nodes, and ending with the deployment of system components. Gardener can be configured to utilize the KubeVirt extensions in its generic workflow at the right extension points, and deliver the desired outcome of a KubeVirt backed cluster.</p><img title="Gardener Architecture" src=../../../__resources/5c3520b1-60e2-4813-aed3-efae05a3cdf1.png style=width:90%;height:auto><figcaption style=text-align:center;margin-top:-25px;margin-bottom:30px;font-size:90%>Figure 2: Generic cluster reconciliation flow with extension points</figcaption><h3 id=gardener-integration-with-kubevirt-in-detail>Gardener Integration with KubeVirt in Detail</h3><p>Integration with KubeVirt follows the Gardener extensibility concept and introduces the two new components mentioned above: the <a href=https://github.com/gardener/gardener-extension-provider-kubevirt>KubeVirt Provider Extension</a> and the <a href=https://github.com/gardener/machine-controller-manager-provider-kubevirt>KubeVirt Machine Controller Manager (MCM) Extension</a>.</p><img title="Gardener integration with KubeVirt" src=../../../__resources/faf2365b-39fe-46bf-bc07-6799954dbd91.png style=width:80%;height:auto><figcaption style=text-align:center;margin-top:-25px;margin-bottom:30px;font-size:90%>Figure 3: Gardener integration with KubeVirt</figcaption><p>The KubeVirt Provider Extension consists of three separate controllers that handle respectively the infrastructure, the control plane, and the worker nodes of the shoot cluster.</p><p>The <strong>Infrastructure Controller</strong> configures the network communication between the shoot worker nodes. By default, shoot worker nodes only use the provider cluster’s pod network. To achieve higher level of network isolation and better performance, it is possible to add more networks and replace the default pod network with a different network using container network interface (CNI) plugins available in the provider cluster. This is currently based on <a href=https://github.com/intel/multus-cni/blob/master/README.md>Multus CNI</a> and <a href=https://github.com/intel/multus-cni/blob/master/doc/quickstart.md>NetworkAttachmentDefinitions</a>.</p><p>Example infrastructure configuration in a shoot definition:</p><div class=highlight><pre class=chroma><code class=language-yaml data-lang=yaml><span class=nt>provider</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>kubevirt</span><span class=w>
</span><span class=w>  </span><span class=nt>infrastructureConfig</span><span class=p>:</span><span class=w>
</span><span class=w>    </span><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>kubevirt.provider.extensions.gardener.cloud/v1alpha1</span><span class=w>
</span><span class=w>    </span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>InfrastructureConfig</span><span class=w>
</span><span class=w>    </span><span class=nt>networks</span><span class=p>:</span><span class=w>
</span><span class=w>      </span><span class=nt>tenantNetworks</span><span class=p>:</span><span class=w>
</span><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>network-1</span><span class=w>
</span><span class=w>        </span><span class=nt>config</span><span class=p>:</span><span class=w> </span><span class=p>|</span><span class=sd>
</span><span class=sd>          {
</span><span class=sd>            &#34;cniVersion&#34;: &#34;0.4.0&#34;,
</span><span class=sd>            &#34;name&#34;: &#34;bridge-firewall&#34;,
</span><span class=sd>            &#34;plugins&#34;: [
</span><span class=sd>              {
</span><span class=sd>                &#34;type&#34;: &#34;bridge&#34;,
</span><span class=sd>                &#34;isGateway&#34;: true,
</span><span class=sd>                &#34;isDefaultGateway&#34;: true,
</span><span class=sd>                &#34;ipMasq&#34;: true,
</span><span class=sd>                &#34;ipam&#34;: {
</span><span class=sd>                  &#34;type&#34;: &#34;host-local&#34;,
</span><span class=sd>                  &#34;subnet&#34;: &#34;10.100.0.0/16&#34;
</span><span class=sd>                }
</span><span class=sd>              },
</span><span class=sd>              {
</span><span class=sd>                &#34;type&#34;: &#34;firewall&#34;
</span><span class=sd>              }
</span><span class=sd>            ]
</span><span class=sd>          }</span><span class=w>          
</span><span class=w>        </span><span class=nt>default</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></code></pre></div><p>The <strong>Control Plane Controller</strong> deploys a <em>Cloud Controller Manager (CCM)</em>. This is a Kubernetes control plane component that embeds cloud-specific control logic. As any other CCM, it runs the Node controller that is responsible for initializing Node objects, annotating and labeling them with cloud-specific information, obtaining the node’s hostname and IP addresses, and verifying the node’s health. It also runs the Service controller that is responsible for setting up load balancers and other infrastructure components for Service resources that require them.</p><p>Finally, the <strong>Worker Controller</strong> is responsible for managing the worker nodes of the Gardener shoot clusters.</p><p>Example worker configuration in a shoot definition:</p><div class=highlight><pre class=chroma><code class=language-yaml data-lang=yaml><span class=nt>provider</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>kubevirt</span><span class=w>
</span><span class=w>  </span><span class=nt>workers</span><span class=p>:</span><span class=w>
</span><span class=w>  </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>cpu-worker</span><span class=w>
</span><span class=w>    </span><span class=nt>minimum</span><span class=p>:</span><span class=w> </span><span class=m>1</span><span class=w>
</span><span class=w>    </span><span class=nt>maximum</span><span class=p>:</span><span class=w> </span><span class=m>2</span><span class=w>
</span><span class=w>    </span><span class=nt>machine</span><span class=p>:</span><span class=w>
</span><span class=w>      </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>standard-1</span><span class=w>
</span><span class=w>      </span><span class=nt>image</span><span class=p>:</span><span class=w>
</span><span class=w>        </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>ubuntu</span><span class=w>
</span><span class=w>        </span><span class=nt>version</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;18.04&#34;</span><span class=w>
</span><span class=w>    </span><span class=nt>volume</span><span class=p>:</span><span class=w>
</span><span class=w>      </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>default</span><span class=w>
</span><span class=w>      </span><span class=nt>size</span><span class=p>:</span><span class=w> </span><span class=l>20Gi</span><span class=w>
</span><span class=w>    </span><span class=nt>zones</span><span class=p>:</span><span class=w>
</span><span class=w>    </span>- <span class=l>europe-west1-c</span><span class=w>
</span></code></pre></div><p>For more information about configuring the KubeVirt Provider Extension as an end-user, see <a href=https://github.com/gardener/gardener-extension-provider-kubevirt/blob/master/docs/usage-as-end-user.md>Using the KubeVirt provider extension with Gardener as end-user</a>.</p><h3 id=enabling-your-gardener-setup-to-leverage-a-kubevirt-compatible-environment>Enabling Your Gardener Setup to Leverage a KubeVirt Compatible Environment</h3><p>The very first step required is to define the machine types (VM types) for VMs that will be available. This is achieved via the <code>CloudProfile</code> custom resource. The machine types configuration includes details such as CPU, GPU, memory, OS image, and more.</p><p>Example <code>CloudProfile</code> custom resource:</p><div class=highlight><pre class=chroma><code class=language-yaml data-lang=yaml><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>core.gardener.cloud/v1beta1</span><span class=w>
</span><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>CloudProfile</span><span class=w>
</span><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>kubevirt</span><span class=w>
</span><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>kubevirt</span><span class=w>
</span><span class=w>  </span><span class=nt>providerConfig</span><span class=p>:</span><span class=w>
</span><span class=w>    </span><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>kubevirt.provider.extensions.gardener.cloud/v1alpha1</span><span class=w>
</span><span class=w>    </span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>CloudProfileConfig</span><span class=w>
</span><span class=w>    </span><span class=nt>machineImages</span><span class=p>:</span><span class=w>
</span><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>ubuntu</span><span class=w>
</span><span class=w>      </span><span class=nt>versions</span><span class=p>:</span><span class=w>
</span><span class=w>      </span>- <span class=nt>version</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;18.04&#34;</span><span class=w>
</span><span class=w>        </span><span class=nt>sourceURL</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;https://cloud-images.ubuntu.com/bionic/current/bionic-server-cloudimg-amd64.img&#34;</span><span class=w>
</span><span class=w>  </span><span class=nt>kubernetes</span><span class=p>:</span><span class=w>
</span><span class=w>    </span><span class=nt>versions</span><span class=p>:</span><span class=w>
</span><span class=w>    </span>- <span class=nt>version</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;1.18.5&#34;</span><span class=w>
</span><span class=w>  </span><span class=nt>machineImages</span><span class=p>:</span><span class=w>
</span><span class=w>  </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>ubuntu</span><span class=w>
</span><span class=w>    </span><span class=nt>versions</span><span class=p>:</span><span class=w>
</span><span class=w>    </span>- <span class=nt>version</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;18.04&#34;</span><span class=w>
</span><span class=w>  </span><span class=nt>machineTypes</span><span class=p>:</span><span class=w>
</span><span class=w>  </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>standard-1</span><span class=w>
</span><span class=w>    </span><span class=nt>cpu</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;1&#34;</span><span class=w>
</span><span class=w>    </span><span class=nt>gpu</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;0&#34;</span><span class=w>
</span><span class=w>    </span><span class=nt>memory</span><span class=p>:</span><span class=w> </span><span class=l>4Gi</span><span class=w>
</span><span class=w>  </span><span class=nt>volumeTypes</span><span class=p>:</span><span class=w>
</span><span class=w>  </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>default</span><span class=w>
</span><span class=w>    </span><span class=nt>class</span><span class=p>:</span><span class=w> </span><span class=l>default</span><span class=w>
</span><span class=w>  </span><span class=nt>regions</span><span class=p>:</span><span class=w>
</span><span class=w>  </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>europe-west1</span><span class=w>
</span><span class=w>    </span><span class=nt>zones</span><span class=p>:</span><span class=w>
</span><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>europe-west1-b</span><span class=w>
</span><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>europe-west1-c</span><span class=w>
</span><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>europe-west1-d</span><span class=w>
</span></code></pre></div><p>Once a machine type is defined, it can be referenced in shoot definitions. This information is used by the KubeVirt Provider Extension to generate <code>MachineDeployment</code> and <code>MachineClass</code> custom resources required by the KubeVirt MCM extension for managing the worker nodes of the shoot clusters during the reconciliation process.</p><p>For more information about configuring the KubeVirt Provider Extension as an operator, see <a href=https://github.com/gardener/gardener-extension-provider-kubevirt/blob/master/docs/usage-as-operator.md>Using the KubeVirt provider extension with Gardener as operator</a>.</p><h3 id=kubevirt-machine-controller-manager-mcm-extension>KubeVirt Machine Controller Manager (MCM) Extension</h3><p>The <a href=https://github.com/gardener/machine-controller-manager-provider-kubevirt>KubeVirt MCM Extension</a> is responsible for managing the VMs that are used as worker nodes of the Gardener shoot clusters using the virtualization capabilities of KubeVirt. This extension handles all necessary lifecycle management activities, such as machines creation, fetching, updating, listing, and deletion.</p><p>The KubeVirt MCM Extension implements the Gardener’s common <a href=https://github.com/gardener/machine-controller-manager/blob/master/pkg/util/provider/driver/driver.go>driver interface</a> for managing VMs in different cloud providers. As already mentioned, the KubeVirt MCM Extension is using the <code>MachineDeployments</code> and <code>MachineClasses</code> – an abstraction layer that follows the Kubernetes native declarative approach - to get instructions from the KubeVirt Provider Extension about the required machines for the shoot worker nodes. Also, the cluster austoscaler integrates with the <code>scale</code> subresource of the <code>MachineDeployment</code> resource. This way, Gardener offers a homogeneous autoscaling experience across all supported providers.</p><p>When a new shoot cluster is created or when a new worker node is needed for an existing shoot cluster, a new <a href=https://github.com/gardener/machine-controller-manager-provider-kubevirt/blob/master/kubernetes/machine.yaml>Machine</a> will be created, and at that time, the KubeVirt MCM extension will create a new KubeVirt <code>VirtualMachine</code> in the provider cluster. This <code>VirtualMachine</code> will be created based on a set of configurations in the <a href=https://github.com/gardener/machine-controller-manager-provider-kubevirt/blob/master/kubernetes/machine-class.yaml>MachineClass</a> that follows the <a href=https://github.com/gardener/machine-controller-manager-provider-kubevirt/blob/master/pkg/kubevirt/apis/provider_spec.go>specification</a> of the KubeVirt provider.</p><p>The KubeVirt MCM Extension has two main components. The <strong>MachinePlugin</strong> is responsible for handling the machine objects, and the <strong>PluginSPI</strong> is in charge of making calls to the cloud provider interface, to manage its resources.</p><img title="KubeVirt MCM extension workflow and architecture" src=../../../__resources/8fcf0f83-7de3-4c10-a094-f271fd77b257.png style=width:60%;height:auto><figcaption style=text-align:center;margin-top:-25px;margin-bottom:30px;font-size:90%>Figure 4: KubeVirt MCM extension workflow and architecture</figcaption><p>As shown in <strong>Figure 4</strong>, the MachinePlugin receives a machine request from the MCM and starts its processing by decoding the request, doing partial validation, extracting the relevant information, and sending it to the PluginSPI.</p><p>The PluginSPI then creates, gets, or deletes <code>VirtualMachines</code> depending on the method called by the MachinePlugin. It extracts the kubeconfig of the provider cluster and handles all other required KubeVirt resources such as the secret that holds the <code>cloud-init</code> configurations, and <code>DataVolumes</code> that are mounted as disks to the VMs.</p><h3 id=supported-environments>Supported Environments</h3><p>The Gardener KubeVirt support is currently qualified on:</p><ul><li><a href=https://kubevirt.io/2020/changelog-v0.32.0.html>KubeVirt v0.32.0</a> (and later)</li><li><a href=https://docs.openshift.com/container-platform/4.4/welcome/index.html>Red Hat OpenShift Container Platform 4.4</a> (and later)</li></ul><p>There are also plans for further improvements and new features, for example integration with CSI drivers for storage management. Details about the implementation progress can be found in the <a href=https://github.com/gardener/gardener-extension-provider-kubevirt/issues>Gardener project on GitHub</a>.</p><p>You can find further resources about the open source project Gardener at <a href=https://gardener.cloud>https://gardener.cloud</a>.</p></p></div></div></article><a href=/blog class="nav-link back">Back to Blogs</a></div></div></div><div style=height:var(--feedback-height-total)></div></section></div><style></style><footer class=footer><div class="container footer-wrapper"><ul class=nav><li><a href=/blog/>Blogs</a></li><li><a href=/community/>Community</a></li><li><a href=/adopter/>Adopters</a></li><li><a href=/documentation/home>Documentation</a></li></ul><img src=/images/lp/gardener-logo.svg alt="Logo Gardener" class=logo><ul class=media-wr><li><a target=_blank href=https://kubernetes.slack.com/archives/CB57N0BFG><img src=/images/branding/slack-logo-white.svg class=media-icon><div class=media-text>Slack</div></a></li><li><a target=_blank href=https://github.com/gardener><img src=/images/branding/github-mark-logo.png class=media-icon><div class=media-text>GitHub</div></a></li><li><a target=_blank href=https://www.youtube.com/channel/UCwUhwKFREV8Su0gwAJQX7tw><img src=/images/branding/youtube-logo-dark.svg class=media-icon><div class=media-text>YouTube</div></a></li><li><a target=_blank href=https://twitter.com/GardenerProject><img src=/images/branding/twitter-logo-white.svg class=media-icon><div class=media-text>Twitter</div></a></li></ul><span class=copyright>Copyright 2019-2021 Gardener project authors. <a href=https://www.sap.com/corporate/en/legal/privacy.html>Privacy policy
<i class="fa fa-external-link" aria-hidden=true></i></a></span></div></footer><script src=/js/jquery.sticky.js?1617038134></script><script src=/js/modernizr.custom.min.js?1617038134></script><script src=/js/code-snippets.js?1617038134></script><script>$(document).ready(function(){inlineSVG.init();$("[data-publishdate]").each(function(){$(this).text(moment($(this,"YYYY-MM-DD","YYYY-MM-DD hh:mm:ss").attr("data-publishdate")).fromNow());});new ClipboardJS('.clipboard-copy');$("body").codeSnippets();});</script><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-W2FGNSX" height=0 width=0 style=display:none;visibility:hidden></iframe></noscript><script src=/js/modernizr.custom.min.js></script><script src=/js/jsrender.min.js></script><script src=/js/main.js></script><script>$(document).ready(function(){$('.blogs .clipboard-copy').click(function(e){e.preventDefault();});})</script></body></html>