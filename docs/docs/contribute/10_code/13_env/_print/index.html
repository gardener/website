<!doctype html><html lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.83.1"><link rel=canonical type=text/html href=https://gardener.cloud/docs/contribute/10_code/13_env/><link rel=alternate type=application/rss+xml href=https://gardener.cloud/docs/contribute/10_code/13_env/index.xml><meta name=ROBOTS content="NOINDEX, NOFOLLOW"><link rel=icon type=image/x-icon href=https://gardener.cloud/images/favicon.ico><link rel=icon type=image/png href=https://gardener.cloud/images/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=https://gardener.cloud/images/favicon-16x16.png sizes=16x16><title>Environment | Gardener</title><meta name=description content="Project Gardener Website - A Managed Kubernetes Service Done Right"><meta property="og:title" content="Environment"><meta property="og:description" content="Project Gardener Website - A Managed Kubernetes Service Done Right"><meta property="og:type" content="website"><meta property="og:url" content="https://gardener.cloud/docs/contribute/10_code/13_env/"><meta itemprop=name content="Environment"><meta itemprop=description content="Project Gardener Website - A Managed Kubernetes Service Done Right"><meta name=twitter:card content="summary"><meta name=twitter:title content="Environment"><meta name=twitter:description content="Project Gardener Website - A Managed Kubernetes Service Done Right"><link rel=preload href=/scss/main.min.122f9effc36493edf1f25030c2ce7965b16b3b0eaeb02528b9a50e0fa9110c15.css as=style><link href=/scss/main.min.122f9effc36493edf1f25030c2ce7965b16b3b0eaeb02528b9a50e0fa9110c15.css rel=stylesheet integrity><script src=https://code.jquery.com/jquery-3.5.1.min.js integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin=anonymous></script><script src=https://unpkg.com/lunr@2.3.8/lunr.min.js integrity=sha384-vRQ9bDyE0Wnu+lMfm57BlYLO0/XauFuKpVsZPs7KEDwYKktWi5+Kz3MP8++DFlRY crossorigin=anonymous></script></head><body class=td-section><header><nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar"><a class=navbar-brand href=/><span class=navbar-logo><svg width="90" height="90" viewBox="0 0 90 90" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>logo</title><desc>Created with Sketch.</desc><defs><path d="M41.8864954.994901575c.996545099999999-.479910833 2.6164002-.477918931 3.6088091.0L76.8159138 16.0781121C77.8124589 16.5580229 78.8208647 17.8257185 79.0659694 18.8995926l7.7355517 33.8916663C87.0476474 53.8696088 86.6852538 55.4484075 85.9984855 56.3095876L64.3239514 83.4885938C63.6343208 84.3533632 62.1740175 85.0543973 61.0725268 85.0543973H26.3092731c-1.1060816.0-2.5646564-.704623400000003-3.2514246-1.5658035L1.38331434 56.3095876C.693683723 55.4448182.335174016 53.865133.580278769 52.7912589L8.31583044 18.8995926C8.56195675 17.8212428 9.57347722 16.556031 10.5658861 16.0781121L41.8864954.994901575z" id="path-1"/><linearGradient x1="12.7542673%" y1="-18.6617048%" x2="88.2666158%" y2="84.6075483%" id="linearGradient-3"><stop stop-color="#fff" offset="0"/><stop stop-color="#439246" offset="100%"/></linearGradient><linearGradient x1="50%" y1="4.93673768%" x2="148.756007%" y2="175.514523%" id="linearGradient-4"><stop stop-color="#fff" offset="0"/><stop stop-color="#439246" offset="100%"/></linearGradient><linearGradient x1="19.1574381%" y1="-9.04800713%" x2="82.2203149%" y2="77.9084293%" id="linearGradient-5"><stop stop-color="#fff" offset="0"/><stop stop-color="#439246" offset="100%"/></linearGradient><linearGradient x1="57.4403751%" y1="26.3148481%" x2="137.966711%" y2="158.080556%" id="linearGradient-6"><stop stop-color="#fff" offset="0"/><stop stop-color="#439246" offset="100%"/></linearGradient></defs><g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="logo"><g id="Rectangle-2" transform="translate(1.000000, 0.000000)"><mask id="mask-2" fill="#fff"><use xlink:href="#path-1"/></mask><use id="Mask" fill="#009f76" xlink:href="#path-1"/><polygon fill="#000" opacity=".289628623" mask="url(#mask-2)" points="-17.6484375 54.5224609 30.8242188 25.0791016 63.4726562 58.5 24.7324219 92.6689453"/></g><path d="M56.8508631 39.260019C56.4193519 40.443987 55.6088085 41.581593 54.6736295 42.1938694l-8.0738997 5.2861089c-1.3854671.907087099999998-3.6247515.9116711-5.0172201.0L33.50861 42.1938694C32.123143 41.2867823 31 39.206345 31 37.545932V26.4150304c0-.725313.2131118-1.5301454.569268099999999-2.2825772L56.8508631 39.260019z" id="Combined-Shape" fill="url(#linearGradient-3)" transform="translate(43.925432, 36.147233) scale(-1, 1) translate(-43.925432, -36.147233)"/><path d="M56.0774672 25.1412464C56.4306829 25.8903325 56.6425556 26.6907345 56.6425556 27.4119019V38.5428034c0 1.6598979-1.1161415 3.73626640000001-2.50861 4.6479374l-8.0738997 5.286109c-1.3854671.907087000000004-3.6247516.911671000000005-5.0172201.0L32.9689261 43.1907408C32.2918101 42.7474223 31.6773514 42.0238435 31.2260376 41.206007L56.0774672 25.1412464z" id="Combined-Shape" fill="url(#linearGradient-4)" transform="translate(43.821278, 37.246598) scale(-1, 1) translate(-43.821278, -37.246598)"/><path d="M65.0702134 57.1846889C64.5985426 58.2007851 63.8367404 59.1236871 62.9788591 59.6189851L47.37497 68.6278947c-1.4306165.825966800000003-3.75236779999999.8246599-5.1807206.0L26.5903603 59.6189851C25.1597438 58.7930183 24 56.7816693 24 55.1323495V37.1145303C24 36.3487436 24.249712 35.5060005 24.6599102 34.7400631L65.0702134 57.1846889z" id="Combined-Shape" fill="url(#linearGradient-5)"/><path d="M65.0189476 34.954538C65.3636909 35.6617313 65.5692194 36.42021 65.5692194 37.1145303V55.1323495C65.5692194 56.7842831 64.4072119 58.7943252 62.9788591 59.6189851L47.37497 68.6278947c-1.4306165.825966800000003-3.75236779999999.8246599-5.1807206.0L26.5903603 59.6189851C25.9237304 59.2341061 25.3159155 58.5918431 24.8568495 57.8487596L65.0189476 34.954538z" id="Combined-Shape" fill="url(#linearGradient-6)"/></g></g></svg></span><span class=text-capitalize>Gardener</span></a><div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar><ul class="navbar-nav mt-2 mt-lg-0"><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/adopter><span>Adopters</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/blog><span>Blogs</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/community><span>Community</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/docs><span>Documentation</span></a></li></ul></div><div class="navbar-nav d-none d-lg-block"><input type=search class="form-control td-search-input" placeholder="&#xf002; Search this site‚Ä¶" aria-label="Search this site‚Ä¶" autocomplete=off data-offline-search-index-json-src=/offline-search-index.01c431eef5806e45bfedaa944128ebb3.json data-offline-search-base-href=/ data-offline-search-max-results=10></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><div class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"></div><div class="d-none d-xl-block col-xl-2 td-toc d-print-none"></div><main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main><div class=td-content><div class="pageinfo pageinfo-primary d-print-none"><p>This the multi-page printable view of this section.
<a href=# onclick="return print(),!1">Click here to print</a>.</p><p><a href=/docs/contribute/10_code/13_env/>Return to the regular view of this page</a>.</p></div><h1 class=title>Environment</h1><div class=content><h1 id=preparing-the-setup>Preparing the Setup</h1><p>Conceptually, all Gardener components are designated to run inside as a Pod inside a Kubernetes cluster.
The API server extends the Kubernetes API via the user-aggregated API server concepts.
However, if you want to develop it, you may want to work locally with the Gardener without building a Docker image and deploying it to a cluster each and every time.
That means that the Gardener runs outside a Kubernetes cluster which requires providing a <a href=https://kubernetes.io/docs/tasks/access-application-cluster/authenticate-across-clusters-kubeconfig/>Kubeconfig</a> in your local filesystem and point the Gardener to it when starting it (see below).</p><p>Further details could be found in</p><ol><li><a href=https://kubernetes.io/docs/concepts/>Principles of Kubernetes</a>, and its <a href=https://kubernetes.io/docs/concepts/overview/components/>components</a></li><li><a href=https://github.com/kubernetes/community/tree/master/contributors/devel>Kubernetes Development Guide</a></li><li><a href=https://github.com/gardener/documentation/wiki/Architecture.md>Architecture of Gardener</a></li></ol><p>This setup is based on <a href=https://github.com/kubernetes/minikube>minikube</a>, a Kubernetes cluster running on a single node. Docker for Desktop and <a href=https://github.com/kubernetes-sigs/kind>kind</a> are also supported.</p><h2 id=installing-golang-environment>Installing Golang environment</h2><p>Install latest version of Golang. For MacOS you could use <a href=https://brew.sh/>Homebrew</a>:</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>brew install golang
</code></pre></div><p>For other OS, please check <a href=https://golang.org/doc/install>Go installation documentation</a>.</p><h2 id=installing-kubectl-and-helm>Installing kubectl and helm</h2><p>As already mentioned in the introduction, the communication with the Gardener happens via the Kubernetes (Garden) cluster it is targeting. To interact with that cluster, you need to install <code>kubectl</code>. Please make sure that the version of <code>kubectl</code> is at least <code>v1.11.x</code>.</p><p>On MacOS run</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>brew install kubernetes-cli
</code></pre></div><p>Please check the <a href=https://kubernetes.io/docs/tasks/tools/install-kubectl/>kubectl installation documentation</a> for other OS.</p><p>You may also need to develop Helm charts or interact with Tiller using the <a href=https://github.com/kubernetes/helm>Helm</a> CLI:</p><p>On MacOS run</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>brew install kubernetes-helm
</code></pre></div><p>On other OS please check the <a href=https://github.com/kubernetes/helm/blob/master/docs/install.md>Helm installation documentation</a>.</p><h2 id=installing-git>Installing git</h2><p>We use <code>git</code> as VCS which you need to install.</p><p>On MacOS run</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>brew install git
</code></pre></div><p>On other OS, please check the <a href=https://git-scm.com/book/en/v2/Getting-Started-Installing-Git>Git installation documentation</a>.</p><h2 id=installing-openvpn>Installing openvpn</h2><p>We use <code>OpenVPN</code> to establish network connectivity from the control plane running in the Seed cluster to the Shoot&rsquo;s worker nodes running in private networks.
To harden the security we need to generate another secret to encrypt the network traffic (<a href=https://openvpn.net/index.php/open-source/documentation/howto.html#security>details</a>).
Please install the <code>openvpn</code> binary. On MacOS run</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>brew install openvpn
<span class=nb>export</span> <span class=nv>PATH</span><span class=o>=</span><span class=k>$(</span>brew --prefix openvpn<span class=k>)</span>/sbin:<span class=nv>$PATH</span>
</code></pre></div><p>On other OS, please check the <a href=https://openvpn.net/index.php/open-source/downloads.html>OpenVPN downloads page</a>.</p><h2 id=installing-minikube>Installing Minikube</h2><p>You&rsquo;ll need to have <a href=https://github.com/kubernetes/minikube#installation>minikube</a> installed and running.</p><blockquote><p>Note: Gardener is working only with self-contained kubeconfig files because of <a href=https://banzaicloud.com/blog/kubeconfig-security/>security issue</a>. You can configure your minikube to create self-contained kubeconfig files via:</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>minikube config <span class=nb>set</span> embed-certs <span class=nb>true</span>
</code></pre></div></blockquote><p>Alternatively, you can also install Docker for Desktop and <a href=https://github.com/kubernetes-sigs/kind>kind</a>.</p><p>In case you want to use the &ldquo;Docker for Mac Kubernetes&rdquo; or if you want to build Docker images for the Gardener you have to install Docker itself. On MacOS, please use <a href=https://docs.docker.com/docker-for-mac/>Docker for MacOS</a> which can be downloaded <a href=https://download.docker.com/mac/stable/Docker.dmg>here</a>.</p><p>On other OS, please check the <a href=https://docs.docker.com/install/>Docker installation documentation</a>.</p><h2 id=installing-iproute2>Installing iproute2</h2><p><code>iproute2</code> provides a collection of utilities for network administration and configuration.</p><p>On MacOS run</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>brew install iproute2mac
</code></pre></div><h2 id=installing-yaml2json-and-jq>Installing yaml2json and jq</h2><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>go get -u github.com/bronze1man/yaml2json
brew install jq
</code></pre></div><h2 id=macos-only-install-gnu-core-utilities>[MacOS only] Install GNU core utilities</h2><p>When running on MacOS you have to install the GNU core utilities:</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>brew install coreutils gnu-sed
</code></pre></div><p>This will create symbolic links for the GNU utilities with <code>g</code> prefix in <code>/usr/local/bin</code>, e.g., <code>gsed</code> or <code>gbase64</code>. To allow using them without the <code>g</code> prefix please put <code>/usr/local/opt/coreutils/libexec/gnubin</code> at the beginning of your <code>PATH</code> environment variable, e.g., <code>export PATH=/usr/local/opt/coreutils/libexec/gnubin:$PATH</code>.</p><h2 id=windows-wsl2>[Windows] WSL2</h2><p>Apart from Linux distributions and MacOS, the local gardener setup can also run on the Windows Subsystem for Linux 2.</p><p>While WSL1, plain docker for windows and various Linux distributions and local Kubernetes environments may be supported, this setup was verified with:</p><ul><li><a href=https://docs.microsoft.com/en-us/windows/wsl/wsl2-index>WSL2</a></li><li><a href=https://docs.docker.com/docker-for-windows/wsl/>Docker Desktop WSL2 Engine</a></li><li><a href=https://ubuntu.com/blog/ubuntu-on-wsl-2-is-generally-available>Ubuntu 18.04 LTS on WSL2</a></li><li>Nodeless local garden (see below)</li></ul><p>The Gardener repository and all the above-mentioned tools (git, golang, kubectl, &mldr;) should be installed in your WSL2 distro, according to the distribution-specific Linux installation instructions.</p><h2 id=optional-installing-gcloud-sdk>[Optional] Installing gcloud SDK</h2><p>In case you have to create a new release or a new hotfix of the Gardener you have to push the resulting Docker image into a Docker registry. Currently, we are using the Google Container Registry (this could change in the future). Please follow the official <a href=https://cloud.google.com/sdk/downloads>installation instructions from Google</a>.</p><h2 id=local-gardener-setup>Local Gardener setup</h2><p>This setup is only meant to be used for developing purposes, which means that only the control plane of the Gardener cluster is running on your machine.</p><h3 id=get-the-sources>Get the sources</h3><p>Clone the repository from GitHub.</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>git clone git@github.com:gardener/gardener.git
<span class=nb>cd</span> gardener
</code></pre></div><h3 id=start-the-gardener>Start the Gardener</h3><p>:warning: Before you start developing, please ensure to comply with the following requirements:</p><ol><li>You have understood the <a href=https://kubernetes.io/docs/concepts/>principles of Kubernetes</a>, and its <a href=https://kubernetes.io/docs/concepts/overview/components/>components</a>, what their purpose is and how they interact with each other.</li><li>You have understood the <a href=https://github.com/gardener/documentation/wiki/Architecture.md>architecture of Gardener</a>, and what the various clusters are used for.</li></ol><h4 id=start-a-local-kubernetes-cluster>Start a local kubernetes cluster</h4><p>For the development of Gardener you need some kind of Kubernetes cluster, which can be used as a &ldquo;garden&rdquo; cluster.
I.e. you need a Kubernetes API server on which you can register a <code>APIService</code> Gardener&rsquo;s own Extension API Server.<br>For this you can use a standard tool from the community to setup a local cluster like minikube, kind or the Kubernetes Cluster feature in Docker for Desktop.</p><p>However, if you develop and run Gardener&rsquo;s components locally, you don&rsquo;t actually a fully fledged Kubernetes Cluster,
i.e. you don&rsquo;t actually need to run Pods on it. If you want to use a more lightweight approach for development purposes,
you can use the &ldquo;nodeless Garden cluster setup&rdquo; residing in <code>hack/local-garden</code>. This is the easiest way to get your
Gardener development setup up and running.</p><p><strong>Using the nodeless cluster setup</strong></p><p>Setting up a local nodeless Garden cluster is quite simple. The only prerequisite is a running docker daemon.
Just use the provided Makefile rules to start your local Garden:</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>make local-garden-up
<span class=o>[</span>...<span class=o>]</span>
Starting gardener-dev kube-etcd cluster..!
Starting gardener-dev kube-apiserver..!
Starting gardener-dev kube-controller-manager..!
Starting gardener-dev gardener-etcd cluster..!
namespace/garden created
clusterrole.rbac.authorization.k8s.io/gardener.cloud:admin created
clusterrolebinding.rbac.authorization.k8s.io/front-proxy-client created
<span class=o>[</span>...<span class=o>]</span>
</code></pre></div><p>This will start all minimally required components of a Kubernetes cluster (<code>etcd</code>, <code>kube-apiserver</code>, <code>kube-controller-manager</code>)
and an <code>etcd</code> Instance for the <code>gardener-apiserver</code> as Docker containers.</p><p>To tear down the local Garden cluster and remove the Docker containers, simply run:</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>make local-garden-down
</code></pre></div><p><strong>Using minikube</strong></p><p>Alternatively, spin up a cluster with minikube with this command:</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>minikube start --embed-certs <span class=c1>#  `--embed-certs` can be omitted if minikube has already been set to create self-contained kubeconfig files.</span>
üòÑ  minikube v1.8.2 on Darwin 10.15.3
üî•  Creating virtualbox VM <span class=o>(</span><span class=nv>CPUs</span><span class=o>=</span>2, <span class=nv>Memory</span><span class=o>=</span>2048MB, <span class=nv>Disk</span><span class=o>=</span>20000MB<span class=o>)</span> ...
<span class=o>[</span>...<span class=o>]</span>
üèÑ  Done! Thank you <span class=k>for</span> using minikube!
</code></pre></div><h4 id=prepare-the-gardener>Prepare the Gardener</h4><p>Now, that you have started your local cluster, we can go ahead and register the Gardener API Server.
Just point your <code>KUBECONFIG</code> environment variable to the local cluster you created in the previous step and run:</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>make dev-setup
Found Minikube ...
namespace/garden created
namespace/garden-dev created
deployment.apps/etcd created
service/etcd created
service/gardener-apiserver created
service/gardener-controller-manager created
endpoints/gardener-apiserver created
endpoints/gardener-controller-manager created
apiservice.apiregistration.k8s.io/v1alpha1.core.gardener.cloud created
apiservice.apiregistration.k8s.io/v1beta1.core.gardener.cloud created
validatingwebhookconfiguration.admissionregistration.k8s.io/gardener-controller-manager created
</code></pre></div><p>Optionally, you can switch off the <code>Logging</code> feature gate of Gardenlet to save resources:</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>sed -i -e <span class=s1>&#39;s/Logging: true/Logging: false/g&#39;</span> dev/20-componentconfig-gardenlet.yaml
</code></pre></div><p>The Gardener exposes the API servers of Shoot clusters via Kubernetes services of type <code>LoadBalancer</code>.
In order to establish stable endpoints (robust against changes of the load balancer address), it creates DNS records pointing to these load balancer addresses. They are used internally and by all cluster components to communicate.
You need to have control over a domain (or subdomain) for which these records will be created.
Please provide an <em>internal domain secret</em> (see <a href=https://raw.githubusercontent.com/gardener/gardener/master/docs/development/../../example/10-secret-internal-domain.yaml>this</a> for an example) which contains credentials with the proper privileges. Further information can be found <a href=https://raw.githubusercontent.com/gardener/gardener/master/docs/development/../usage/configuration.md>here</a>.</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>kubectl apply -f example/10-secret-internal-domain-unmanaged.yaml
secret/internal-domain-unmanaged created
</code></pre></div><h4 id=run-the-gardener>Run the Gardener</h4><p>Next, run the Gardener API Server, the Gardener Controller Manager (optionally), the Gardener Scheduler (optionally), and the Gardenlet in different terminal windows/panes using rules in the <code>Makefile</code>.</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>make start-apiserver
Found Minikube ...
I0306 15:23:51.044421   <span class=m>74536</span> plugins.go:84<span class=o>]</span> Registered admission plugin <span class=s2>&#34;ResourceReferenceManager&#34;</span>
I0306 15:23:51.044523   <span class=m>74536</span> plugins.go:84<span class=o>]</span> Registered admission plugin <span class=s2>&#34;DeletionConfirmation&#34;</span>
<span class=o>[</span>...<span class=o>]</span>
I0306 15:23:51.626836   <span class=m>74536</span> secure_serving.go:116<span class=o>]</span> Serving securely on <span class=o>[</span>::<span class=o>]</span>:8443
<span class=o>[</span>...<span class=o>]</span>
</code></pre></div><p>(Optional) Now you are ready to launch the Gardener Controller Manager.</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>make start-controller-manager
<span class=nv>time</span><span class=o>=</span><span class=s2>&#34;2019-03-06T15:24:17+02:00&#34;</span> <span class=nv>level</span><span class=o>=</span>info <span class=nv>msg</span><span class=o>=</span><span class=s2>&#34;Starting Gardener controller manager...&#34;</span>
<span class=nv>time</span><span class=o>=</span><span class=s2>&#34;2019-03-06T15:24:17+02:00&#34;</span> <span class=nv>level</span><span class=o>=</span>info <span class=nv>msg</span><span class=o>=</span><span class=s2>&#34;Feature Gates: &#34;</span>
<span class=nv>time</span><span class=o>=</span><span class=s2>&#34;2019-03-06T15:24:17+02:00&#34;</span> <span class=nv>level</span><span class=o>=</span>info <span class=nv>msg</span><span class=o>=</span><span class=s2>&#34;Starting HTTP server on 0.0.0.0:2718&#34;</span>
<span class=nv>time</span><span class=o>=</span><span class=s2>&#34;2019-03-06T15:24:17+02:00&#34;</span> <span class=nv>level</span><span class=o>=</span>info <span class=nv>msg</span><span class=o>=</span><span class=s2>&#34;Acquired leadership, starting controllers.&#34;</span>
<span class=nv>time</span><span class=o>=</span><span class=s2>&#34;2019-03-06T15:24:18+02:00&#34;</span> <span class=nv>level</span><span class=o>=</span>info <span class=nv>msg</span><span class=o>=</span><span class=s2>&#34;Starting HTTPS server on 0.0.0.0:2719&#34;</span>
<span class=nv>time</span><span class=o>=</span><span class=s2>&#34;2019-03-06T15:24:18+02:00&#34;</span> <span class=nv>level</span><span class=o>=</span>info <span class=nv>msg</span><span class=o>=</span><span class=s2>&#34;Found internal domain secret internal-domain-unmanaged for domain nip.io.&#34;</span>
<span class=nv>time</span><span class=o>=</span><span class=s2>&#34;2019-03-06T15:24:18+02:00&#34;</span> <span class=nv>level</span><span class=o>=</span>info <span class=nv>msg</span><span class=o>=</span><span class=s2>&#34;Successfully bootstrapped the Garden cluster.&#34;</span>
<span class=nv>time</span><span class=o>=</span><span class=s2>&#34;2019-03-06T15:24:18+02:00&#34;</span> <span class=nv>level</span><span class=o>=</span>info <span class=nv>msg</span><span class=o>=</span><span class=s2>&#34;Gardener controller manager (version 1.0.0-dev) initialized.&#34;</span>
<span class=nv>time</span><span class=o>=</span><span class=s2>&#34;2019-03-06T15:24:18+02:00&#34;</span> <span class=nv>level</span><span class=o>=</span>info <span class=nv>msg</span><span class=o>=</span><span class=s2>&#34;ControllerRegistration controller initialized.&#34;</span>
<span class=nv>time</span><span class=o>=</span><span class=s2>&#34;2019-03-06T15:24:18+02:00&#34;</span> <span class=nv>level</span><span class=o>=</span>info <span class=nv>msg</span><span class=o>=</span><span class=s2>&#34;SecretBinding controller initialized.&#34;</span>
<span class=nv>time</span><span class=o>=</span><span class=s2>&#34;2019-03-06T15:24:18+02:00&#34;</span> <span class=nv>level</span><span class=o>=</span>info <span class=nv>msg</span><span class=o>=</span><span class=s2>&#34;Project controller initialized.&#34;</span>
<span class=nv>time</span><span class=o>=</span><span class=s2>&#34;2019-03-06T15:24:18+02:00&#34;</span> <span class=nv>level</span><span class=o>=</span>info <span class=nv>msg</span><span class=o>=</span><span class=s2>&#34;Quota controller initialized.&#34;</span>
<span class=nv>time</span><span class=o>=</span><span class=s2>&#34;2019-03-06T15:24:18+02:00&#34;</span> <span class=nv>level</span><span class=o>=</span>info <span class=nv>msg</span><span class=o>=</span><span class=s2>&#34;CloudProfile controller initialized.&#34;</span>
<span class=o>[</span>...<span class=o>]</span>
</code></pre></div><p>(Optional) Now you are ready to launch the Gardener Scheduler.</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>make start-scheduler
<span class=nv>time</span><span class=o>=</span><span class=s2>&#34;2019-05-02T16:31:50+02:00&#34;</span> <span class=nv>level</span><span class=o>=</span>info <span class=nv>msg</span><span class=o>=</span><span class=s2>&#34;Starting Gardener scheduler ...&#34;</span>
<span class=nv>time</span><span class=o>=</span><span class=s2>&#34;2019-05-02T16:31:50+02:00&#34;</span> <span class=nv>level</span><span class=o>=</span>info <span class=nv>msg</span><span class=o>=</span><span class=s2>&#34;Starting HTTP server on 0.0.0.0:10251&#34;</span>
<span class=nv>time</span><span class=o>=</span><span class=s2>&#34;2019-05-02T16:31:50+02:00&#34;</span> <span class=nv>level</span><span class=o>=</span>info <span class=nv>msg</span><span class=o>=</span><span class=s2>&#34;Acquired leadership, starting scheduler.&#34;</span>
<span class=nv>time</span><span class=o>=</span><span class=s2>&#34;2019-05-02T16:31:50+02:00&#34;</span> <span class=nv>level</span><span class=o>=</span>info <span class=nv>msg</span><span class=o>=</span><span class=s2>&#34;Gardener scheduler initialized (with Strategy: SameRegion)&#34;</span>
<span class=nv>time</span><span class=o>=</span><span class=s2>&#34;2019-05-02T16:31:50+02:00&#34;</span> <span class=nv>level</span><span class=o>=</span>info <span class=nv>msg</span><span class=o>=</span><span class=s2>&#34;Scheduler controller initialized.&#34;</span>
<span class=o>[</span>...<span class=o>]</span>
</code></pre></div><p>(Optional) Now you are ready to launch the Gardenlet.</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>make start-gardenlet
<span class=nv>time</span><span class=o>=</span><span class=s2>&#34;2019-11-06T15:24:17+02:00&#34;</span> <span class=nv>level</span><span class=o>=</span>info <span class=nv>msg</span><span class=o>=</span><span class=s2>&#34;Starting Gardenlet...&#34;</span>
<span class=nv>time</span><span class=o>=</span><span class=s2>&#34;2019-11-06T15:24:17+02:00&#34;</span> <span class=nv>level</span><span class=o>=</span>info <span class=nv>msg</span><span class=o>=</span><span class=s2>&#34;Feature Gates: HVPA=true, Logging=true&#34;</span>
<span class=nv>time</span><span class=o>=</span><span class=s2>&#34;2019-11-06T15:24:17+02:00&#34;</span> <span class=nv>level</span><span class=o>=</span>info <span class=nv>msg</span><span class=o>=</span><span class=s2>&#34;Acquired leadership, starting controllers.&#34;</span>
<span class=nv>time</span><span class=o>=</span><span class=s2>&#34;2019-11-06T15:24:18+02:00&#34;</span> <span class=nv>level</span><span class=o>=</span>info <span class=nv>msg</span><span class=o>=</span><span class=s2>&#34;Found internal domain secret internal-domain-unmanaged for domain nip.io.&#34;</span>
<span class=nv>time</span><span class=o>=</span><span class=s2>&#34;2019-11-06T15:24:18+02:00&#34;</span> <span class=nv>level</span><span class=o>=</span>info <span class=nv>msg</span><span class=o>=</span><span class=s2>&#34;Gardenlet (version 1.0.0-dev) initialized.&#34;</span>
<span class=nv>time</span><span class=o>=</span><span class=s2>&#34;2019-11-06T15:24:18+02:00&#34;</span> <span class=nv>level</span><span class=o>=</span>info <span class=nv>msg</span><span class=o>=</span><span class=s2>&#34;ControllerInstallation controller initialized.&#34;</span>
<span class=nv>time</span><span class=o>=</span><span class=s2>&#34;2019-11-06T15:24:18+02:00&#34;</span> <span class=nv>level</span><span class=o>=</span>info <span class=nv>msg</span><span class=o>=</span><span class=s2>&#34;Shoot controller initialized.&#34;</span>
<span class=nv>time</span><span class=o>=</span><span class=s2>&#34;2019-11-06T15:24:18+02:00&#34;</span> <span class=nv>level</span><span class=o>=</span>info <span class=nv>msg</span><span class=o>=</span><span class=s2>&#34;Seed controller initialized.&#34;</span>
<span class=o>[</span>...<span class=o>]</span>
</code></pre></div><p>:warning: The Gardenlet will handle all your seeds for this development scenario, although, for productive usage it is recommended to run it once per seed, see <a href=https://raw.githubusercontent.com/gardener/gardener/master/docs/development/../concepts/gardenlet.md>this document</a> for more information.
See the <a href=#appendix>Appendix</a> on how to configure the Seed clusters for the local development scenario.</p><p>Please checkout the <a href=https://github.com/gardener/gem>Gardener Extensions Manager</a> to install extension controllers - make sure that you install all of them required for your local development.
Also, please refer to <a href=https://raw.githubusercontent.com/gardener/gardener/master/docs/development/../extensions/controllerregistration.md>this document</a> for further information about how extensions are registered in case you want to use other versions than the latest releases.</p><p>The Gardener should now be ready to operate on Shoot resources. You can use</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>kubectl get shoots
No resources found.
</code></pre></div><p>to operate against your local running Gardener API Server.</p><blockquote><p>Note: It may take several seconds until the <code>minikube</code> cluster recognizes that the Gardener API server has been started and is available. <code>No resources found</code> is the expected result of our initial development setup.</p></blockquote><h4 id=limitations-of-local-development-setup>Limitations of local development setup</h4><p>You can run Gardener (API server, controller manager, scheduler, gardenlet) against any local Kubernetes cluster, however, your seed and shoot clusters must be deployed to a &ldquo;real&rdquo; provider.
Currently, it is not possible to run Gardener entirely isolated from any cloud provider.
We are planning to support a setup that can run completely locally (see <a href=https://github.com/gardener/gardener-extension-provider-mock>this for details</a>), however, it does not yet exist.
This means that - after you have setup Gardener - you need to register an external seed cluster (e.g., one created in AWS).
Only after that step you can start creating shoot clusters with your locally running Gardener.</p><p>Some time ago, we had a local setup based on VirtualBox/Vagrant.
However, as we have progressed with the <a href=https://github.com/gardener/gardener/issues/308>Extensibility epic</a> we noticed that this implementation/setup does no longer fit into how we envision external providers to be.
Moreover, it hid too many things and came with a bunch of limitations, making the development scenario too &ldquo;artificial&rdquo;:</p><ul><li>No integration with machine-controller-manager.</li><li>The Shoot API Server is exposed via a NodePort. In a cloud setup a LoadBalancer would be used.</li><li>It was not possible to create Shoot clusters consisting of more than one worker node. Cluster auto-scaling therefore is not supported.</li><li>It was not possible to create two or more Shoot clusters in parallel.</li><li>The communication between the Seed and the Shoot Clusters uses VPN tunnel. In this setup tunnels are not needed since all components run on localhost.</li></ul><h2 id=additional-information>Additional information</h2><p>To make sure that a specific Seed cluster will be chosen, specify the <code>.spec.seedName</code> field (see <a href=https://raw.githubusercontent.com/gardener/gardener/master/docs/development/../../example/90-shoot.yaml#L265-L266>here</a> for an example Shoot manifest).</p><p>Please take a look at the <a href=https://raw.githubusercontent.com/gardener/gardener/master/docs/development/../../example>example manifests folder</a> to see which resource objects you need to install into your Garden cluster.</p><h1 id=appendix>Appendix</h1><h2 id=configure-seed-clusters-for-local-development>Configure Seed clusters for local development</h2><p>When using the Gardenlet in a local development scenario with <code>make start-gardenlet</code> then the Gardenlet component configuration is setup with a <a href=https://raw.githubusercontent.com/gardener/gardener/master/docs/development/../concepts/gardenlet.md#seed-config-vs-seed-selector>seed selector</a> that targets all available Seed clusters.
However, a <code>Seed</code> resource needs to be configured to allow being reconciled by a Gardenlet which such a configuration.</p><p>When deploying the Gardenlet to reconcile only one Seed cluster (using component configuration <code>.seedConfig</code>),
the Gardenlet either needs to be supplied with a kubeconfig for the particular Seed cluster, or acquires one via bootstrapping.
Having said that, if the Gardenlet is configured to manage multiple Seed clusters based on a label selector, it needs to fetch the kubeconfig of each Seed cluster at runtime from somewhere.
That is why the <code>Seed</code> resource needs to be configured with an additional secret reference that contains the kubeconfig of the Seed cluster.</p><p>Create a secret containing the base64 encoded kubeconfig of the Seed cluster (the scope of the permissions should be identical to the kubeconfig that the Gardenlet creates during bootstrapping - for now, <code>cluster-admin</code> privileges are recommended).</p><p>Create the secret in the Garden cluster:</p><div class=highlight><pre class=chroma><code class=language-yaml data-lang=yaml><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>v1</span><span class=w>
</span><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Secret</span><span class=w>
</span><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>sweet-seed</span><span class=w>
</span><span class=w>  </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class=l>garden</span><span class=w>
</span><span class=w></span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>Opaque</span><span class=w>
</span><span class=w></span><span class=nt>data</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=nt>kubeconfig</span><span class=p>:</span><span class=w> </span><span class=l>&lt;base64-seed-kubeconfig&gt;.</span><span class=w>
</span></code></pre></div><p>Adjust the <code>Seed</code> resource to reference the secret in <code>spec.secretRef</code> like so:</p><div class=highlight><pre class=chroma><code class=language-yaml data-lang=yaml><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>core.gardener.cloud/v1beta1</span><span class=w>
</span><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Seed</span><span class=w>
</span><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>my-sweet-seed</span><span class=w>
</span><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=l>...</span><span class=w>
</span><span class=w>  </span><span class=nt>secretRef</span><span class=p>:</span><span class=w>
</span><span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>sweet-seed</span><span class=w>
</span><span class=w>    </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class=l>garden</span><span class=w>
</span></code></pre></div></div></div></main></div></div><footer class="footer row d-print-none"><div class="container-fluid footer-wrapper"><ul class=nav><li><a href=/blog/>Blogs</a></li><li><a href=/community/>Community</a></li><li><a href=/adopter/>Adopters</a></li><li><a href=/docs/>Documentation</a></li></ul><img src=/images/lp/gardener-logo.svg alt="Logo Gardener" class=logo><ul class=media-wr><li><a target=_blank href=https://kubernetes.slack.com/archives/CB57N0BFG><img src=/images/branding/slack-logo-white.svg class=media-icon><div class=media-text>Slack</div></a></li><li><a target=_blank href=https://github.com/gardener><img src=/images/branding/github-mark-logo.png class=media-icon><div class=media-text>GitHub</div></a></li><li><a target=_blank href=https://www.youtube.com/channel/UCwUhwKFREV8Su0gwAJQX7tw><img src=/images/branding/youtube-logo-dark.svg class=media-icon><div class=media-text>YouTube</div></a></li><li><a target=_blank href=https://twitter.com/GardenerProject><img src=/images/branding/twitter-logo-white.svg class=media-icon><div class=media-text>Twitter</div></a></li></ul><span class=copyright>Copyright 2019-2021 Gardener project authors. <a href=https://www.sap.com/corporate/en/legal/privacy.html>Privacy policy
<i class="fa fa-external-link" aria-hidden=true></i></a></span></div></footer></div><script src=https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js integrity=sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js integrity=sha384-+YQ4JLhjyBLPDQt//I+STsc9iw4uQqACwlvpslubQzn4u2UU2UFM80nGisd026JF crossorigin=anonymous></script><script src=/js/main.min.3b172c13b62c2bea8b1c9d2599cddc8cf89718a92d792c680871c81ba43d8c85.js integrity="sha256-OxcsE7YsK+qLHJ0lmc3cjPiXGKkteSxoCHHIG6Q9jIU=" crossorigin=anonymous></script></body></html>