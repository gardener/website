<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=canonical type=text/html href=https://gardener.cloud/docs/gardener/project/><link rel=alternate type=application/rss+xml href=https://gardener.cloud/docs/gardener/project/index.xml><meta name=robots content="noindex, nofollow"><link rel="shortcut icon" href=/favicons/favicon.ico><link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/favicons/android-192x192.png sizes=192x192><title>Project | Gardener</title>
<meta name=description content="Project Gardener Website - A Managed Kubernetes Service Done Right"><meta property="og:url" content="https://gardener.cloud/docs/gardener/project/"><meta property="og:site_name" content="Gardener"><meta property="og:title" content="Project"><meta property="og:description" content="Project Gardener Website - A Managed Kubernetes Service Done Right"><meta property="og:locale" content="en_US"><meta property="og:type" content="website"><meta property="og:image" content="https://gardener.cloud/images/lp/gardener-logo.svg"><meta itemprop=name content="Project"><meta itemprop=description content="Project Gardener Website - A Managed Kubernetes Service Done Right"><meta itemprop=image content="https://gardener.cloud/images/lp/gardener-logo.svg"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://gardener.cloud/images/lp/gardener-logo.svg"><meta name=twitter:title content="Project"><meta name=twitter:description content="Project Gardener Website - A Managed Kubernetes Service Done Right"><link rel=preload href=/scss/main.min.28e6a4e12161b9cf22ad3a6904baa5d4aa576948b251285f581ebc6be7a3cd9f.css as=style integrity="sha256-KOak4SFhuc8irTppBLql1KpXaUiyUShfWB68a+ejzZ8=" crossorigin=anonymous><link href=/scss/main.min.28e6a4e12161b9cf22ad3a6904baa5d4aa576948b251285f581ebc6be7a3cd9f.css rel=stylesheet integrity="sha256-KOak4SFhuc8irTppBLql1KpXaUiyUShfWB68a+ejzZ8=" crossorigin=anonymous><script src=https://code.jquery.com/jquery-3.7.1.min.js integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin=anonymous></script><script defer src=https://unpkg.com/lunr@2.3.9/lunr.min.js integrity=sha384-203J0SNzyqHby3iU6hzvzltrWi/M41wOP5Gu+BiJMz5nwKykbkUx8Kp7iti0Lpli crossorigin=anonymous></script></head><body class=td-section><header><nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar"><a class=navbar-brand href=/><span class=navbar-logo><svg width="90" height="90" viewBox="0 0 90 90" xmlns:xlink="http://www.w3.org/1999/xlink"><title>logo</title><desc>Created with Sketch.</desc><defs><path d="M41.8864954.994901575c.996545099999999-.479910833 2.6164002-.477918931 3.6088091.0L76.8159138 16.0781121C77.8124589 16.5580229 78.8208647 17.8257185 79.0659694 18.8995926l7.7355517 33.8916663C87.0476474 53.8696088 86.6852538 55.4484075 85.9984855 56.3095876L64.3239514 83.4885938C63.6343208 84.3533632 62.1740175 85.0543973 61.0725268 85.0543973H26.3092731c-1.1060816.0-2.5646564-.704623400000003-3.2514246-1.5658035L1.38331434 56.3095876C.693683723 55.4448182.335174016 53.865133.580278769 52.7912589L8.31583044 18.8995926C8.56195675 17.8212428 9.57347722 16.556031 10.5658861 16.0781121L41.8864954.994901575z" id="path-1"/><linearGradient x1="12.7542673%" y1="-18.6617048%" x2="88.2666158%" y2="84.6075483%" id="linearGradient-3"><stop stop-color="#fff" offset="0"/><stop stop-color="#439246" offset="100%"/></linearGradient><linearGradient x1="50%" y1="4.93673768%" x2="148.756007%" y2="175.514523%" id="linearGradient-4"><stop stop-color="#fff" offset="0"/><stop stop-color="#439246" offset="100%"/></linearGradient><linearGradient x1="19.1574381%" y1="-9.04800713%" x2="82.2203149%" y2="77.9084293%" id="linearGradient-5"><stop stop-color="#fff" offset="0"/><stop stop-color="#439246" offset="100%"/></linearGradient><linearGradient x1="57.4403751%" y1="26.3148481%" x2="137.966711%" y2="158.080556%" id="linearGradient-6"><stop stop-color="#fff" offset="0"/><stop stop-color="#439246" offset="100%"/></linearGradient></defs><g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="logo"><g id="Rectangle-2" transform="translate(1.000000, 0.000000)"><mask id="mask-2" fill="#fff"><use xlink:href="#path-1"/></mask><use id="Mask" fill="#009f76" xlink:href="#path-1"/><polygon fill="#000" opacity=".289628623" mask="url(#mask-2)" points="-17.6484375 54.5224609 30.8242188 25.0791016 63.4726562 58.5 24.7324219 92.6689453"/></g><path d="M56.8508631 39.260019C56.4193519 40.443987 55.6088085 41.581593 54.6736295 42.1938694l-8.0738997 5.2861089c-1.3854671.907087099999998-3.6247515.9116711-5.0172201.0L33.50861 42.1938694C32.123143 41.2867823 31 39.206345 31 37.545932V26.4150304c0-.725313.2131118-1.5301454.569268099999999-2.2825772L56.8508631 39.260019z" id="Combined-Shape" fill="url(#linearGradient-3)" transform="translate(43.925432, 36.147233) scale(-1, 1) translate(-43.925432, -36.147233)"/><path d="M56.0774672 25.1412464C56.4306829 25.8903325 56.6425556 26.6907345 56.6425556 27.4119019V38.5428034c0 1.6598979-1.1161415 3.73626640000001-2.50861 4.6479374l-8.0738997 5.286109c-1.3854671.907087000000004-3.6247516.911671000000005-5.0172201.0L32.9689261 43.1907408C32.2918101 42.7474223 31.6773514 42.0238435 31.2260376 41.206007L56.0774672 25.1412464z" id="Combined-Shape" fill="url(#linearGradient-4)" transform="translate(43.821278, 37.246598) scale(-1, 1) translate(-43.821278, -37.246598)"/><path d="M65.0702134 57.1846889C64.5985426 58.2007851 63.8367404 59.1236871 62.9788591 59.6189851L47.37497 68.6278947c-1.4306165.825966800000003-3.75236779999999.8246599-5.1807206.0L26.5903603 59.6189851C25.1597438 58.7930183 24 56.7816693 24 55.1323495V37.1145303C24 36.3487436 24.249712 35.5060005 24.6599102 34.7400631L65.0702134 57.1846889z" id="Combined-Shape" fill="url(#linearGradient-5)"/><path d="M65.0189476 34.954538C65.3636909 35.6617313 65.5692194 36.42021 65.5692194 37.1145303V55.1323495C65.5692194 56.7842831 64.4072119 58.7943252 62.9788591 59.6189851L47.37497 68.6278947c-1.4306165.825966800000003-3.75236779999999.8246599-5.1807206.0L26.5903603 59.6189851C25.9237304 59.2341061 25.3159155 58.5918431 24.8568495 57.8487596L65.0189476 34.954538z" id="Combined-Shape" fill="url(#linearGradient-6)"/></g></g></svg></span><span class=text-capitalize>Gardener</span></a><div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar><ul class="navbar-nav mt-2 mt-lg-0"><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=https://demo.gardener.cloud target=_blank><span>Demo</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/adopter><span>Adopters</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><div class=dropdown><a href=/docs class=nav-link>Documentation</a><div class=dropdown-content><a class=taxonomy-term href=/docs>Users</a>
<a class=taxonomy-term href=/docs>Operators</a>
<a class=taxonomy-term href=/docs>Developers</a>
<a class=taxonomy-term href=/docs>All</a></div></div></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/blog><span>Blogs</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/community><span>Community</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a href=https://join.slack.com/t/gardener-cloud/shared_invite/zt-33c9daems-3oOorhnqOSnldZPWqGmIBw target=_blank class="btn btn-primary slack-button"><span>Join us on</span>
<img src=/images/branding/slack-icon.svg alt=Slack></a></li></ul></div><div class="navbar-nav d-none d-lg-block"><div class="td-search td-search--offline"><div class=td-search__icon></div><input type=search class="td-search__input form-control" placeholder="Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=/offline-search-index.3284d4c09a93872c259f7c9a4de21b30.json data-offline-search-base-href=/ data-offline-search-max-results=10></div></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><main class="col-12 col-md-9 col-xl-8 ps-md-5" role=main><div class=td-content><div class="pageinfo pageinfo-primary d-print-none"><p>This is the multi-page printable view of this section.
<a href=# onclick="return print(),!1">Click here to print</a>.</p><p><a href=/docs/gardener/project/>Return to the regular view of this page</a>.</p></div><h1 class=title>Project</h1><div class=content></div></div><div class=td-content><h1 id=pg-faf4c3a0bd69de333ac3356bb97972d2>1 - NamespacedCloudProfiles</h1><h1 id=namespacedcloudprofiles><code>NamespacedCloudProfile</code>s<a class=td-heading-self-link href=#namespacedcloudprofiles aria-label="Heading self-link"></a></h1><p><code>NamespacedCloudProfile</code>s are resources in Gardener that allow project-level customization of <code>CloudProfile</code>s.
They enable project administrators to create and manage cloud profiles specific to their projects and reduce the operational burden on central Gardener operators.
As opposed to <code>CloudProfile</code>s, <code>NamespacedCloudProfile</code>s are namespaced and thus limit configuration options for <code>Shoot</code>s, such as special machine types, to the associated project only.
These profiles inherit from a parent <code>CloudProfile</code> and can override or extend certain fields while maintaining backward compatibility.</p><p>Project viewers have the permission to see <code>NamespacedCloudProfile</code>s associated with a particular project.
Project administrators can generally create, edit, or delete <code>NamespacedCloudProfile</code>s but with some exceptions (see the <a href=/docs/gardener/project/namespaced-cloud-profiles/#field-modification-restrictions>restrictions</a> outlined below).</p><p>When creating or updating a <code>Shoot</code>, the cloud profile reference can be set to point to a <code>NamespacedCloudProfile</code>, allowing for more granular and project-specific configurations.
The modification of a <code>Shoot</code>&rsquo;s cloud profile reference is restricted to switching within the same profile hierarchy, i.e. from a <code>CloudProfile</code> to a descendant <code>NamespacedCloudProfile</code>, from a <code>NamespacedCloudProfile</code> to its parent <code>CloudProfile</code> and between <code>NamespacedCloudProfile</code>s having the same <code>CloudProfile</code> parent.
Changing the reference from one <code>CloudProfile</code> or descendant <code>NamespacedCloudProfile</code> to another <code>CloudProfile</code> or descendant <code>NamespacedCloudProfile</code> is not allowed.</p><p>The usage of <code>NamespacedCloudProfile</code>s is currently subject to a beta feature gate and is enabled by default.
It requires the enabled provider extensions to support the feature as well.
The feature gate can be disabled by passing the <code>--feature-gates=NamespacedCloudProfiles=false</code> flag to the Gardener API server.</p><p>Please see <a href=https://github.com/gardener/gardener/blob/master/example/35-namespacedcloudprofile.yaml>this</a> example manifest and <a href=https://github.com/gardener/gardener/blob/master/docs/proposals/25-namespaced-cloud-profiles.md>GEP-25</a> for additional information.</p><h2 id=field-modification-restrictions>Field Modification Restrictions<a class=td-heading-self-link href=#field-modification-restrictions aria-label="Heading self-link"></a></h2><p>In order to make changes to specific fields in the <code>NamespacedCloudProfile</code>, a user must be granted custom RBAC verbs.
Modifications of these fields need to be performed with caution and might require additional validation steps or accompanying changes.
By default, only landscape operators have the permission to change these fields, as they are usually able to judge the implications.</p><p>Changing the following fields require the corresponding custom verbs:</p><ul><li>For changing the <code>.spec.kubernetes</code> field, the custom verb <code>modify-spec-kubernetes</code> is required.</li><li>For changing the <code>.spec.machineImages</code> field, the custom verb <code>modify-spec-machineimages</code> is required.</li><li>For changing the <code>.spec.providerConfig</code> field, the custom verb <code>modify-spec-providerconfig</code> is required.</li><li>For raising limits in <code>.spec.limits</code> field above values in the parent CloudProfile <code>.spec.limits</code>, the custom verb <code>raise-spec-limits</code> is required.</li></ul><p>The assignment of these custom verbs can be achieved by creating a <code>ClusterRole</code> and a <code>RoleBinding</code> like in the following example:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>---
</span></span><span style=display:flex><span>apiVersion: rbac.authorization.k8s.io/v1
</span></span><span style=display:flex><span>kind: ClusterRole
</span></span><span style=display:flex><span>metadata:
</span></span><span style=display:flex><span>  name: namespacedcloudprofile-kubernetes
</span></span><span style=display:flex><span>rules:
</span></span><span style=display:flex><span>- apiGroups: [<span style=color:#a31515>&#34;core.gardener.cloud&#34;</span>] 
</span></span><span style=display:flex><span>  resources: [<span style=color:#a31515>&#34;namespacedcloudprofiles&#34;</span>]
</span></span><span style=display:flex><span>  verbs: [<span style=color:#a31515>&#34;modify-spec-kubernetes&#34;</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span>apiVersion: rbac.authorization.k8s.io/v1
</span></span><span style=display:flex><span>kind: RoleBinding
</span></span><span style=display:flex><span>metadata:
</span></span><span style=display:flex><span>  name: edit-kubernetes
</span></span><span style=display:flex><span>  namespace: dev
</span></span><span style=display:flex><span>roleRef:
</span></span><span style=display:flex><span>  apiGroup: rbac.authorization.k8s.io
</span></span><span style=display:flex><span>  kind: ClusterRole
</span></span><span style=display:flex><span>  name: namespacedcloudprofile-kubernetes
</span></span><span style=display:flex><span>subjects:
</span></span><span style=display:flex><span>- apiGroup: rbac.authorization.k8s.io
</span></span><span style=display:flex><span>  kind: User
</span></span><span style=display:flex><span>  name: alice.doe@example.com
</span></span></code></pre></div></div><div class=td-content style=page-break-before:always><h1 id=pg-20b566423cae2b690acd03634182806e>2 - Projects</h1><div class=lead>Project operations and roles. Four-Eyes-Principle for resource deletion</div><h1 id=projects>Projects<a class=td-heading-self-link href=#projects aria-label="Heading self-link"></a></h1><p>The Gardener API server supports a cluster-scoped <code>Project</code> resource which is used for data isolation between individual Gardener consumers. For example, each development team has its own project to manage its own shoot clusters.</p><p>Each <code>Project</code> is backed by a Kubernetes <code>Namespace</code> that contains the actual related Kubernetes resources, like <code>Secret</code>s or <code>Shoot</code>s.</p><p><strong>Example resource:</strong></p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>apiVersion: core.gardener.cloud/v1beta1
</span></span><span style=display:flex><span>kind: Project
</span></span><span style=display:flex><span>metadata:
</span></span><span style=display:flex><span>  name: dev
</span></span><span style=display:flex><span>spec:
</span></span><span style=display:flex><span>  namespace: garden-dev
</span></span><span style=display:flex><span>  description: <span style=color:#a31515>&#34;This is my first project&#34;</span>
</span></span><span style=display:flex><span>  purpose: <span style=color:#a31515>&#34;Experimenting with Gardener&#34;</span>
</span></span><span style=display:flex><span>  owner:
</span></span><span style=display:flex><span>    apiGroup: rbac.authorization.k8s.io
</span></span><span style=display:flex><span>    kind: User
</span></span><span style=display:flex><span>    name: john.doe@example.com
</span></span><span style=display:flex><span>  members:
</span></span><span style=display:flex><span>  - apiGroup: rbac.authorization.k8s.io
</span></span><span style=display:flex><span>    kind: User
</span></span><span style=display:flex><span>    name: alice.doe@example.com
</span></span><span style=display:flex><span>    role: admin
</span></span><span style=display:flex><span>  <span style=color:green># roles:</span>
</span></span><span style=display:flex><span>  <span style=color:green># - viewer </span>
</span></span><span style=display:flex><span>  <span style=color:green># - uam</span>
</span></span><span style=display:flex><span>  <span style=color:green># - serviceaccountmanager</span>
</span></span><span style=display:flex><span>  <span style=color:green># - extension:foo</span>
</span></span><span style=display:flex><span>  - apiGroup: rbac.authorization.k8s.io
</span></span><span style=display:flex><span>    kind: User
</span></span><span style=display:flex><span>    name: bob.doe@example.com
</span></span><span style=display:flex><span>    role: viewer
</span></span><span style=display:flex><span><span style=color:green># tolerations:</span>
</span></span><span style=display:flex><span><span style=color:green>#   defaults:</span>
</span></span><span style=display:flex><span><span style=color:green>#   - key: &lt;some-key&gt;</span>
</span></span><span style=display:flex><span><span style=color:green>#   whitelist:</span>
</span></span><span style=display:flex><span><span style=color:green>#   - key: &lt;some-key&gt;</span>
</span></span></code></pre></div><p>The <code>.spec.namespace</code> field is optional and is initialized if unset.
The name of the resulting namespace will be determined based on the <code>Project</code> name and UID, e.g., <code>garden-dev-5aef3</code>.
It&rsquo;s also possible to adopt existing namespaces by labeling them <code>gardener.cloud/role=project</code> and <code>project.gardener.cloud/name=dev</code> beforehand (otherwise, they cannot be adopted).</p><p>When deleting a Project resource, the corresponding namespace is also deleted.
To keep a namespace after project deletion, an administrator/operator (not Project members!) can annotate the project-namespace with <code>namespace.gardener.cloud/keep-after-project-deletion</code>.</p><p>The <code>spec.description</code> and <code>.spec.purpose</code> fields can be used to describe to fellow team members and Gardener operators what this project is used for.</p><p>Each project has one dedicated owner, configured in <code>.spec.owner</code> using the <code>rbac.authorization.k8s.io/v1.Subject</code> type.
The owner is the main contact person for Gardener operators.
Please note that the <code>.spec.owner</code> field is deprecated and will be removed in future API versions in favor of the <code>owner</code> role, see below.</p><p>The list of members (again a list in <code>.spec.members[]</code> using the <code>rbac.authorization.k8s.io/v1.Subject</code> type) contains all the people that are associated with the project in any way.
Each project member must have at least one role (currently described in <code>.spec.members[].role</code>, additional roles can be added to <code>.spec.members[].roles[]</code>). The following roles exist:</p><ul><li><code>admin</code>: This allows to fully manage resources inside the project (e.g., secrets, shoots, configmaps, and similar). Mind that the <code>admin</code> role has read only access to service accounts.</li><li><code>serviceaccountmanager</code>: This allows to fully manage service accounts inside the project namespace and request tokens for them. The permissions of the created service accounts are instead managed by the <code>admin</code> role. Please refer to <a href=/docs/gardener/project/service-account-manager/>Service Account Manager</a>.</li><li><code>uam</code>: This allows to add/modify/remove human users or groups to/from the project member list.</li><li><code>viewer</code>: This allows to read all resources inside the project except secrets.</li><li><code>owner</code>: This combines the <code>admin</code>, <code>uam</code>, and <code>serviceaccountmanager</code> roles.</li><li>Extension roles (prefixed with <code>extension:</code>): Please refer to <a href=/docs/gardener/extensions/project-roles/>Extending Project Roles</a>.</li></ul><p>The <a href=/docs/gardener/concepts/controller-manager/#project-controller>project controller</a> inside the Gardener Controller Manager is managing RBAC resources that grant the described privileges to the respective members.</p><p>There are three central <code>ClusterRole</code>s <code>gardener.cloud:system:project-member</code>, <code>gardener.cloud:system:project-viewer</code>, and <code>gardener.cloud:system:project-serviceaccountmanager</code> that grant the permissions for namespaced resources (e.g., <code>Secret</code>s, <code>Shoot</code>s, <code>ServiceAccount</code>s).
Via referring <code>RoleBinding</code>s created in the respective namespace the project members get bound to these <code>ClusterRole</code>s and, thus, the needed permissions.
There are also project-specific <code>ClusterRole</code>s granting the permissions for cluster-scoped resources, e.g., the <code>Namespace</code> or <code>Project</code> itself.<br>For each role, the following <code>ClusterRole</code>s, <code>ClusterRoleBinding</code>s, and <code>RoleBinding</code>s are created:</p><table><thead><tr><th>Role</th><th><code>ClusterRole</code></th><th><code>ClusterRoleBinding</code></th><th><code>RoleBinding</code></th></tr></thead><tbody><tr><td><code>admin</code></td><td><code>gardener.cloud:system:project-member:&lt;projectName></code></td><td><code>gardener.cloud:system:project-member:&lt;projectName></code></td><td><code>gardener.cloud:system:project-member</code></td></tr><tr><td><code>serviceaccountmanager</code></td><td></td><td></td><td><code>gardener.cloud:system:project-serviceaccountmanager</code></td></tr><tr><td><code>uam</code></td><td><code>gardener.cloud:system:project-uam:&lt;projectName></code></td><td><code>gardener.cloud:system:project-uam:&lt;projectName></code></td><td></td></tr><tr><td><code>viewer</code></td><td><code>gardener.cloud:system:project-viewer:&lt;projectName></code></td><td><code>gardener.cloud:system:project-viewer:&lt;projectName></code></td><td><code>gardener.cloud:system:project-viewer</code></td></tr><tr><td><code>owner</code></td><td><code>gardener.cloud:system:project:&lt;projectName></code></td><td><code>gardener.cloud:system:project:&lt;projectName></code></td><td></td></tr><tr><td><code>extension:*</code></td><td><code>gardener.cloud:extension:project:&lt;projectName>:&lt;extensionRoleName></code></td><td></td><td><code>gardener.cloud:extension:project:&lt;projectName>:&lt;extensionRoleName></code></td></tr></tbody></table><h2 id=user-access-management>User Access Management<a class=td-heading-self-link href=#user-access-management aria-label="Heading self-link"></a></h2><p>For <code>Project</code>s created before Gardener v1.8, all admins were allowed to manage other members.
Beginning with v1.8, the new <code>uam</code> role is being introduced.
It is backed by the <code>manage-members</code> custom RBAC verb which allows to add/modify/remove human users or groups to/from the project member list.
Human users are subjects with <code>kind=User</code> and <code>name!=system:serviceaccount:*</code>, and groups are subjects with <code>kind=Group</code>.
The management of service account subjects (<code>kind=ServiceAccount</code> or <code>name=system:serviceaccount:*</code>) is not controlled via the <code>uam</code> custom verb but with the standard <code>update</code>/<code>patch</code> verbs for projects.</p><p>All newly created projects will only bind the owner to the <code>uam</code> role.
The owner can still grant the <code>uam</code> role to other members if desired.
For projects created before Gardener v1.8, the Gardener Controller Manager will migrate all projects to also assign the <code>uam</code> role to all <code>admin</code> members (to not break existing use-cases). The corresponding migration logic is present in Gardener Controller Manager from v1.8 to v1.13.
The project owner can gradually remove these roles if desired.</p><h2 id=stale-projects>Stale Projects<a class=td-heading-self-link href=#stale-projects aria-label="Heading self-link"></a></h2><p>When a project is not actively used for some period of time, it is marked as &ldquo;stale&rdquo;. This is done by a controller called <a href=/docs/gardener/concepts/controller-manager/#stale-projects-reconciler>&ldquo;Stale Projects Reconciler&rdquo;</a>. Once the project is marked as stale, there is a time frame in which if not used it will be deleted by that controller.</p><h2 id=four-eyes-principle-for-resource-deletion>Four-Eyes-Principle For Resource Deletion<a class=td-heading-self-link href=#four-eyes-principle-for-resource-deletion aria-label="Heading self-link"></a></h2><p>In order to delete a <code>Shoot</code>, the deletion must be confirmed upfront with the <code>confirmation.gardener.cloud/deletion=true</code> annotation.
Without this annotation being set, <code>gardener-apiserver</code> denies any DELETE request.
Still, users sometimes accidentally shot themselves in the foot, meaning that they accidentally deleted a <code>Shoot</code> despite the confirmation requirement.</p><p>To prevent that (or make it harder, at least), the <code>Project</code> can be configured to apply the dual approval concept for <code>Shoot</code> deletion.
This means that the subject confirming the deletion must not be the same as the subject sending the DELETE request.</p><p>Example:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>spec:
</span></span><span style=display:flex><span>  dualApprovalForDeletion:
</span></span><span style=display:flex><span>  - resource: shoots
</span></span><span style=display:flex><span>    selector:
</span></span><span style=display:flex><span>      matchLabels: {}
</span></span><span style=display:flex><span>    includeServiceAccounts: <span style=color:#00f>true</span>
</span></span></code></pre></div><blockquote class="alert alert-note"><div class=alert-title><svg viewBox="0 0 24 24" width="24" height="24"><title>information-outline</title><path d="M11 9h2V7H11m1 13c-4.41.0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8M12 2A10 10 0 002 12 10 10 0 0012 22 10 10 0 0022 12 10 10 0 0012 2M11 17h2V11H11v6z"/></svg><p>Note</p></div><p>As of today, <code>core.gardener.cloud/v1beta1.Shoot</code> is the only resource for which this concept is implemented.</p></blockquote><p>As usual, <code>.spec.dualApprovalForDeletion[].selector.matchLabels={}</code> matches all resources, <code>.spec.dualApprovalForDeletion[].selector.matchLabels=null</code> matches none at all.
It can also be decided to specify an individual label selector if this concept shall only apply to a subset of the <code>Shoot</code>s in the project (e.g., CI/development clusters shall be excluded).</p><p>The <code>includeServiceAccounts</code> (default: <code>true</code>) controls whether the concept also applies when the <code>Shoot</code> deletion confirmation and actual deletion is triggered via <code>ServiceAccount</code>s.
This is to prevent that CI jobs have to follow this concept as well, adding additional complexity/overhead.
Alternatively, you could also use two <code>ServiceAccount</code>s, one for confirming the deletion, and another one for actually sending the DELETE request, if desired.</p><blockquote class="alert alert-important"><div class=alert-title><svg viewBox="0 0 24 24" width="24" height="24"><title>message-outline</title><path d="M20 2H4C2.9 2 2 2.9 2 4V22l4-4H20C21.1 18 22 17.1 22 16V4C22 2.9 21.1 2 20 2m0 14H5.2L4 17.2V4H20V16z"/></svg><p>Important</p></div><p>Project members can still change the labels of <code>Shoot</code>s (or the selector itself) to circumvent the dual approval concept.
This concern is intentionally excluded/ignored for now since the principle is not a &ldquo;security feature&rdquo; but shall just help preventing <em>accidental</em> deletion.</p></blockquote></div><div class=td-content style=page-break-before:always><h1 id=pg-d863eb1908bf45042354962faed5676c>3 - Service Account Manager</h1><div class=lead>The role that allows a user to manage ServiceAccounts in the project namespace</div><h1 id=service-account-manager>Service Account Manager<a class=td-heading-self-link href=#service-account-manager aria-label="Heading self-link"></a></h1><h2 id=overview>Overview<a class=td-heading-self-link href=#overview aria-label="Heading self-link"></a></h2><p>With Gardener <code>v1.47</code>, a new role called <code>serviceaccountmanager</code> was introduced. This role allows to fully manage <code>ServiceAccount</code>&rsquo;s in the project namespace and request tokens for them. This is the preferred way of managing the access to a project namespace, as it aims to replace the usage of the default <code>ServiceAccount</code> secrets that will no longer be generated automatically.</p><h2 id=actions>Actions<a class=td-heading-self-link href=#actions aria-label="Heading self-link"></a></h2><p>Once assigned the <code>serviceaccountmanager</code> role, a user can create/update/delete <code>ServiceAccount</code>s in the project namespace.</p><h3 id=create-a-service-account>Create a Service Account<a class=td-heading-self-link href=#create-a-service-account aria-label="Heading self-link"></a></h3><p>In order to create a <code>ServiceAccount</code> named &ldquo;robot-user&rdquo;, run the following <code>kubectl</code> command:</p><pre tabindex=0><code class=language-code data-lang=code>kubectl -n project-abc create sa robot-user
</code></pre><h3 id=request-a-token-for-a-service-account>Request a Token for a Service Account<a class=td-heading-self-link href=#request-a-token-for-a-service-account aria-label="Heading self-link"></a></h3><p>A token for the &ldquo;robot-user&rdquo; <code>ServiceAccount</code> can be requested via the <a href=https://kubernetes.io/docs/reference/kubernetes-api/authentication-resources/token-request-v1/>TokenRequest API</a> in several ways:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl -n project-abc create token robot-user --duration=3600s
</span></span></code></pre></div><ul><li>directly calling the Kubernetes HTTP API</li></ul><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl -X POST https://api.gardener/api/v1/namespaces/project-abc/serviceaccounts/robot-user/token <span style=color:#a31515>\
</span></span></span><span style=display:flex><span><span style=color:#a31515></span>    -H <span style=color:#a31515>&#34;Authorization: Bearer &lt;auth-token&gt;&#34;</span> <span style=color:#a31515>\
</span></span></span><span style=display:flex><span><span style=color:#a31515></span>    -H <span style=color:#a31515>&#34;Content-Type: application/json&#34;</span> <span style=color:#a31515>\
</span></span></span><span style=display:flex><span><span style=color:#a31515></span>    -d <span style=color:#a31515>&#39;{
</span></span></span><span style=display:flex><span><span style=color:#a31515>        &#34;apiVersion&#34;: &#34;authentication.k8s.io/v1&#34;,
</span></span></span><span style=display:flex><span><span style=color:#a31515>        &#34;kind&#34;: &#34;TokenRequest&#34;,
</span></span></span><span style=display:flex><span><span style=color:#a31515>        &#34;spec&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#a31515>          &#34;expirationSeconds&#34;: 3600
</span></span></span><span style=display:flex><span><span style=color:#a31515>        }
</span></span></span><span style=display:flex><span><span style=color:#a31515>      }&#39;</span>
</span></span></code></pre></div><p>Mind that the returned token is not stored within the Kubernetes cluster, will be valid for <code>3600</code> seconds, and will be invalidated if the &ldquo;robot-user&rdquo; <code>ServiceAccount</code> is deleted. Although <code>expirationSeconds</code> can be modified depending on the needs, the returned token&rsquo;s validity will not exceed the configured <code>service-account-max-token-expiration</code> duration for the garden cluster. It is advised that the actual <code>expirationTimestamp</code> is verified so that expectations are met. This can be done by asserting the <code>expirationTimestamp</code> in the <code>TokenRequestStatus</code> or the <code>exp</code> claim in the token itself.</p><h3 id=delete-a-service-account>Delete a Service Account<a class=td-heading-self-link href=#delete-a-service-account aria-label="Heading self-link"></a></h3><p>In order to delete the <code>ServiceAccount</code> named &ldquo;robot-user&rdquo;, run the following <code>kubectl</code> command:</p><pre tabindex=0><code class=language-code data-lang=code>kubectl -n project-abc delete sa robot-user
</code></pre><p>This will invalidate all existing tokens for the &ldquo;robot-user&rdquo; <code>ServiceAccount</code>.</p></div></main></div></div><footer class="footer row d-print-none"><div class="container-fluid footer-wrapper"><ul class=nav><li><a href=https://gardener.cloud/blog/>Blogs</a></li><li><a href=https://gardener.cloud/community/>Community</a></li><li><a href=https://gardener.cloud/adopter/>Adopters</a></li><li><a href=/docs/>Documentation</a></li></ul><img src=/images/lp/gardener-logo.svg alt="Logo Gardener" class=logo><ul class=media-wr><li><a target=_blank href=https://kubernetes.slack.com/archives/CB57N0BFG><img src=/images/branding/slack-logo-white.svg class=media-icon><div class=media-text>Slack</div></a></li><li><a target=_blank href=https://github.com/gardener><img src=/images/branding/github-mark-logo.png class=media-icon><div class=media-text>GitHub</div></a></li><li><a target=_blank href=https://www.youtube.com/channel/UCwUhwKFREV8Su0gwAJQX7tw><img src=/images/branding/youtube-logo-dark.svg class=media-icon><div class=media-text>YouTube</div></a></li><li><a target=_blank href=https://x.com/GardenerProject><img src=/images/branding/x-logo-white.svg class=media-icon><div class=media-text>X</div></a></li></ul><span class=copyright>Copyright 2019-2025 Gardener project authors.
<a href=https://www.sap.com/about/legal/terms-of-use.html>Terms of Use
<i class="fa fa-external-link" aria-hidden=true></i>
</a>|
<a href=https://www.sap.com/about/legal/terms-of-use.html>Privacy Statement
<i class="fa fa-external-link" aria-hidden=true></i>
</a>|
<a href=https://www.sap.com/about/legal/terms-of-use.html>Legal Disclosure
<i class="fa fa-external-link" aria-hidden=true></i></a></span></div></footer></div><script src=/js/main.min.69e2c1ae9320465ab10236d9ef752c6a4442c54b48b883b17c497b7c7d96a796.js integrity="sha256-aeLBrpMgRlqxAjbZ73UsakRCxUtIuIOxfEl7fH2Wp5Y=" crossorigin=anonymous></script><script defer src=/js/click-to-copy.min.73478a7d4807698aed7e355eb23f9890ca18fea3158604c8471746d046702bad.js integrity="sha256-c0eKfUgHaYrtfjVesj+YkMoY/qMVhgTIRxdG0EZwK60=" crossorigin=anonymous></script><script src=/js/tabpane-persist.js></script></body></html>