<!doctype html><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Project Gardener Website - A Managed Kubernetes Service Done Right"><meta name=copyright content="Copyright 2019 Gardener project authors."><meta name=google-site-verification content="9EoGiMwk2aq0E_tVh16iJgJbp7fbyqkfWH9b5sGybl0"><title>gardenlet :: Gardener</title><link rel=icon type=image/x-icon href=https://gardener.cloud/images/favicon.ico><link rel=icon type=image/png href=https://gardener.cloud/images/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=https://gardener.cloud/images/favicon-16x16.png sizes=16x16><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-W2FGNSX');</script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','UA-165447164-1');</script><link href=/css/font-awesome.min.css?1613736047 rel=stylesheet><link href=/css/skeleton.css?1613736047 rel=stylesheet><link rel=preload href=/fonts/sap-icofonts/sap-icofonts.woff as=font type=font/woff crossorigin=anonymous><link rel=preload href=/fonts/sapcom-icons/sapcom-icons.woff as=font type=font/woff crossorigin=anonymous><link rel=stylesheet href=/css/sapcom-icons.css><link rel=stylesheet href=/css/normalize.css><link rel=stylesheet href=/css/gardener.b459b7f22c26be8e2f608a181d5372c6e44f06cf007c350346ccf5fadbe04a74.css><script src=/js/moment.js?1613736047></script><script src=/js/inlineSVG.js?1613736047></script><script src=/js/jquery.min.js?1613736047></script><script src=/jquery-ui-1.12.1/jquery-ui.min.js?1613736047></script><script src=/js/fixed.js?1613736047></script><script src=/js/clipboard.min.js?1613736047></script><script src=https://platform.linkedin.com/in.js type=text/javascript>lang:en_US</script></head><body data-url=/v1.15.5/concepts/core-components/gardenlet/ class=has-sticky-navigation><script>$(document).ready(function(){function initStickyNav(){var stickyPoint;var tln=document.querySelector(".tln");if(!tln){return;}
var stickyPointEl=document.querySelector(".sticky-nav-point");if(stickyPointEl==null){stickyPointEl=document.querySelector("body");stickyPoint=0;}else{stickyPoint=stickyPointEl.clientHeight+stickyPointEl.offsetTop;}
var bodySelector=document.getElementsByTagName("body")[0];var tlnHeight=tln.clientHeight;var stickyNavigation=function(){if(window.pageYOffset+tlnHeight>=stickyPoint){bodySelector.classList.add("has-sticky-navigation");tln.classList.add("sticky-top");}else{bodySelector.classList.remove("has-sticky-navigation");tln.classList.remove("sticky-top");}}
window.onscroll=function(){stickyNavigation();};}
initStickyNav();function closeAllSelect(){document.getElementById("docOptions").classList.remove("show");}
function show(e){e.stopPropagation();document.getElementById("docOptions").classList.add("show");}
document.addEventListener("click",closeAllSelect);document.getElementById("docSelector").addEventListener("click",show);});</script><div class="tln fixedsticky sticky-top"><header class=navigation><div class=container><div class=navigation-wrapper><a href=/ class=logo><img src=/images/gardener-logo.svg>
<span class=title>Gardener</span></a>
<a class="nav-button navbar-toggler" href=#><i class="fa fa-bars"></i></a><div class=navbar-collapse><ul class=links><li class=link><a href=/blog/>Blogs</a></li><li class=link><a href=/community/>Community</a></li><li class=link><a href=/adopter/>Adopters</a></li><li class="link has-child active"><a id=docSelector>Documentation v1.15.5</a><div id=docOptions class=doc-options><ul><li><a href=/documentation/home>Documentation
v1.17.0</a></li><li><a href=/v1.16.3/home>Documentation
v1.16.3</a></li><li><a href=/v1.15.5/home class=activeVersion>Documentation
v1.15.5</a></li></ul></div></li></ul></div></div></div></header></div><script>$(".navigation .navbar-toggler").click(function(evt){$(".navigation .navbar-collapse").toggle();$(".navigation").toggleClass("collapsed");$(".navigation .search-box").toggle();})</script><style>#docSelector{cursor:pointer}.doc-options{position:fixed;background-color:#0b8062;text-align:left;display:none}.doc-options ul li{margin-bottom:0}.doc-options ul li a:hover{background-color:#0c694f}.doc-options ul{list-style:none;padding:0;margin:0;text-align:left}.doc-options ul li a{padding:10px;margin:0}.doc-options .activeVersion{background-color:#ec682a}.show{display:block}</style><div class=sln><div class=overlay-band><ul class="nav-list container"><li title=Home><a class=navbar-link href=/v1.15.5/home/>Home</a></li><li title=Concepts><a class="navbar-link is-active" href=/v1.15.5/concepts/>Concepts</a></li><li title="How-To Guides"><a class=navbar-link href=/v1.15.5/guides/>How-To Guides</a></li><li title=Tutorials><a class=navbar-link href=/v1.15.5/tutorials/>Tutorials</a></li><li title="API Reference"><a class=navbar-link href=/v1.15.5/references/>API Reference</a></li><li title=Contribute><a class=navbar-link href=/v1.15.5/contribute/>Contribute</a></li></ul></div></div><div class="main container"><nav id=sidebar class="collapsed container menu"><div class=highlightable><ul class=topics><li data-nav-id=/v1.15.5/concepts/ title=Concepts class="dd-item parent root collapsible" data-depth=0><a href=/v1.15.5/concepts/><span class=menu-item-text>Concepts</span></a><ul><li data-nav-id=/v1.15.5/concepts/architecture/ title=Architecture class="dd-item top-level collapsible collapsed" data-depth=1><a href=/v1.15.5/concepts/architecture/><span class="toggle fa fa-angle-right"></span><span class=menu-item-text>Architecture</span></a><ul><li data-nav-id=/components/bouquet/ title=Bouquet class=dd-item data-depth=2><a href=/components/bouquet/><span class=toggle></span><span class=menu-item-text></span>Bouquet</span></a></a></li><li data-nav-id=/components/dashboard/ title=Dashboard class=dd-item data-depth=2><a href=/components/dashboard/><span class=toggle></span><span class=menu-item-text></span>Dashboard</span></a></a></li><li data-nav-id=/components/gardenctl/ title=gardenctl class=dd-item data-depth=2><a href=/components/gardenctl/><span class=toggle></span><span class=menu-item-text></span>gardenctl</span></a></a></li><li data-nav-id=/components/gardener/ title=Gardener class=dd-item data-depth=2><a href=/components/gardener/><span class=toggle></span><span class=menu-item-text></span>Gardener</span></a></a></li><li data-nav-id=/components/kubify/ title=kubify class=dd-item data-depth=2><a href=/components/kubify/><span class=toggle></span><span class=menu-item-text></span>kubify</span></a></a></li></ul></li><li data-nav-id=/v1.15.5/concepts/core-components/ title="Core Components" class="dd-item parent top-level collapsible" data-depth=1><a href=/documentation/concepts/core-components/api-server><span class="toggle fa fa-angle-down"></span><span class=menu-item-text>Core Components</span></a><ul><li data-nav-id=/v1.15.5/concepts/core-components/api-server/ title="Gardener API Server" class="dd-item collapsible collapsed" data-depth=2><a href=/v1.15.5/concepts/core-components/api-server/><span class="toggle fa fa-angle-right"></span><span class=menu-item-text>Gardener API Server</span></a><ul><li data-nav-id=/v1.15.5/concepts/core-components/api-server/apiserver_admission_plugins/ title="In-Tree Admission Plugins" class=dd-item data-depth=3><a href=/v1.15.5/concepts/core-components/api-server/apiserver_admission_plugins/><span class=toggle></span><span class=menu-item-text></span>In-Tree Admission Plugins</span></a></a></li></ul></li><li data-nav-id=/v1.15.5/concepts/core-components/scheduler/ title="Gardener Scheduler" class=dd-item data-depth=2><a href=/v1.15.5/concepts/core-components/scheduler/><span class=toggle></span><span class=menu-item-text></span>Gardener Scheduler</span></a></a></li><li data-nav-id=/v1.15.5/concepts/core-components/seed-admission-controller/ title="Gardener Seed Admission Controller" class=dd-item data-depth=2><a href=/v1.15.5/concepts/core-components/seed-admission-controller/><span class=toggle></span><span class=menu-item-text></span>Gardener Seed Admission Controller</span></a></a></li><li data-nav-id=/v1.15.5/concepts/core-components/gardenlet/ title=gardenlet class="dd-item active" data-depth=2><a href=/v1.15.5/concepts/core-components/gardenlet/><span class=toggle></span><span class=menu-item-text></span>gardenlet</span></a></a></li></ul></li><li data-nav-id=/v1.15.5/concepts/backup-restore/backup-restore/ title="Backup and Restore" class="dd-item top-level" data-depth=1><a href=/v1.15.5/concepts/backup-restore/backup-restore/><span class=toggle></span><span class=menu-item-text></span>Backup and Restore</span></a></a></li><li data-nav-id=/v1.15.5/concepts/extensions/ title=Extensions class="dd-item top-level collapsible collapsed" data-depth=1><a href=/v1.15.5/concepts/extensions/><span class="toggle fa fa-angle-right"></span><span class=menu-item-text>Extensions</span></a><ul><li data-nav-id=/v1.15.5/concepts/extensions/backupbucket/ title="BackupBucket resource" class=dd-item data-depth=2><a href=/v1.15.5/concepts/extensions/backupbucket/><span class=toggle></span><span class=menu-item-text></span>BackupBucket resource</span></a></a></li><li data-nav-id=/v1.15.5/concepts/extensions/backupentry/ title="BackupEntry resource" class=dd-item data-depth=2><a href=/v1.15.5/concepts/extensions/backupentry/><span class=toggle></span><span class=menu-item-text></span>BackupEntry resource</span></a></a></li><li data-nav-id=/v1.15.5/concepts/extensions/cluster/ title="Cluster resource" class=dd-item data-depth=2><a href=/v1.15.5/concepts/extensions/cluster/><span class=toggle></span><span class=menu-item-text></span>Cluster resource</span></a></a></li><li data-nav-id=/v1.15.5/concepts/extensions/shoot-health-status-conditions/ title="Contributing to shoot health status conditions" class=dd-item data-depth=2><a href=/v1.15.5/concepts/extensions/shoot-health-status-conditions/><span class=toggle></span><span class=menu-item-text></span>Contributing to shoot health status conditions</span></a></a></li><li data-nav-id=/v1.15.5/concepts/extensions/controlplane-webhooks/ title="Controlplane customization webhooks" class=dd-item data-depth=2><a href=/v1.15.5/concepts/extensions/controlplane-webhooks/><span class=toggle></span><span class=menu-item-text></span>Controlplane customization webhooks</span></a></a></li><li data-nav-id=/v1.15.5/concepts/extensions/controlplane/ title="ControlPlane resource" class=dd-item data-depth=2><a href=/v1.15.5/concepts/extensions/controlplane/><span class=toggle></span><span class=menu-item-text></span>ControlPlane resource</span></a></a></li><li data-nav-id=/v1.15.5/concepts/extensions/controlplane-exposure/ title="ControlPlane resource with purpose exposure" class=dd-item data-depth=2><a href=/v1.15.5/concepts/extensions/controlplane-exposure/><span class=toggle></span><span class=menu-item-text></span>ControlPlane resource with purpose exposure</span></a></a></li><li data-nav-id=/v1.15.5/concepts/extensions/dns/ title="DNSProvider and DNSEntry resources" class=dd-item data-depth=2><a href=/v1.15.5/concepts/extensions/dns/><span class=toggle></span><span class=menu-item-text></span>DNSProvider and DNSEntry resources</span></a></a></li><li data-nav-id=/v1.15.5/concepts/extensions/project-roles/ title="Extending project roles" class=dd-item data-depth=2><a href=/v1.15.5/concepts/extensions/project-roles/><span class=toggle></span><span class=menu-item-text></span>Extending project roles</span></a></a></li><li data-nav-id=/v1.15.5/concepts/extensions/overview/ title="Extensibility overview" class=dd-item data-depth=2><a href=/v1.15.5/concepts/extensions/overview/><span class=toggle></span><span class=menu-item-text></span>Extensibility overview</span></a></a></li><li data-nav-id=/v1.15.5/concepts/extensions/extension/ title="Extension resource" class=dd-item data-depth=2><a href=/v1.15.5/concepts/extensions/extension/><span class=toggle></span><span class=menu-item-text></span>Extension resource</span></a></a></li><li data-nav-id=/v1.15.5/concepts/extensions/containerruntime/ title="Gardener Container Runtime Extension" class=dd-item data-depth=2><a href=/v1.15.5/concepts/extensions/containerruntime/><span class=toggle></span><span class=menu-item-text></span>Gardener Container Runtime Extension</span></a></a></li><li data-nav-id=/v1.15.5/concepts/extensions/network/ title="Gardener Network Extension" class=dd-item data-depth=2><a href=/v1.15.5/concepts/extensions/network/><span class=toggle></span><span class=menu-item-text></span>Gardener Network Extension</span></a></a></li><li data-nav-id=/v1.15.5/concepts/extensions/conventions/ title="General conventions" class=dd-item data-depth=2><a href=/v1.15.5/concepts/extensions/conventions/><span class=toggle></span><span class=menu-item-text></span>General conventions</span></a></a></li><li data-nav-id=/v1.15.5/concepts/extensions/healthcheck-library/ title="Health Check Library" class=dd-item data-depth=2><a href=/v1.15.5/concepts/extensions/healthcheck-library/><span class=toggle></span><span class=menu-item-text></span>Health Check Library</span></a></a></li><li data-nav-id=/v1.15.5/concepts/extensions/infrastructure/ title="Infrastructure resource" class=dd-item data-depth=2><a href=/v1.15.5/concepts/extensions/infrastructure/><span class=toggle></span><span class=menu-item-text></span>Infrastructure resource</span></a></a></li><li data-nav-id=/v1.15.5/concepts/extensions/logging-and-monitoring/ title="Logging and Monitoring for Extensions" class=dd-item data-depth=2><a href=/v1.15.5/concepts/extensions/logging-and-monitoring/><span class=toggle></span><span class=menu-item-text></span>Logging and Monitoring for Extensions</span></a></a></li><li data-nav-id=/v1.15.5/concepts/extensions/operatingsystemconfig/ title="OperatingSystemConfig resource" class=dd-item data-depth=2><a href=/v1.15.5/concepts/extensions/operatingsystemconfig/><span class=toggle></span><span class=menu-item-text></span>OperatingSystemConfig resource</span></a></a></li><li data-nav-id=/v1.15.5/concepts/extensions/referenced-resources/ title="Referenced Resources" class=dd-item data-depth=2><a href=/v1.15.5/concepts/extensions/referenced-resources/><span class=toggle></span><span class=menu-item-text></span>Referenced Resources</span></a></a></li><li data-nav-id=/v1.15.5/concepts/extensions/controllerregistration/ title="Registering Extension Controllers" class=dd-item data-depth=2><a href=/v1.15.5/concepts/extensions/controllerregistration/><span class=toggle></span><span class=menu-item-text></span>Registering Extension Controllers</span></a></a></li><li data-nav-id=/v1.15.5/concepts/extensions/shoot-maintenance/ title="Shoot maintenance" class=dd-item data-depth=2><a href=/v1.15.5/concepts/extensions/shoot-maintenance/><span class=toggle></span><span class=menu-item-text></span>Shoot maintenance</span></a></a></li><li data-nav-id=/v1.15.5/concepts/extensions/shoot-webhooks/ title="Shoot resource customization webhooks" class=dd-item data-depth=2><a href=/v1.15.5/concepts/extensions/shoot-webhooks/><span class=toggle></span><span class=menu-item-text></span>Shoot resource customization webhooks</span></a></a></li><li data-nav-id=/v1.15.5/concepts/extensions/worker/ title="Worker resource" class=dd-item data-depth=2><a href=/v1.15.5/concepts/extensions/worker/><span class=toggle></span><span class=menu-item-text></span>Worker resource</span></a></a></li></ul></li><li data-nav-id=/v1.15.5/concepts/networking/ title=Networking class="dd-item top-level collapsible collapsed" data-depth=1><a href=/v1.15.5/concepts/networking/><span class="toggle fa fa-angle-right"></span><span class=menu-item-text>Networking</span></a><ul><li data-nav-id=/v1.15.5/concepts/networking/dns-managment/ title="DNS Management" class=dd-item data-depth=2><a href=/v1.15.5/concepts/networking/dns-managment/><span class=toggle></span><span class=menu-item-text></span>DNS Management</span></a></a></li><li data-nav-id=/v1.15.5/concepts/networking/cert-managment/ title="Certificates Management" class=dd-item data-depth=2><a href=/v1.15.5/concepts/networking/cert-managment/><span class=toggle></span><span class=menu-item-text></span>Certificates Management</span></a></a></li><li data-nav-id=/v1.15.5/concepts/networking/network_policies/ title="Network Policies" class=dd-item data-depth=2><a href=/v1.15.5/concepts/networking/network_policies/><span class=toggle></span><span class=menu-item-text></span>Network Policies</span></a></a></li></ul></li><li data-nav-id=/v1.15.5/concepts/monitoring/ title=Monitoring class="dd-item top-level collapsible collapsed" data-depth=1><a href=/v1.15.5/concepts/monitoring/><span class="toggle fa fa-angle-right"></span><span class=menu-item-text>Monitoring</span></a><ul><li data-nav-id=/v1.15.5/concepts/monitoring/alerting/ title=Alerting class=dd-item data-depth=2><a href=/v1.15.5/concepts/monitoring/alerting/><span class=toggle></span><span class=menu-item-text></span>Alerting</span></a></a></li><li data-nav-id=/v1.15.5/concepts/monitoring/extending/ title="Extending the Monitoring Stack" class=dd-item data-depth=2><a href=/v1.15.5/concepts/monitoring/extending/><span class=toggle></span><span class=menu-item-text></span>Extending the Monitoring Stack</span></a></a></li><li data-nav-id=/v1.15.5/concepts/monitoring/operator_alerts/ title="Operator Alerts" class=dd-item data-depth=2><a href=/v1.15.5/concepts/monitoring/operator_alerts/><span class=toggle></span><span class=menu-item-text></span>Operator Alerts</span></a></a></li><li data-nav-id=/v1.15.5/concepts/monitoring/user_alerts/ title="User Alerts" class=dd-item data-depth=2><a href=/v1.15.5/concepts/monitoring/user_alerts/><span class=toggle></span><span class=menu-item-text></span>User Alerts</span></a></a></li></ul></li><li data-nav-id=/v1.15.5/concepts/deployment/deploy_gardenlet_automatically/ title="Automatic Deployment of Gardenlets" class="dd-item top-level" data-depth=1><a href=/v1.15.5/concepts/deployment/deploy_gardenlet_automatically/><span class=toggle></span><span class=menu-item-text></span>Automatic Deployment of Gardenlets</span></a></a></li><li data-nav-id=/v1.15.5/concepts/deployment/deploy_gardenlet_manually/ title="Deploy a Gardenlet Manually" class="dd-item top-level" data-depth=1><a href=/v1.15.5/concepts/deployment/deploy_gardenlet_manually/><span class=toggle></span><span class=menu-item-text></span>Deploy a Gardenlet Manually</span></a></a></li><li data-nav-id=/v1.15.5/concepts/deployment/deploy_gardenlet/ title="Deploying Gardenlets" class="dd-item top-level" data-depth=1><a href=/v1.15.5/concepts/deployment/deploy_gardenlet/><span class=toggle></span><span class=menu-item-text></span>Deploying Gardenlets</span></a></a></li><li data-nav-id=/v1.15.5/concepts/deployment/setup_gardener/ title="Deploying the Gardener into a Kubernetes cluster" class="dd-item top-level" data-depth=1><a href=/v1.15.5/concepts/deployment/setup_gardener/><span class=toggle></span><span class=menu-item-text></span>Deploying the Gardener into a Kubernetes cluster</span></a></a></li><li data-nav-id=/v1.15.5/concepts/deployment/aks/ title="Deploying the previous Gardener versions and a Seed into an AKS cluster" class="dd-item top-level" data-depth=1><a href=/v1.15.5/concepts/deployment/aks/><span class=toggle></span><span class=menu-item-text></span>Deploying the previous Gardener versions and a Seed into an AKS cluster</span></a></a></li><li data-nav-id=/v1.15.5/concepts/deployment/feature_gates/ title="Feature Gates" class="dd-item top-level" data-depth=1><a href=/v1.15.5/concepts/deployment/feature_gates/><span class=toggle></span><span class=menu-item-text></span>Feature Gates</span></a></a></li><li data-nav-id=/v1.15.5/concepts/deployment/image_vector/ title="Image Vector" class="dd-item top-level" data-depth=1><a href=/v1.15.5/concepts/deployment/image_vector/><span class=toggle></span><span class=menu-item-text></span>Image Vector</span></a></a></li><li data-nav-id=/v1.15.5/concepts/mcm/ title="Machine Controller Manager" class="dd-item top-level" data-depth=1><a href=/v1.15.5/concepts/mcm/><span class=toggle></span><span class=menu-item-text></span>Machine Controller Manager</span></a></a></li></ul></li></ul></div></nav><a href=# class=menu-toggler><i class="fa fa-angle-double-left"></i></a><script>$(document).ready(function(){$("#sidebar .dd-item:not(.top-level):not(.parent)").hide();$("#sidebar .dd-item.parent").siblings(".dd-item").show();$('.dd-item',"#sidebar .dd-item.parent").show();$(".menu-toggler").click(function(evt){$("#sidebar").toggleClass("collapsed");$(".menu-toggler span").toggleClass("fa-angle-double-left");$(".menu-toggler span").toggleClass("fa-angle-double-right");});})</script><section><div class="highlightable body-inner-wrapper"><div id=body-inner class=external><div class="docs page"><div class=git-wr><div class=origin-tools><div class=page-edit><div id=top-github-link><a class=github-link title="Edit page" href=https://github.com/gardener/gardener/blob/master/docs/concepts/gardenlet.md target=blank><i class="fa fa-edit"></i><span id=top-github-link-text title="Edit page"></span></a></div></div></div></div><h1 id=gardenlet>Gardenlet</h1><p>Gardener is implemented using the <a href=https://kubernetes.io/docs/concepts/extend-kubernetes/operator/>operator pattern</a>:
It uses custom controllers that act on our own custom resources,
and apply Kubernetes principles to manage clusters instead of containers.
Following this analogy, you can recognize components of the Gardener architecture
as well-known Kubernetes components, for example, shoot clusters can be compared with pods,
and seed clusters can be seen as worker nodes.</p><p>The following Gardener components play a similar role as the corresponding components
in the Kubernetes architecture:</p><table><thead><tr><th style=text-align:left>Gardener Component</th><th style=text-align:left>Kubernetes Component</th></tr></thead><tbody><tr><td style=text-align:left><code>gardener-apiserver</code></td><td style=text-align:left><code>kube-apiserver</code></td></tr><tr><td style=text-align:left><code>gardener-controller-manager</code></td><td style=text-align:left><code>kube-controller-manager</code></td></tr><tr><td style=text-align:left><code>gardener-scheduler</code></td><td style=text-align:left><code>kube-scheduler</code></td></tr><tr><td style=text-align:left><code>gardenlet</code></td><td style=text-align:left><code>kubelet</code></td></tr></tbody></table><p>Similar to how the <code>kube-scheduler</code> of Kubernetes finds an appropriate node
for newly created pods, the <code>gardener-scheduler</code> of Gardener finds an appropriate seed cluster
to host the control plane for newly ordered clusters.
By providing multiple seed clusters for a region or provider, and distributing the workload,
Gardener also reduces the blast radius of potential issues.</p><p>Kubernetes runs a primary &ldquo;agent&rdquo; on every node, the kubelet,
which is responsible for managing pods and containers on its particular node.
Decentralizing the responsibility to the kubelet has the advantage that the overall system
is scalable. Gardener achieves the same for cluster management by using a <strong>gardenlet</strong>
as primary &ldquo;agent&rdquo; on every seed cluster, and is only responsible for shoot clusters
located in its particular seed cluster:</p><p><img src=../../../../__resources/601e5a3a-6ae3-48c8-94dc-6b7403b4c594.png alt="Counterparts in the Gardener Architecture and the Kubernetes Architecture"></p><p>The <code>gardener-controller-manager</code> has control loops to manage resources of the Gardener API. However, instead of letting the <code>gardener-controller-manager</code> talk directly to seed clusters or shoot clusters, the responsibility isn’t only delegated to the gardenlet, but also managed using a reversed control flow: It&rsquo;s up to the gardenlet to contact the Gardener API server, for example, to share a status for its managed seed clusters.</p><p>Reversing the control flow allows placing seed clusters or shoot clusters behind firewalls without the necessity of direct access via VPN tunnels anymore.</p><p><img src=../../../../__resources/efb5b8ea-fbfb-4c62-bb34-6ae73404e92b.png alt="Reversed Control Flow Using a Gardenlet"></p><h2 id=tls-bootstrapping>TLS Bootstrapping</h2><p>Kubernetes doesn’t manage worker nodes itself, and it’s also not
responsible for the lifecycle of the kubelet running on the workers.
Similarly, Gardener doesn’t manage seed clusters itself,
so Gardener is also not responsible for the lifecycle of the gardenlet running on the seeds.
As a consequence, both the gardenlet and the kubelet need to prepare
a trusted connection to the Gardener API server
and the Kubernetes API server correspondingly.</p><p>To prepare a trusted connection between the gardenlet
and the Gardener API server, the gardenlet initializes
a bootstrapping process after you deployed it into your seed clusters:</p><ol><li><p>The gardenlet starts up with a bootstrap <code>kubeconfig</code>
having a bootstrap token that allows to create <code>CertificateSigningRequest</code> (CSR) resources.</p></li><li><p>After the CSR is signed, the gardenlet downloads
the created client certificate, creates a new <code>kubeconfig</code> with it,
and stores it inside a <code>Secret</code> in the seed cluster.</p></li><li><p>The gardenlet deletes the bootstrap <code>kubeconfig</code> secret,
and starts up with its new <code>kubeconfig</code>.</p></li><li><p>The gardenlet starts normal operation.</p></li></ol><p>The <code>gardener-controller-manager</code> runs a control loop
that automatically signs CSRs created by gardenlets.</p><blockquote><p>The gardenlet bootstrapping process is based on the
kubelet bootstrapping process. More information:
<a href=https://kubernetes.io/docs/reference/command-line-tools-reference/kubelet-tls-bootstrapping/>Kubelet&rsquo;s TLS bootstrapping</a>.</p></blockquote><p>If you don&rsquo;t want to run this bootstrap process you can create
a <code>kubeconfig</code> pointing to the garden cluster for the gardenlet yourself,
and use field <code>gardenClientConnection.kubeconfig</code> in the
gardenlet configuration to share it with the gardenlet.</p><h2 id=gardenlet-certificate-rotation>Gardenlet Certificate Rotation</h2><p>The certificate used to authenticate the gardenlet against the API server
is valid for a year.
After about 10 months, the gardenlet tries to automatically replace
the current certificate with a new one (certificate rotation).</p><p>To use certificate rotation, you need to specify the secret to store
the <code>kubeconfig</code> with the rotated certificate in field
<code>.gardenClientConnection.kubeconfigSecret</code> of the
gardenlet <a href=#component-configuration>component configuration</a>.</p><h3 id=rotate-certificates-using-bootstrap-kubeconfig>Rotate certificates using bootstrap <code>kubeconfig</code></h3><p>If the gardenlet created the certificate during the initial TLS Bootstrapping
using the Bootstrap <code>kubeconfig</code>, certificates can be rotated automatically.
The same control loop in the <code>gardener-controller-manager</code> that signs
the CSRs during the initial TLS Bootstrapping also automatically signs
the CSR during a certificate rotation.</p><h3 id=rotate-certificate-using-custom-kubeconfig>Rotate Certificate Using Custom <code>kubeconfig</code></h3><p>When trying to rotate a custom certificate that wasn’t created by gardenlet
as part of the TLS Bootstrap, the x509 certificate&rsquo;s <code>Subject</code> field
needs to conform to the following:</p><ul><li>the Common Name (CN) is prefixed with <code>gardener.cloud:system:seed:</code></li><li>the Organization (O) equals <code>gardener.cloud:system:seeds</code></li></ul><p>Otherwise, the <code>gardener-controller-manager</code> doesn’t automatically
sign the CSR.
In this case, an external component or user needs to approve the CSR manually,
for example, using command <code>kubectl certificate approve seed-csr-&lt;...></code>).
If that doesn’t happen within 15 minutes,
the gardenlet repeats the process and creates another CSR.</p><h2 id=seed-config-versus-seed-selector>Seed Config versus Seed Selector</h2><p>The usage of the gardenlet is flexible:</p><table><thead><tr><th style=text-align:left>Usage</th><th style=text-align:left>Description</th></tr></thead><tbody><tr><td style=text-align:left><code>seedConfig</code></td><td style=text-align:left>Run one gardenlet per seed cluster inside the seed cluster itself.</td></tr><tr><td style=text-align:left><code>seedSelector</code></td><td style=text-align:left>Use one gardenlet to manage multiple seed clusters. The gardenlet can run outside of the seed cluster.</td></tr></tbody></table><blockquote><p>For production use it’s recommended to go for the <code>seedConfig</code> option,
because it makes scaling easier and leads to a better distribution of responsibilities.</p></blockquote><ul><li><p>Provide a <code>seedConfig</code> that contains information about the seed cluster itself
if you want the gardenlet in the standard way,
see <a href=https://github.com/gardener/gardener/blob/master/example/20-componentconfig-gardenlet.yaml>the example gardenlet configuration</a>.
Once bootstrapped, the gardenlet creates and updates its <code>Seed</code> object itself.</p></li><li><p>Provide a <code>seedSelector</code> that incorporates a label selector for the
targeted seed clusters if you want the gardenlet to manage multiple seeds,
see <a href=https://github.com/gardener/gardener/blob/master/example/20-componentconfig-gardenlet.yaml>the example gardenlet configuration</a>.
In this case, you have to create the <code>Seed</code> objects
together with a <code>kubeconfig</code> pointing to the cluster yourself.</p></li></ul><h2 id=component-configuration>Component Configuration</h2><p>In the component configuration for the gardenlet, it’s possible to define:</p><ul><li>settings for the Kubernetes clients interacting with the various clusters</li><li>settings for the control loops inside the gardenlet</li><li>settings for leader election and log levels, feature gates, and seed selection or seed configuration.</li></ul><p>More information: <a href=https://github.com/gardener/gardener/blob/master/example/20-componentconfig-gardenlet.yaml>Example Gardenlet Component Configuration</a>.</p><h2 id=heartbeats>Heartbeats</h2><p>Similar to how Kubernetes uses <code>Lease</code> objects for node heart beats
(see <a href=https://github.com/kubernetes/enhancements/blob/master/keps/sig-node/0009-node-heartbeat.md>KEP</a>),
the gardenlet is using <code>Lease</code> objects for heart beats of the seed cluster.
Every two seconds, the gardenlet checks that the seed cluster&rsquo;s <code>/healthz</code>
endpoint returns HTTP status code 200.
If that is the case, the gardenlet renews the lease in the Garden cluster in the <code>gardener-system-seed-lease</code> namespace and updates
the <code>GardenletReady</code> condition in the <code>status.conditions</code> field of the <code>Seed</code> resource(s).</p><p>Similarly to the <code>node-lifecycle-controller</code> inside the <code>kube-controller-manager</code>,
the <code>gardener-controller-manager</code> features a <code>seed-lifecycle-controller</code> that sets
the <code>GardenletReady</code> condition to <code>Unknown</code> in case the gardenlet fails to renew the lease.
As a consequence, the <code>gardener-scheduler</code> doesn’t consider this seed cluster for newly created shoot clusters anymore.</p><h3 id=healthz-endpoint><code>/healthz</code> Endpoint</h3><p>The gardenlet includes an HTTPS server that serves a <code>/healthz</code> endpoint.
It’s used as a liveness probe in the <code>Deployment</code> of the gardenlet.
If the gardenlet fails to renew its lease
then the endpoint returns <code>500 Internal Server Error</code>, otherwise it returns <code>200 OK</code>.</p><blockquote><p>⚠️<br>In case the gardenlet is managing multiple seeds
(that is, a seed selector is used) then the <code>/healthz</code>
reports <code>500 Internal Server Error</code> if there is at least one seed
for which it couldn’t renew its lease. Only if it can renew the lease
for all seeds it reports <code>200 OK</code>.</p></blockquote><p>Please note, that the <code>/healthz</code> only indicates whether the gardenlet
could successfully probe the Seed&rsquo;s API server and renew the lease with
the Garden cluster.
It does <em>not</em> show that the Gardener extension API server (with the Gardener resource groups)
is available.
However, the Gardenlet is designed to withstand such connection outages and
retries until the connection is reestablished.</p><h2 id=shooted-seeds>Shooted Seeds</h2><p>Gardener users can use shoot clusters as seed clusters, so-called &ldquo;shooted seeds&rdquo;,
by using shoot cluster annotation <code>shoot.gardener.cloud/use-as-seed</code>.
By default, the gardenlet that manages this shoot cluster then automatically
creates a clone of itself with the same version and the same configuration
that it currently has.
Then it deploys the gardenlet clone into the shooted seed cluster.</p><p>If you want to prevent the automatic gardenlet deployment,
use the <code>no-gardenlet</code> value in the <code>shoot.gardener.cloud/use-as-seed</code> annotation.
In this case, you have to deploy the gardenlet on your own into the seed cluster.</p><blockquote><p>For example, if you annotate the shoot cluster with
<code>shoot.gardener.cloud/use-as-seed="true,no-gardenlet,invisible"</code>
the shooted seed is created without gardenlet,
and the <code>garden-scheduler</code> ignores it (it’s invisible).</p></blockquote><p>More information: <a href=https://github.com/gardener/gardener/blob/master/docs/usage/shooted_seed.md>Create Shooted Seed Cluster</a></p><h2 id=migrating-from-previous-gardener-versions>Migrating from Previous Gardener Versions</h2><p>If your Gardener version doesn’t support gardenlets yet,
no special migration is required, but the following prerequisites must be met:</p><ul><li>Your Gardener version is at least 0.31 before upgrading to v1.</li><li>You have to make sure that your garden cluster is exposed in a way
that it’s reachable from all your seed clusters.</li></ul><p>With previous Gardener versions, you had deployed the Gardener Helm chart
(incorporating the API server, <code>controller-manager</code>, and scheduler).
With v1, this stays the same, but you now have to deploy the gardenlet Helm chart as well
into all of your seeds (if they aren’t shooted, as mentioned earlier).</p><p>More information: <a href=../../../../documentation/concepts/deployment/deploy_gardenlet>Deploy a Gardenlet</a> for all instructions.</p><h2 id=related-links>Related Links</h2><p><a href=https://github.com/gardener/documentation/wiki/Architecture>Gardener Architecture</a></p><p><a href=https://github.com/gardener/gardener/issues/356>Issue #356: Implement Gardener Scheduler</a></p><p><a href=https://github.com/gardener/gardener/pull/2309>PR #2309: Add /healthz endpoint for Gardenlet</a></p></div></div></div><div class=howto_tickets><a href=https://github.com/gardener/gardener/issues/new/choose target=_blank><span>Let us know how can we improve.</span>
<span>Open<img src=https://gardener.cloud/images/branding/github-mark-logo-green.svg title=GitHub>issue <i class="fa fa-external-link" aria-hidden=true></i></span></a></div></section></div><style></style><footer class=footer><div class="container footer-wrapper"><ul class=nav><li><a href=/blog/>Blogs</a></li><li><a href=/community/>Community</a></li><li><a href=/adopter/>Adopters</a></li><li><a href=/documentation/home>Documentation</a></li></ul><img src=/images/lp/gardener-logo.svg alt="Logo Gardener" class=logo><ul class=media-wr><li><a target=_blank href=https://kubernetes.slack.com/archives/CB57N0BFG><img src=/images/branding/slack-logo-white.svg class=media-icon><div class=media-text>Slack</div></a></li><li><a target=_blank href=https://github.com/gardener><img src=/images/branding/github-mark-logo.png class=media-icon><div class=media-text>GitHub</div></a></li><li><a target=_blank href=https://www.youtube.com/channel/UCwUhwKFREV8Su0gwAJQX7tw><img src=/images/branding/youtube-logo-dark.svg class=media-icon><div class=media-text>YouTube</div></a></li><li><a target=_blank href=https://twitter.com/GardenerProject><img src=/images/branding/twitter-logo-white.svg class=media-icon><div class=media-text>Twitter</div></a></li></ul><span class=copyright>Copyright 2019 Gardener project authors.</span></div></footer><script src=/js/jquery.sticky.js?1613736047></script><script src=/js/modernizr.custom.min.js?1613736047></script><script src=/js/code-snippets.js?1613736047></script><script>$(document).ready(function(){inlineSVG.init();$("[data-publishdate]").each(function(){$(this).text(moment($(this,"YYYY-MM-DD","YYYY-MM-DD hh:mm:ss").attr("data-publishdate")).fromNow());});new ClipboardJS('.clipboard-copy');$("body").codeSnippets();});</script><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-W2FGNSX" height=0 width=0 style=display:none;visibility:hidden></iframe></noscript></body></html>